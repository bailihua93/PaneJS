!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.panejs=t():e.panejs=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="/dist/",t(0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionHandler=t.SelectionHandler=t.Handler=t.VectorView=t.PortalView=t.NodeView=t.LinkView=t.CellView=t.Terminal=t.Portal=t.Node=t.Link=t.Cell=t.Paper=t.Model=t.Events=t.VElement=t.vector=t.detector=t.utils=void 0;var o=n(75);Object.keys(o).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var a=n(1);Object.keys(a).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var s=n(41);Object.keys(s).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var u=n(49);Object.keys(u).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var l=n(5),c=r(l),h=n(27),f=i(h),d=n(15),p=i(d),v=n(51),y=i(v),g=n(52),m=i(g),b=n(57),k=i(b),w=n(20),P=i(w),x=n(59),O=i(x),C=n(3),M=i(C),_=n(25),T=i(_),E=n(21),j=i(E),S=n(32),B=i(S),N=n(58),V=i(N),R=n(29),L=i(R),A=n(26),F=i(A),z=n(30),I=i(z),D=n(60),U=i(D),G=n(61),W=i(G),H=n(64),$=i(H),q=n(65),X=i(q),Y=n(66),Z=i(Y),K=n(67),J=i(K),Q=n(68),ee=i(Q),te=n(69),ne=i(te),ie=n(70),re=i(ie),oe=n(71),ae=i(oe),se=n(72),ue=i(se);n(73),k["default"].registerConnector("sharp",X["default"]).registerConnector("smooth",Z["default"]).registerConnector("rounded",J["default"]),k["default"].registerMarker("classic",ee["default"]).registerMarker("diamond",ne["default"]).registerMarker("cloven",ae["default"]).registerMarker("block",re["default"]).registerMarker("oval",ue["default"]),t.utils=c,t.detector=p["default"],t.vector=f["default"],t.VElement=h.VElement,t.Events=y["default"],t.Model=m["default"],t.Paper=k["default"],t.Cell=P["default"],t.Link=O["default"],t.Node=M["default"],t.Portal=T["default"],t.Terminal=j["default"],t.CellView=B["default"],t.LinkView=V["default"],t.NodeView=L["default"],t.PortalView=F["default"],t.VectorView=I["default"],t.Handler=U["default"],t.SelectionHandler=W["default"],t.ConnectionHandler=$["default"]},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.shapes=void 0;var r=n(2),o=i(r),a=n(22),s=i(a),u=n(23),l=i(u),c=n(24),h=i(c),f=n(33),d=i(f),p=n(34),v=i(p),y=n(35),g=i(y),m=n(36),b=i(m),k=n(37),w=i(k),P=n(38),x=i(P),O=n(39),C=i(O),M=n(40),_=i(M),T={basic:{Text:l["default"],Rect:o["default"],Path:s["default"],Image:d["default"],Ports:h["default"],Circle:v["default"],Rhombus:g["default"],Ellipse:b["default"],Polygon:w["default"],Polyline:x["default"],LabelLink:C["default"],ElementLink:_["default"]}};t.shapes=T},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),u=i(s),l=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(u["default"]);l.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><rect/></g><text/></g>',attrs:{".":{fill:"#fff",stroke:"none"},rect:{fill:"#fff",stroke:"#000","stroke-width":"1",width:80,height:30},text:{fill:"#000","font-size":12,"ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(4),l=i(u),c=n(20),h=i(c),f=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),s(t,[{key:"isNode",value:function(){return!0}},{key:"getBBox",value:function(){var e=this.getPosition(),t=this.getSize();return new l["default"](e.x,e.y,t.width,t.height)}}],[{key:"isNode",value:function(e){return e&&e instanceof t}}]),t}(h["default"]);f.setDefaults({tagName:"g",markup:"",classNames:"pane-node",pane:null,view:null,data:null,attrs:null,size:{width:1,height:1,relative:!1},position:{x:0,y:0,relative:!1},rotation:{angle:0,inherited:!0}}),t["default"]=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(5),u=r(s),l=n(18),c=i(l),h=n(19),f=i(h),d=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],i=arguments.length<=2||void 0===arguments[2]?0:arguments[2],r=arguments.length<=3||void 0===arguments[3]?0:arguments[3];o(this,e),this.x=t,this.y=n,this.width=i,this.height=r}return a(e,[{key:"getOrigin",value:function(){return new c["default"](this.x,this.y)}},{key:"getCenter",value:function(){return new c["default"](this.x+this.width/2,this.y+this.height/2)}},{key:"getCorner",value:function(){return new c["default"](this.x+this.width,this.y+this.height)}},{key:"getTopRight",value:function(){return new c["default"](this.x+this.width,this.y)}},{key:"getBottomLeft",value:function(){return new c["default"](this.x,this.y+this.height)}},{key:"getNearestSideToPoint",value:function(e){var t=e.x-this.x,n=e.y-this.y,i=this.x+this.width-e.x,r=this.y+this.height-e.y,o=t,a="left";return o>i&&(o=i,a="right"),o>n&&(o=n,a="top"),o>r&&(a="bottom"),a}},{key:"getNearestPointToPoint",value:function(e){if(this.containsPoint(e)){var t=this.getNearestSideToPoint(e);if("right"===t)return new c["default"](this.x+this.width,e.y);if("left"===t)return new c["default"](this.x,e.y);if("bottom"===t)return new c["default"](e.x,this.y+this.height);if("top"===t)return new c["default"](e.x,this.y)}return e.adhereToRect(this)}},{key:"containsPoint",value:function(e){return e&&e.x>=this.x&&e.x<=this.x+this.width&&e.y>=this.y&&e.y<=this.y+this.height}},{key:"containsRect",value:function(e){this.normalize(),e.normalize();var t=e.x,n=e.y,i=e.width,r=e.height,o=this.x,a=this.y,s=this.width,u=this.height;return t>=o&&n>=a&&o+s>=t+i&&a+u>=n+r}},{key:"intersect",value:function(t){var n=this.getOrigin(),i=this.getCorner(),r=t.getOrigin(),o=t.getCorner();if(n.x>=o.x||n.y>=o.y||r.x>=i.x||r.y>=i.y)return null;var a=Math.max(n.x,r.x),s=Math.max(n.y,r.y),u=Math.min(i.x,o.x)-a,l=Math.min(i.y,o.y)-s;return new e(a,s,u,l)}},{key:"union",value:function(t){var n=this.getOrigin(),i=this.getCorner(),r=t.getOrigin(),o=t.getCorner(),a=Math.min(n.x,r.x),s=Math.min(n.y,r.y),u=Math.max(i.x,o.x),l=Math.max(i.y,o.y);return new e(a,s,u-a,l-s)}},{key:"intersectionWithLineFromCenterToPoint",value:function(e,t){var n=void 0,i=this.getCenter();t&&e.rotate(i,t);for(var r=[new f["default"](this.getOrigin(),this.getTopRight()),new f["default"](this.getTopRight(),this.getCorner()),new f["default"](this.getCorner(),this.getBottomLeft()),new f["default"](this.getBottomLeft(),this.getOrigin())],o=new f["default"](i,e),a=r.length-1;a>=0;--a){var s=r[a].intersection(o);if(s){n=s;break}}return n&&t&&n.rotate(i,-t),n}},{key:"moveAndExpand",value:function(e){return this.x+=e.x||0,this.y+=e.y||0,this.width+=e.width||0,this.height+=e.height||0,this}},{key:"grow",value:function(e){return this.x-=e,this.y-=e,this.width+=2*e,this.height+=2*e,this}},{key:"round",value:function(e){return this.x=e?u.toFixed(this.x,e):Math.round(this.x),this.y=e?u.toFixed(this.y,e):Math.round(this.y),this.width=e?u.toFixed(this.width,e):Math.round(this.width),this.height=e?u.toFixed(this.height,e):Math.round(this.height),this}},{key:"normalize",value:function(){var e=this.x,t=this.y,n=this.width,i=this.height;return 0>n&&(e+=n,n=-n),0>i&&(t+=i,i=-i),this.x=e,this.y=t,this.width=n,this.height=i,this}},{key:"getBBox",value:function(t){var n=u.toRad(t||0),i=Math.abs(Math.sin(n)),r=Math.abs(Math.cos(n)),o=this.width*r+this.height*i,a=this.width*i+this.height*r;return new e(this.x+(this.width-o)/2,this.y+(this.height-a)/2,o,a)}},{key:"snapToGrid",value:function(e,t){var n=this,i=n.getOrigin(),r=n.getCorner();return i=i.snapToGrid(e,t),r=r.snapToGrid(e,t),n.x=i.x,n.y=i.y,n.width=r.x-i.x,n.height=r.y-i.y,n}},{key:"equals",value:function(t){return e.equals(this,t)}},{key:"valueOf",value:function(){return[this.x,this.y,this.width,this.height]}},{key:"toString",value:function(){return this.valueOf().join(", ")}},{key:"clone",value:function(){return e.fromRect(this)}}],[{key:"equals",value:function(e,t){var n=this.isRect(e)&&this.isRect(t);return n&&(e.standardizePort(),t.standardizePort(),n=e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height),n}},{key:"fromRect",value:function(t){return new e(t.x,t.y,t.width,t.height)}},{key:"fromVerticesAndRotation",value:function(t,n){var i=arguments.length<=2||void 0===arguments[2]?0:arguments[2],r=(t.x+n.x)/2,o=(t.y+n.y)/2,a=new c["default"](t.x,t.y).distance(new c["default"](n.x,n.y)),s=180*Math.atan(Math.abs((n.y-t.y)/(t.x-n.x)))/Math.PI,u=Math.abs(a*Math.sin((90-i+s)/180*Math.PI)),l=Math.abs(a*Math.cos((90-i+s)/180*Math.PI)),h=r-u/2,f=o-l/2,d=new e(h,f,u,l);return d.cx=r,d.cy=o,d.rotation=i,d}},{key:"isRect",value:function(t){return t&&t instanceof e}}]),e}();t["default"]=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6);Object.keys(i).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var r=n(7);Object.keys(r).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(8);Object.keys(o).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var a=n(10);Object.keys(a).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var s=n(9);Object.keys(s).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var u=n(11);Object.keys(u).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var l=n(12);Object.keys(l).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})});var c=n(13);Object.keys(c).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})});var h=n(14);Object.keys(h).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return h[e]}})});var f=n(16);Object.keys(f).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return f[e]}})});var d=n(17);Object.keys(d).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}})}),t["default"]={}},function(e,t){"use strict";function n(e){return null===e}function i(e){return"undefined"==typeof e}function r(e){return i(e)||n(e)}function o(e){return"string"==typeof e}function a(e){return"boolean"==typeof e}function s(e,t){return y.call(e)==="[object "+t+"]"}function u(e){if(!e)return!1;var t="undefined"==typeof e?"undefined":p(e);return"function"===t||"object"===t}function l(e){return e&&e===e.window}function c(e){return s(e,"Function")}function h(e){return Array.isArray(e)}function f(e){if(h(e))return!0;if(c(e)||l(e))return!1;var t=!!e&&"length"in e&&e.length;return 0===t||"number"==typeof t&&t>0&&t-1 in e}function d(e){return!h(e)&&e-parseFloat(e)+1>=0}Object.defineProperty(t,"__esModule",{value:!0});var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},v=Object.prototype,y=v.toString;t.isNil=r,t.isNull=n,t.isType=s,t.isArray=h,t.isWindow=l,t.isObject=u,t.isString=o,t.isBoolean=a,t.isNumeric=d,t.isFunction=c,t.isArrayLike=f,t.isUndefined=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reduceRight=t.reduce=t.filter=t.every=t.some=t.map=t.forEach=t.contains=t.lastIndexOf=t.indexOf=t.slice=t.toArray=void 0;var i=n(6),r=Array.prototype,o=function(e){return(0,i.isArray)(e)?e:(0,i.isArrayLike)(e)?r.slice.call(e):[e]},a=function(e,t,n){return e?r.slice.call(e,t,n):[]},s=function(e,t){return e?r.indexOf.call(e,t):-1},u=function(e,t){return e?r.lastIndexOf.call(e,t):-1},l=function(e,t){return e&&s(e,t)>=0},c=function(e,t,n){e&&r.forEach.call(e,t,n)},h=function(e,t,n){return e?r.map.call(e,t,n):[]},f=function(e,t,n){return e?r.some.call(e,t,n):!1},d=function(e,t,n){return e?r.every.call(e,t,n):!1},p=function(e,t,n){return e?r.filter.call(e,t,n):[]},v=function(e,t,n){return e?r.reduce.call(e,t,n):n},y=function(e,t,n){return e?r.reduceRight.call(e,t,n):n};t.toArray=o,t.slice=a,t.indexOf=s,t.lastIndexOf=u,t.contains=l,t.forEach=c,t.map=h,t.some=f,t.every=d,t.filter=p,t.reduce=v,t.reduceRight=y},function(e,t,n){"use strict";function i(e){return""+e}function r(e){return i(e).toUpperCase()}function o(e){return i(e).toLowerCase()}function a(e){return e.charAt(0).toUpperCase()+e.substring(1)}function s(e){return e.charAt(0).toLowerCase()+e.substring(1)}function u(e){var t=arguments.length<=1||void 0===arguments[1]?/\s+/:arguments[1];return i(e).split(t)}function l(e){return e?w.trim.call(""+e):""}function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)})}function h(e){var t=0,n=e.length;if(0===n)return t;for(var i=0;n>i;i++){var r=e.charCodeAt(i);t=(t<<5)-t+r,t&=t}return t}function f(e,t){return e&&t?(""+e).replace(/\$\{(\w+)\}/g,function(e,n){var i=(0,k.getByPath)(t,n);return void 0!==i?i:e}):e}function d(e){return(e||"").replace(/ /g,"\xa0")}function p(e,t){return 0===(""+e).indexOf(t)}function v(e,t){return e=""+e,-1!==e.indexOf(t,e.length-t.length)}function y(e,t,n,i){if((0,b.isNil)(e)||(0,b.isNil)(t))return e;var r=String(e),o="number"==typeof t?t:parseInt(t,10);if(isNaN(o)||!isFinite(o))return r;var a=r.length;if(a>=o)return r;var s=(0,b.isNil)(n)?"":String(n);""===s&&(s=" ");for(var u=o-a;s.length<u;)s+=s;var l=s.length>u?s.substr(0,u):s;return i?l+r:r+l}function g(e,t,n){return y(e,t,n,!0)}function m(e,t,n){return y(e,t,n,!1)}Object.defineProperty(t,"__esModule",{value:!0}),t.padEnd=t.padStart=t.endWith=t.startWith=t.sanitizeText=t.toString=t.hashCode=t.format=t.uuid=t.split=t.trim=t.lcFirst=t.ucFirst=t.toUpper=t.toLower=void 0;var b=n(6),k=n(9),w=String.prototype;t.toLower=o,t.toUpper=r,t.ucFirst=a,t.lcFirst=s,t.trim=l,t.split=u,t.uuid=c,t.format=f,t.hashCode=h,t.toString=i,t.sanitizeText=d,t.startWith=p,t.endWith=v,t.padStart=g,t.padEnd=m},function(e,t,n){"use strict";function i(e,t){return null!==e&&Object.prototype.hasOwnProperty.call(e,t)}function r(e){return e?Object.keys(e):[]}function o(e,t,n){(0,f.forEach)(r(e),function(i){t.call(n,e[i],i)})}function a(e){e||(e={});for(var t=1,n=arguments.length;n>t;t++){var i=arguments[t];if(i)for(var r in i)e[r]=i[r]}return e}function s(e){e||(e={});for(var t=1,n=arguments.length;n>t;t++){var i=arguments[t];if(i)for(var r in i){var o=e[r],a=i[r],u=(0,d.isArray)(a);if(u||c(a)){var l=void 0;l=u?o&&(0,d.isArray)(o)?o:[]:o&&c(o)?o:{},e[r]=s(l,a)}else e[r]=a}}return e}function u(e,t,n){n=n||".";for(var i=t.split(n);i.length;){var r=i.shift();if(!(Object(e)===e&&r in e))return;e=e[r]}return e}function l(e){if(e){for(var t in e)e.hasOwnProperty(t)&&delete e[t];e&&(e.prototype=e.__proto__=null),e.destroyed=!0}}function c(e){return!(0,d.isObject)(e)||e.nodeType||(0,d.isWindow)(e)?!1:!e.constructor||i(e.constructor.prototype,"isPrototypeOf")}function h(e){for(var t in e)return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyObject=t.isPlainObject=t.getByPath=t.destroy=t.extend=t.merge=t.forIn=t.keys=t.hasOwn=void 0;var f=n(7),d=n(6);t.hasOwn=i,t.keys=r,t.forIn=o,t.merge=s,t.extend=a,t.destroy=l,t.getByPath=u,t.isPlainObject=c,t.isEmptyObject=h},function(e,t,n){"use strict";function i(e){return window.isFinite(e)&&!window.isNaN(parseFloat(e))}function r(e){return(0,h.isString)(e)&&"%"===e.slice(-1)}function o(e){return parseInt(e,10)}function a(e,t){var n=parseFloat(e);return t?n/100:n}function s(e){var t=arguments.length<=1||void 0===arguments[1]?2:arguments[1],n=Math.pow(10,t);return a((Math.round(e*n)/n).toFixed(t))}function u(e,t,n){var i=a(e,t);return isNaN(i)?n:i}function l(e,t){if((0,h.isNil)(e))return t;for(;0>e;)e+=t;return Math.min(e,t)}function c(e,t,n){return n>t?t>e?t:e>n?n:e:n>e?n:e>t?t:e}Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=t.fixNumber=t.fixIndex=t.isPercentage=t.isFinite=t.toFixed=t.toFloat=t.toInt=void 0;var h=n(6);t.toInt=o,t.toFloat=a,t.toFixed=s,t.isFinite=i,t.isPercentage=r,t.fixIndex=l,t.fixNumber=u,t.clamp=c},function(e,t,n){"use strict";function i(e,t,n){var i=void 0;if((0,o.isFunction)(e)){var r=t.length,a=t[0],s=t[1],u=t[2];i=0===r?e.call(n):1===r?e.call(n,a):2===r?e.call(n,a,s):3===r?e.call(n,a,s,u):e.apply(n,t)}return i}function r(e){if((0,o.isFunction)(e)){var t=(0,a.slice)(arguments,1);return i(Function.prototype.bind,t,e)}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.invoke=t.bind=void 0;var o=n(6),a=n(7);t.bind=r,t.invoke=i},function(e,t,n){"use strict";function i(e){return e.getAttribute&&e.getAttribute("class")||""}function r(e,t){if((0,R.isNil)(e)||(0,R.isNil)(t))return!1;var n=u(i(e)),r=u(t);return 1===e.nodeType?n.replace(z," ").indexOf(r)>-1:!1}function o(e,t){if(!(0,R.isNil)(e)&&!(0,R.isNil)(t)){if((0,R.isFunction)(t))return void o(e,t.call(e,i(e)));if((0,R.isString)(t)&&1===e.nodeType){var n=t.match(I)||[],r=u(i(e)).replace(z," "),a=(0,L.reduce)(n,function(e,t){return e.indexOf(u(t))<0&&(e+=t+" "),e},r);a=(0,A.trim)(a),r!==a&&e.setAttribute("class",a)}}}function a(e,t){if(!(0,R.isNil)(e)){if((0,R.isFunction)(t))return void a(e,t.call(e,i(e)));if((!t||(0,R.isString)(t))&&1===e.nodeType){var n=(t||"").match(I)||[],r=u(i(e)).replace(z," "),o=(0,L.reduce)(n,function(e,t){var n=u(t);return e.indexOf(n)>-1&&(e=e.replace(n," ")),e},r);o=t?(0,A.trim)(o):"",r!==o&&e.setAttribute("class",o)}}}function s(e,t,n){return(0,R.isNil)(e)||(0,R.isNil)(t)?void 0:(0,R.isBoolean)(n)&&(0,R.isString)(t)?void(n?o(e,t):a(e,t)):(0,R.isFunction)(t)?void s(e,t.call(e,i(e),n),n):void((0,R.isString)(t)&&(0,L.forEach)(t.match(I)||[],function(t){r(e,t)?a(e,t):o(e,t)}))}function u(e){return" "+e+" "}function l(e){return(0,L.reduce)((0,A.split)(e,";"),function(e,t){if(t){var n=(0,A.split)(t,"=");e[(0,A.trim)(n[0])]=(0,A.trim)(n[1])}return e},{})}function c(e,t,n){if(e){var i={};(0,R.isObject)(t)?i=t:(0,R.isString)(t)&&(0,R.isUndefined)(n)?i=l(t):i[t]=n,(0,F.forIn)(i,function(t,n){e.style["transform"===n?D:n]=t})}}function h(e,t){var n=e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):window.getComputedStyle(e,null);return n&&t?n.getPropertyValue(t)||n[t]:n}function f(e){return Object(e)!==e?(e=(0,R.isNil)(e)?0:e,{top:e,right:e,bottom:e,left:e}):{top:(0,R.isNil)(e.top)?0:e.top,right:(0,R.isNil)(e.right)?0:e.right,bottom:(0,R.isNil)(e.bottom)?0:e.bottom,left:(0,R.isNil)(e.left)?0:e.left}}function d(e,t){return(t||document).createElement(e)}function p(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function v(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}function y(e){return e.nodeName?e.nodeName.toLowerCase():""}function g(e,t,n,i){var r=e&&!isNaN(e.nodeType);return r&&(r=(0,R.isNil)(t)||y(e)===t.toLowerCase()),r&&(r=(0,R.isNil)(n)||e.getAttribute(n)===i),r}function m(e){return(0,R.isWindow)(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}function b(e){var t={top:0,left:0},n=e&&e.ownerDocument;if(!n)return t;var i=n.documentElement;if(!G(i,e))return t;e.getBoundingClientRect&&(t=e.getBoundingClientRect());var r=m(n);return{top:t.top+(r.pageYOffset||i.scrollTop)-(i.clientTop||0),left:t.left+(r.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}}function k(e,t){if(e&&e.style){var n=e.style.display;t?"none"===n&&((0,R.isUndefined)(e.__display)?n="":(n=e.__display,delete e.__display),e.style.display=n||""):"none"!==n&&(n&&(e.__display=n),e.style.display="none")}}function w(e){return e&&("none"===e.style.display||!G(e.ownerDocument,e))}function P(e,t){var n=void 0;try{var i=new DOMParser;(0,R.isUndefined)(t)||(i.async=t),n=i.parseFromString(e,"text/xml")}catch(r){n=null}if(!n||n.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+e);return n}function x(e){var t='<svg xmlns="'+W.xmlns+'" xmlns:xlink="'+W.xmlns+'" version="'+H+'">'+(e||"")+"</svg>",n=P(t,!1);return n.documentElement}function O(e,t){return(t||document).createElementNS(W.xmlns,e)}function C(e,t,n){if((0,R.isNil)(n))return M(e,t);if("id"===t)e.id=n;else{var i=_(t);i.ns?e.setAttributeNS(i.ns,t,n):e.setAttribute(t,n)}}function M(e,t){var n=_(t);n.ns?e.hasAttributeNS(n.ns,n.local)&&e.removeAttributeNS(n.ns,n.local):e.hasAttribute(t)&&e.removeAttribute(t)}function _(e){if(-1!==e.indexOf(":")){var t=e.split(":");return{ns:W[t[0]],local:t[1]}}return{ns:null,local:e}}function T(e,t,n){e&&(e.style[D]="scale("+t+","+n+")")}function E(e,t,n,i){e&&(e.style[D]="rotate("+t+","+n+","+i+")")}function j(e,t,n){if(e){var i="translateX("+t+"px) translateY("+n+"px)";"msTransform"!==D&&(i+=" translateZ(0)"),e.style[D]=i}}function S(e,t){if(e.getTransformToElement)return e.getTransformToElement(t);var n=void 0;try{n=t.getScreenCTM().inverse()}catch(i){throw new Error("Can not inverse source element's ctm.")}return n.multiply(e.getScreenCTM())}function B(e){var t=void 0;e===document?(t=document,e=document.documentElement):t=e.ownerDocument;var n=t.documentElement,i={},r=e.getBoundingClientRect();for(var o in r)i[o]=r[o];return(0,R.isUndefined)(i.width)&&(i.width=document.body.scrollWidth-i.left-i.right),(0,R.isUndefined)(i.height)&&(i.height=document.body.scrollHeight-i.top-i.bottom),i.top=i.top-n.clientTop,i.left=i.left-n.clientLeft,i.right=t.body.clientWidth-i.width-i.left,i.bottom=t.body.clientHeight-i.height-i.top,i}function N(e){var t=h(e)||{},n=t.position;if("fixed"===n)return e;for(var i=e;i=i.parentNode;){var r=void 0;try{r=h(i)}catch(o){}if("undefined"==typeof r||null===r)return i;var a=r.overflow,s=r.overflowX,u=r.overflowY;if(/(auto|scroll)/.test(a+u+s)&&("absolute"!==n||["relative","absolute","fixed"].indexOf(r.position)>=0))return i}return document.body}function V(){var e=d("p"),t=d("div");c(e,{width:"100%",height:"200px"}),c(t,{overflow:"hidden",visibility:"hidden",position:"absolute",left:0,top:0,width:"200px",height:"100px"}),t.appendChild(e),document.body.appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var i=e.offsetWidth;return n===i&&(i=t.clientWidth),document.body.removeChild(t),n-i}Object.defineProperty(t,"__esModule",{value:!0}),t.getTransformToElement=t.getComputedStyle=t.getScrollBarWidth=t.getScrollParent=t.normalizeSides=t.styleStrToObject=t.getBounds=t.setStyle=t.setTranslate=t.setRotation=t.setScale=t.qualifyAttributeName=t.removeAttribute=t.setAttribute=t.getClassName=t.toggleClass=t.removeClass=t.addClass=t.hasClass=t.containsElement=t.removeElement=t.emptyElement=t.createSvgElement=t.createSvgDocument=t.createElement=t.getNodeName=t.getOffset=t.getWindow=t.isHidden=t.showHide=t.isNode=void 0;var R=n(6),L=n(7),A=n(8),F=n(9),z=/[\t\r\n\f]/g,I=/\S+/g,D=function(){if((0,R.isUndefined)(document))return"";for(var e=d("div"),t=["transform","webkitTransform","OTransform","MozTransform","msTransform"],n=0;n<t.length;++n){var i=t[n];if(void 0!==e.style[i])return i}}(),U=document.documentElement,G=U.compareDocumentPosition||U.contains?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},W={xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},H="1.1";t.isNode=g,t.showHide=k,t.isHidden=w,t.getWindow=m,t.getOffset=b,t.getNodeName=y,t.createElement=d,t.createSvgDocument=x,t.createSvgElement=O,t.emptyElement=v,t.removeElement=p,t.containsElement=G,t.hasClass=r,t.addClass=o,t.removeClass=a,t.toggleClass=s,t.getClassName=i,t.setAttribute=C,t.removeAttribute=M,t.qualifyAttributeName=_,t.setScale=T,t.setRotation=E,t.setTranslate=j,t.setStyle=c,t.getBounds=B,t.styleStrToObject=l,t.normalizeSides=f,t.getScrollParent=N,t.getScrollBarWidth=V,t.getComputedStyle=h,t.getTransformToElement=S},function(e,t){"use strict";function n(e){return 180*e/Math.PI%360}function i(e,t){return e=t?e:e%360,e*Math.PI/180}function r(e){var t=arguments.length<=1||void 0===arguments[1]?1:arguments[1],n=arguments.length<=2||void 0===arguments[2]?"round":arguments[2];return Math[n](e/t)*t}function o(e){return e%360+(0>e?360:0)}Object.defineProperty(t,"__esModule",{value:!0}),t.toDeg=n,t.toRad=i,t.snapToGrid=r,t.normalizeAngle=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){return e.preventDefault=r.preventDefault,e.stopPropagation=r.stopPropagation,e}function o(e){var t=!0,n=this;e=e||r((w.parentWindow||k).event);var i=n.events[e.type];for(var o in i)i.hasOwnProperty(o)&&(n.$$handleEvent=i[o],n.$$handleEvent(e)===!1&&(t=!1));return t}function a(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else{n.$$guid||(n.$$guid=++a.guid),e.events||(e.events={});var i="on"+t,r=e.events[t];r||(r=e.events[t]={},e[i]&&(r[0]=e[i])),r[n.$$guid]=n,e[i]=o}}function s(e,t,n){for(;t&&t!==e;){if(x(t,n))return t;t=t.parentElement}return null}function u(e,t,n){var i=n._delegateWrapper;e.removeEventListener?(e.removeEventListener(t,n,!1),i&&e.removeEventListener(t,i,!1)):e.events&&e.events[t]&&(delete e.events[t][n.$$guid],i&&delete e.events[t][i.$$guid])}function l(e,t,n,i,r){function o(a){var l=s(e,a.target,n);l&&(a.delegateTarget=l,r===!0&&u(e,t,o),i.call(e,a))}return(0,y.isFunction)(n)?a(e,t,n):(i._delegateWrapper=o,a(e,t,o),i)}function c(e){var t=P&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0];if(t){for(var n in e)void 0===t[n]&&(t[n]=e[n]);return t}return e}function h(e){return b["default"].IS_IE?1===e.button:0===e.button}function f(e){return d(e)||v(e)||p(e)}function d(e){return e.ctrlKey}function p(e){return e.shiftKey}function v(e){return e.metaKey}Object.defineProperty(t,"__esModule",{value:!0}),t.removeEventListener=t.addEventListener=t.isLeftMouseButton=t.hasModifierKey=t.hasShiftKey=t.hasMetaKey=t.hasCtrlKey=t.normalizeEvent=void 0;var y=n(6),g=n(7),m=n(15),b=i(m),k=window,w=window.document,P=b["default"].IS_TOUCH,x=function(){var e=w.createElement("div"),t=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector,n=t&&t.call(e,"div");return function(e,i){if(n)return t.call(e,i);var r=e.parentNode;r||n||(r=w.createDocumentFragment(),r.appendChild(e));var o=r.querySelectorAll(i);return(0,g.some)(o,function(t){return t===e})}}();r.preventDefault=function(){this.returnValue=!1},r.stopPropagation=function(){this.cancelBubble=!0},a.guid=0,t.normalizeEvent=c,t.hasCtrlKey=d,t.hasMetaKey=v,t.hasShiftKey=p,t.hasModifierKey=f,t.isLeftMouseButton=h,t.addEventListener=l,t.removeEventListener=u},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=navigator.userAgent,i=navigator.appVersion;t["default"]={IS_IE:n.indexOf("MSIE")>=0,IS_IE11:!!n.match(/Trident\/7\./),IS_NS:n.indexOf("Mozilla/")>=0&&n.indexOf("MSIE")<0,IS_FF:n.indexOf("Firefox/")>=0,IS_GC:n.indexOf("Chrome/")>=0,IS_SF:n.indexOf("AppleWebKit/")>=0&&n.indexOf("Chrome/")<0,IS_OP:n.indexOf("Opera/")>=0,IS_OT:n.indexOf("Presto/2.4.")<0&&n.indexOf("Presto/2.3.")<0&&n.indexOf("Presto/2.2.")<0&&n.indexOf("Presto/2.1.")<0&&n.indexOf("Presto/2.0.")<0&&n.indexOf("Presto/1.")<0,IS_MT:n.indexOf("Firefox/")>=0&&n.indexOf("Firefox/1.")<0&&n.indexOf("Firefox/2.")<0||n.indexOf("Iceweasel/")>=0&&n.indexOf("Iceweasel/1.")<0&&n.indexOf("Iceweasel/2.")<0||n.indexOf("SeaMonkey/")>=0&&n.indexOf("SeaMonkey/1.")<0||n.indexOf("Iceape/")>=0&&n.indexOf("Iceape/1.")<0,IS_IOS:!!n.match(/(iPad|iPhone|iPod)/g),IS_WIN:i.indexOf("Win")>0,IS_MAC:i.indexOf("Mac")>0,IS_TOUCH:"ontouchstart"in document.documentElement,IS_POINTER:window.navigator.msPointerEnabled||!1,SUPPORT_FOREIGN_OBJECT:function(){if(document.createElementNS){var e=Object.prototype.toString,t=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return/SVGForeignObject/.test(e.call(t))}return!1}()}},function(e,t,n){"use strict";function i(e){return["M",e.getAttribute("x1"),e.getAttribute("y1"),"L",e.getAttribute("x2"),e.getAttribute("y2")].join(" ")}function r(e){var t=[];return(0,l.forEach)(e.points,function(e,n){t.push(0===n?"M":"L",e.x,e.y)}),t.push("Z"),t.join(" ")}function o(e){var t=[];return(0,l.forEach)(e.points,function(e,n){t.push(0===n?"M":"L",e.x,e.y)}),t.join(" ")}function a(e){var t=parseFloat(e.getAttribute("x"))||0,n=parseFloat(e.getAttribute("y"))||0,i=parseFloat(e.getAttribute("width"))||0,r=parseFloat(e.getAttribute("height"))||0,o=parseFloat(e.getAttribute("rx"))||0,a=parseFloat(e.getAttribute("ry"))||0,s=t+i,u=n+r,l=void 0;return l=o||a?["M",t+o,n,"L",s-o,n,"Q",s,n,s,n+a,"L",s,n+r-a,"Q",s,u,s-o,u,"L",t+o,u,"Q",t,u,t,u-o,"L",t,n+a,"Q",t,n,t+o,n,"Z"]:["M",t,n,"H",s,"V",u,"H",t,"V",n,"Z"],l.join(" ")}function s(e){var t=parseFloat(e.getAttribute("cx"))||0,n=parseFloat(e.getAttribute("cy"))||0,i=parseFloat(e.getAttribute("r")),r=i*c;return["M",t,n-i,"C",t+r,n-i,t+i,n-r,t+i,n,"C",t+i,n+r,t+r,n+i,t,n+i,"C",t-r,n+i,t-i,n+r,t-i,n,"C",t-i,n-r,t-r,n-i,t,n-i,"Z"].join(" ")}function u(e){var t=parseFloat(e.getAttribute("cx"))||0,n=parseFloat(e.getAttribute("cy"))||0,i=parseFloat(e.getAttribute("rx")),r=parseFloat(e.getAttribute("ry"))||i,o=i*c,a=r*c;
return["M",t,n-r,"C",t+o,n-r,t+i,n-a,t+i,n,"C",t+i,n+a,t+o,n+r,t,n+r,"C",t-o,n+r,t-i,n+a,t-i,n,"C",t-i,n-a,t-o,n-r,t,n-r,"Z"].join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t.polylineToPathData=t.polygonToPathData=t.ellipseToPathData=t.circleToPathData=t.rectToPathData=t.lineToPathData=void 0;var l=n(7),c=.5522847498307935;t.lineToPathData=i,t.rectToPathData=a,t.circleToPathData=s,t.ellipseToPathData=u,t.polygonToPathData=r,t.polylineToPathData=o},function(e,t,n){"use strict";function i(e){var t={tx:0,ty:0};if(e){var n=/[ ,]+/,i=e.match(/translate\((.*)\)/);if(i){var r=i[1].split(n);r[0]&&(t.tx+=(0,h.toFloat)(r[0])),r[1]&&(t.ty+=(0,h.toFloat)(r[1]))}}return t}function r(e){var t={sx:1,sy:1};if(e){var n=/[ ,]+/,i=e.match(/scale\((.*)\)/);if(i){var r=i[1].split(n);r[0]&&(t.sx*=(0,h.toFloat)(r[0])),(r[1]||r[0])&&(t.sy*=(0,h.toFloat)(r[1]||r[0]))}}return t}function o(e){var t={angle:0};if(e){var n=/[ ,]+/,i=e.match(/rotate\((.*)\)/);if(i){var r=i[1].split(n);r[0]&&(t.angle+=(0,h.toFloat)(r[0])),r[1]&&r[2]&&(t.cx=(0,h.toFloat)(r[1]),t.cy=(0,h.toFloat)(r[2]))}}return t}function a(e){return{translate:i(e),rotate:o(e),scale:r(e)}}function s(e){return e&&(0,c.trim)(e.replace(/translate\([^)]*\)/g,""))||""}function u(e){return e&&(0,c.trim)(e.replace(/scale\([^)]*\)/g,""))||""}function l(e){return e&&(0,c.trim)(e.replace(/rotate\([^)]*\)/g,""))||""}Object.defineProperty(t,"__esModule",{value:!0}),t.clearTranslate=t.clearRotate=t.clearScale=t.parseTranslate=t.parseTransform=t.parseRotate=t.parseScale=void 0;var c=n(8),h=n(10);t.parseScale=r,t.parseRotate=o,t.parseTransform=a,t.parseTranslate=i,t.clearScale=u,t.clearRotate=l,t.clearTranslate=s},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(5),s=i(a),u=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1];r(this,e),this.x=t,this.y=n}return o(e,[{key:"update",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return this.x=e,this.y=t,this}},{key:"translate",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return this.x+=e,this.y+=t,this}},{key:"rotate",value:function(t,n){n=(n+360)%360,this.toPolar(t),this.y+=s.toRad(n);var i=e.fromPolar(this.x,this.y,t);return this.x=i.x,this.y=i.y,this}},{key:"scale",value:function(t,n,i){return i=i||new e(0,0),this.x=i.x+t*(this.x-i.x),this.y=i.y+n*(this.y-i.y),this}},{key:"move",value:function(e,t){var n=s.toRad(e.theta(this));return this.translate(Math.cos(n)*t,-Math.sin(n)*t)}},{key:"reflect",value:function(e){return e.move(this,this.distance(e))}},{key:"diff",value:function(t){return new e(this.x-t.x,this.y-t.y)}},{key:"round",value:function(e){return this.x=e?s.toFixed(this.x,e):Math.round(this.x),this.y=e?s.toFixed(this.y,e):Math.round(this.y),this}},{key:"smooth",value:function(){return this.round(2)}},{key:"theta",value:function(t){t=t||new e;var n=-(t.y-this.y),i=t.x-this.x,r=10,o=0===s.toFixed(i,r)&&0===s.toFixed(n,r)?0:Math.atan2(n,i);return 0>o&&(o=2*Math.PI+o),s.toDeg(o)}},{key:"distance",value:function(t){t=t||new e;var n=t.x-this.x,i=t.y-this.y;return Math.sqrt(n*n+i*i)}},{key:"manhattanDistance",value:function(t){return t=t||new e,Math.abs(t.x-this.x)+Math.abs(t.y-this.y)}},{key:"toPolar",value:function(t){t=t||new e(0,0);var n=this.x-t.x,i=this.y-t.y;return this.y=s.toRad(t.theta(e.fromPoint(this))),this.x=Math.sqrt(n*n+i*i),this}},{key:"normalize",value:function(){var t=arguments.length<=0||void 0===arguments[0]?1:arguments[0],n=this.x,i=this.y;if(0===n&&0===i)return this;var r=void 0;return r=0===n?t/i:0===i?t/n:t/this.distance(new e),this.x=r*n,this.y=r*i,this}},{key:"changeInAngle",value:function(t,n,i){return e.fromPoint(this).translate(-t,-n).theta(i)-this.theta(i)}},{key:"snapToGrid",value:function(e,t){return this.x=s.snapToGrid(this.x,e),this.y=s.snapToGrid(this.y,t||e),this}},{key:"adhereToRect",value:function(e){return e.containsPoint(this)?this:(this.x=Math.min(Math.max(this.x,e.x),e.x+e.width),this.y=Math.min(Math.max(this.y,e.y),e.y+e.height),this)}},{key:"magnitude",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)||.01}},{key:"valueOf",value:function(){return[this.x,this.y]}},{key:"toString",value:function(){return this.valueOf().join(", ")}},{key:"equals",value:function(t){return e.equals(this,t)}},{key:"clone",value:function(){return e.fromPoint(this)}}],[{key:"equals",value:function(e,t){return this.isPoint(e)&&this.isPoint(t)&&e.x===t.x&&e.y===t.y}},{key:"isPoint",value:function(t){return t&&t instanceof e}},{key:"isPointLike",value:function(e){return this.isPoint(e)?!0:e?s.hasOwn(e,"x")&&s.hasOwn(e,"y"):!1}},{key:"fromPoint",value:function(t){return new e(t.x,t.y)}},{key:"fromPolar",value:function(t,n,i){i=i||new e(0,0);var r=Math.abs(t*Math.cos(n)),o=Math.abs(t*Math.sin(n)),a=s.normalizeAngle(s.toDeg(n));return 90>a?o=-o:180>a?(r=-r,o=-o):270>a&&(r=-r),new e(i.x+r,i.y+o)}},{key:"fromString",value:function(t){var n=t.split(-1===t.indexOf("@")?" ":"@");return new e(s.toFloat(n[0]),s.toFloat(n[1]))}},{key:"random",value:function(t,n,i,r){var o=Math.floor(Math.random()*(n-t+1)+t),a=Math.floor(Math.random()*(r-i+1)+i);return new e(o,a)}}]),e}();t["default"]=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(5),u=r(s),l=n(18),c=i(l),h=function(){function e(t,n){if(o(this,e),!t)throw new Error("The start point of line must be specified");if(!n)throw new Error("The end point of line must be specified");this.start=t,this.end=n}return a(e,[{key:"getLength",value:function(){return Math.sqrt(this.getSquaredLength())}},{key:"getSquaredLength",value:function(){var e=this.end.x-this.start.x,t=this.end.y-this.end.x;return e*e+t*t}},{key:"getMidpoint",value:function(){var e=(this.start.x+this.end.x)/2,t=(this.start.y+this.end.y)/2;return new c["default"](e,t)}},{key:"getPointAt",value:function(e){var t=(1-e)*this.start.x+e*this.end.x,n=(1-e)*this.start.y+e*this.end.y;return new c["default"](t,n)}},{key:"intersection",value:function(e){var t=this.start,n=this.end,i=e.start,r=e.end,o=new c["default"](n.x-t.x,n.y-t.y),a=new c["default"](r.x-i.x,r.y-i.y),s=o.x*a.y-o.y*a.x,u=new c["default"](i.x-t.x,i.y-t.y),l=u.x*a.y-u.y*a.x,h=u.x*o.y-u.y*o.x;if(0===s||0>l*s||0>h*s)return null;if(s>0){if(l>s||h>s)return null}else if(s>l||s>h)return null;return new c["default"](t.x+l*o.x/s,t.y+l*o.y/s)}},{key:"getDirection",value:function(){var e=this.start,t=this.end,n=u.toRad(e.y),i=u.toRad(t.y),r=e.x,o=t.x,a=u.toRad(o-r),s=Math.sin(a)*Math.cos(i),l=Math.cos(n)*Math.sin(i)-Math.sin(n)*Math.cos(i)*Math.cos(a),c=["NE","E","SE","S","SW","W","NW","N"],h=u.toDeg(Math.atan2(s,l)),f=h-22.5;return 0>f&&(f+=360),f=u.toInt(f/45),c[f]}},{key:"getOffset",value:function(e){var t=this.start,n=this.end;return((n.x-t.x)*(e.y-t.y)-(n.y-t.y)*(e.x-t.x))/2}},{key:"valueOf",value:function(){return[this.satrt.valueOf(),this.end.valueOf()]}},{key:"toString",value:function(){return this.start.toString()+" "+this.end.toString()}},{key:"equals",value:function(t){return e.equals(this,t)}},{key:"clone",value:function(){return e.fromLine(this)}}],[{key:"equals",value:function(e,t){return this.isLine(e)&&this.isLine(t)&&(e.start&&e.start.equals(t.start)||!e.start&&!t.start)&&(e.end&&e.end.equals(t.end)||!e.end&&!t.end)}},{key:"fromLine",value:function(t){return new e(t.start.clone(),t.end.clone())}},{key:"isLine",value:function(t){return t&&t instanceof e}}]),e}();t["default"]=h},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){var n=this.getChildCount();return t=p.fixIndex(t,n),e.parent===this&&t===n&&t--,e.removeFromParent({silent:!0}),e.parent=this,this.children&&this.children.length?this.children.splice(t,0,e):(this.children=[],this.children.push(e)),this}function s(e,t){var n=e&&e.getModel();return!n&&t&&t.getModel&&(n=t.getModel()),n}function u(e){return this.setParent.scheduled=e,this}function l(){return this.setParent.scheduled===!0}function c(e){return this.setTerminal.scheduled=e,this}function h(){return this.setTerminal.scheduled===!0}Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),d=n(5),p=r(d),v=n(21),y=i(v),g=function(){function e(t){o(this,e);var n=p.merge({},this.constructor.defaults,t);this.data=n.data,this.attrs=n.attrs||{},this.visible=n.visible!==!1,this.metadata=n}return f(e,[{key:"isLink",value:function(){return!1}},{key:"getTerminal",value:function(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0];return e?this.source:this.target}},{key:"setTerminal",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(c.call(this,!1),!n.silent){var i=s(this,e);i&&(i.setTerminal(this,e,t),c.call(this,!0))}return h.call(this)||(e=e?new y["default"](e):null,t?(this.source=e,e?(this.sourceNode=e.node,this.sourcePort=e.port,this.sourcePoint=e.point):(this.sourceNode=null,this.sourcePort=null,this.sourcePoint=null)):(this.target=e,e?(this.targetNode=e.node,this.targetPort=e.port,this.targetPoint=e.point):(this.targetNode=null,this.targetPort=null,this.targetPoint=null))),this}},{key:"getTerminalNode",value:function(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0],t=e?this.sourceNode:this.targetNode;if(!t){var n=this.getTerminal(e);t=n&&n.node||null}return t}},{key:"setTerminalNode",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(c.call(this,!1),!n.silent){var i=s(this,e);i&&(i.setTerminalNode(this,e,t),c.call(this,!0))}if(!h.call(this)){t?this.sourceNode=e:this.targetNode=e;var r=this.getTerminal(t);r&&(r.node=e)}return this}},{key:"getTerminalPort",value:function(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0],t=e?this.sourcePort:this.targetPort;if(!t){var n=this.getTerminal(e);t=n&&n.port||null}return t}},{key:"setTerminalPort",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(c.call(this,!1),!n.silent){var i=s(this);i&&(i.setTerminalPort(this,e,t),c.call(this,!0))}if(!h.call(this)){t?this.sourcePort=e:this.targetPort=e;var r=this.getTerminal(t);r&&(r.port=e)}return this}},{key:"getTerminalPoint",value:function(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0],t=e?this.sourcePoint:this.targetPoint;if(!t){var n=this.getTerminal(e);t=n&&n.point||null}return t}},{key:"setTerminalPoint",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(c.call(this,!1),!n.silent){var i=s(this);i&&(i.setTerminalPoint(this,e,t),c.call(this,!0))}if(!h.call(this)){t?this.sourcePoint=e:this.targetPoint=e;var r=this.getTerminal(t);r&&(r.point=e)}return this}},{key:"removeFromTerminal",value:function(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0],t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=this.getTerminal(e);if(n){if(c.call(this,!1),!t.silent){var i=s(this,n);i&&(i.removeFromTerminal(this,e),c.call(this,!0))}h.call(this)||n.removeLink(this,e,{silent:!0})}return this}},{key:"isNode",value:function(){return!1}},{key:"getLinkCount",value:function(){return this.links?this.links.length:0}},{key:"indexOfLink",value:function(e){return p.indexOf(this.links,e)}},{key:"getLinkAt",value:function(e){return this.links?this.links[e]:null}},{key:"eachLink",value:function(e,t){return p.forEach(this.links,e,t)}},{key:"filterLink",value:function(e,t){return p.filter(this.links,e,t)}},{key:"addLink",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(!e)return this;if(c.call(e,!1),!n.silent){var i=s(e,this);i&&(i.setTerminal(e,this,t),c.call(e,!0))}return h.call(e)||(e.removeFromTerminal(t,{silent:!0}),(!this.links||this.indexOfLink(e)<0||e.getTerminalNode(!t)!==this)&&(this.links||(this.links=[]),this.links.push(e)),e.setTerminal(this,t,{silent:!0})),this}},{key:"removeLink",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(!e)return this;if(c.call(e,!1),!n.silent){var i=s(e,this);i&&(i.setTerminal(e,null,t),c.call(e,!0))}if(!h.call(e)){if(this.links&&e.getTerminalNode(!t)!==this){var r=this.indexOfLink(e);r>=0&&this.links.splice(r,1)}e.setTerminal(null,t,{silent:!0})}return this}},{key:"getChildCount",value:function(){return this.children?this.children.length:0}},{key:"indexOfChild",value:function(e){return p.indexOf(this.children,e)}},{key:"getChildAt",value:function(e){return this.children?this.children[e]:null}},{key:"eachChild",value:function(e,t){return p.forEach(this.children,e,t)}},{key:"filterChild",value:function(e,t){return p.filter(this.children,e,t)}},{key:"insertChild",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return e?(p.isObject(t)&&(n=t),u.call(e,!1),n.silent||e.setParent(this,t),l.call(e)||a.call(this,e,t),this):this}},{key:"removeChild",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return this.removeChildAt(this.indexOfChild(e),t)}},{key:"removeChildAt",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=this.getChildAt(e);return n&&(u.call(n,!1),t.silent||n.setParent(null),l.call(n)||(this.children.splice(e,1),n.parent=null)),n}},{key:"getParent",value:function(){return this.parent}},{key:"setParent",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(u.call(this,!1),!n.silent){var i=s(this,e);i&&(i.setParent(this,e,t),u.call(this,!0))}return l.call(this)||(e?a.call(e,this,t):this.removeFromParent({silent:!0})),this}},{key:"removeFromParent",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(this.parent){var t=!1;if(!e.silent){var n=s(this,this.parent);n&&(n.removeCell(this),t=!0)}t||this.parent.removeChild(this,{silent:!0})}return this}},{key:"isOrphan",value:function(){return p.isNil(this.parent)}},{key:"isAncestor",value:function(e){if(!e)return!1;for(;e&&e!==this;)e=e.parent;return e===this}},{key:"contains",value:function(e){return this.isAncestor(this,e)}},{key:"getAncestors",value:function(){for(var e=[],t=this.parent;t;)e.push(t),t=t.parent;return e}},{key:"getDescendants",value:function(){var e=this,t=[];return this.eachChild(function(n){t.push(n),t=t.concat(e.getDescendants(n))},this),t}},{key:"getSize",value:function(e){return e?this.metadata.size:this.size}},{key:"setSize",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=!1;if(e={width:e.width,height:e.height,relative:e.relative===!0},!t.silent){var i=this.getModel();i&&(i.setSize(this,e),n=!0)}return!n&&this.metadata&&(this.metadata.size=e),this}},{key:"resize",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return this.setSize({width:e,height:t},n)}},{key:"getPosition",value:function(e){return e?this.metadata.position:this.position}},{key:"setPosition",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=!1;if(e={x:e.x,y:e.y,relative:e.relative===!0},!t.silent){var i=this.getModel();i&&(i.setPosition(this,e),n=!0)}return!n&&this.metadata&&(this.metadata.position=e),this}},{key:"translate",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return this.setPosition({x:e,y:t},n)}},{key:"getRotation",value:function(e){return e?this.metadata.rotation:this.rotation}},{key:"setRotation",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=!1;if(e={angle:e.angle,relative:e.relative===!0},!t.silent){var i=this.getModel();i&&(i.setRotation(this,e),n=!0)}return!n&&this.metadata&&(this.metadata.rotation=e),this}},{key:"rotate",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return this.setRotation({angle:e},t)}},{key:"getGeometry",value:function(e){return{size:this.getSize(e),position:this.getPosition(e),rotation:this.getRotation(e)}}},{key:"setGeometry",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=!1;if(!n.silent){var r=this.getModel();r&&(r.setGeometry(this,e),i=!0)}return i||p.forEach(["size","position","rotation"],function(n){var i=e[n];i&&t["set"+p.ucFirst(n)](i,{silent:!0})},this),this}},{key:"isVisible",value:function(){return this.visible!==!1}},{key:"setVisible",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=!1;if(!t.silent){var i=s(this);i&&(i.setVisible(this,e),n=!0)}return n||(this.visible=!!e,this.metadata.visible=this.visible),this}},{key:"show",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.setVisible(!0,e),this}},{key:"hide",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.setVisible(!1,e),this}},{key:"toggle",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.isVisible()?this.hide(e):this.show(e),this}},{key:"getAttribute",value:function(){return this.metadata.attrs}},{key:"setAttribute",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=!1;if(!t.silent){var i=this.getModel();i&&(i.setAttribute(this,e),n=!0)}return!n&&this.metadata&&(this.metadata.attrs=p.merge({},this.getAttribute(),e)),this}},{key:"getId",value:function(){return this.id}},{key:"setId",value:function(e){this.id=e}},{key:"getModel",value:function(){return this.model}},{key:"setModel",value:function(e){return this.model=e||null,this}},{key:"addTo",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?this.getModel():arguments[2];return n&&n.addCell(this,e,t),this}},{key:"getView",value:function(e){return e.getView(this)}},{key:"getClassName",value:function(){var e=this.metadata.classNames;return p.isArray(e)?e.join(" "):e||""}},{key:"getTagName",value:function(){return this.metadata.tagName||"g"}},{key:"getMarkup",value:function(){return this.metadata.markup}},{key:"valueOf",value:function(){return this.data}},{key:"toString",value:function(){return this.getId()||Object.toString.call(this)}},{key:"cloneData",value:function(){var e=this.data;if(e){if(e.clone&&p.isFunction(e.clone))return e.clone();if(p.isNode(e))return e.cloneNode(!0);if(p.isObject(e))return p.merge({},e)}return e}},{key:"clone",value:function(e,t){var n=p.merge({},this.metadata,e);return n.data=t===!0?this.cloneData():this.data,n.visible=this.visible,new this.constructor(n)}},{key:"destroy",value:function(){this.eachChild(function(e){e.destroy()}),this.eachLink(function(e){e.destroy()}),this.removeFromTerminal(!0).removeFromTerminal(!1).removeFromParent(),p.destroy(this)}}],[{key:"setDefaults",value:function(e){this.defaults=p.merge({},this.defaults,e)}}]),e}();t["default"]=g},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){return this.setTerminal.scheduled=e,this}function s(){return this.setTerminal.scheduled===!0}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(18),f=i(h),d=function(){function e(t){return o(this,e),t instanceof e?t:void(t&&(t.isNode&&t.isNode()?this.node=t:f["default"].isPointLike(t)?this.point=f["default"].fromPoint(t):c.isObject(t)&&(this.node=t.node,this.port=t.port,this.point=f["default"].isPointLike(t.point)?f["default"].fromPoint(t.point):null)))}return u(e,[{key:"addLink",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(e){if(a.call(e,!1),!n.silent){var i=e.getModel()||this.getModel();i&&(i.setTerminal(e,this,t),a.call(e,!0))}s.call(e)||(this.node&&this.node.addLink(e,t,{silent:!0}),e.setTerminal(this,t,{silent:!0}))}return this}},{key:"removeLink",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(e){if(a.call(e,!1),!n.silent){var i=e.getModel()||this.getModel();i&&(i.setTerminal(e,null,t),a.call(e,!0))}s.call(e)||(this.node&&this.node.removeLink(e,t,{silent:!0}),e.setTerminal(null,t,{silent:!0}))}return this}},{key:"duplicate",value:function(t){var n=new e(t);return c.forEach(["node","port","point"],function(e){this[e]&&!n[e]&&(n[e]=this[e])},this),n}},{key:"getModel",value:function(){return this.node&&this.node.getModel()}}]),e}();t["default"]=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(3),f=i(h),d=function(e){function t(e){o(this,t);var n=a(this,Object.getPrototypeOf(t).call(this,e));return n.parsePathData(),n}return s(t,e),u(t,[{key:"parsePathData",value:function(){var e=this.getPathData()||"",t=e.match(/([A-Za-z])/g);e=e.replace(/^[A-Za-z]/,"").replace(/[A-Za-z]$/,"");var n=c.split(e,/[A-Za-z]/);n=c.map(n,function(e){e=c.trim(e);for(var t=c.split(e,/[\s,]+/),n=[],i=0,r=t.length;r>i;i+=2)n.push({x:c.toFloat(t[i]),y:c.toFloat(t[i+1])});return n});var i=c.reduce(n,function(e,t){return e.concat(t)},[]),r=i[0].x,o=i[0].y;c.forEach(i,function(e){r=Math.min(e.x,r),o=Math.min(e.y,o)});var a=[];c.forEach(n,function(e,n){t[n]&&a.push(t[n]),c.forEach(e,function(e){var t=c.toFixed(e.x-r,2),n=c.toFixed(e.y-o,2);a.push(t,n)})}),t[n.length]&&a.push(t[n.length]);var s=a.join(" "),u=this.metadata.attrs;u.path?u.path.d=s:u.path={d:s}}},{key:"getPathData",value:function(){var e=this.metadata,t=e.attrs,n=t&&t.path,i=n&&n.d;if(!i){var r=/<path(?:.+)d=(["|'])(.*?)\1/,o=e.markup||"",a=o.match(r);a&&(i=a[2])}return i}}]),t}(f["default"]);d.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><path/></g><text/></g>',size:{width:60,height:60},attrs:{".":{fill:"#ffffff",stroke:"none"},path:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle",ref:"path","ref-x":.5,"ref-dy":10,fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),u=i(s),l=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(u["default"]);l.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><text/></g></g>',attrs:{".":{fill:"#ffffff",stroke:"none"},text:{"font-size":18,fill:"#000000"}}}),t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(25),f=i(h),d=function(e){function t(e){o(this,t);var n=a(this,Object.getPrototypeOf(t).call(this,e));return n.updatePortsAttrs(),n}return s(t,e),u(t,[{key:"updatePortsAttrs",value:function(){var e={};return c.forEach(this.inPorts,function(t,n){c.merge(e,this.getPortAttrs(t,n,!0))},this),c.forEach(this.outPorts,function(t,n){c.merge(e,this.getPortAttrs(t,n,!1))},this),c.merge(this.attrs,e),this}},{key:"getPortAttrs",value:function(e,t,n){var i={},r=n?this.inPorts:this.outPorts,o=this.getPortSelector(e,n),a=o+">.port-label";return i[a]={text:e.id},i[o]={ref:".node-body","ref-y":(t+.5)*(1/r.length)},n||(i[o]["ref-dx"]=0),i}},{key:"getPortSelector",value:function(e,t){return this.getPortsWrapSelector(t)+'>.pane-port[data-id="'+e.id+'"]'}},{key:"getPortsWrapSelector",value:function(e){return".pane-ports."+(e?"in":"out")}}]),t}(f["default"]);d.setDefaults({size:{width:80,height:100},markup:'<g class="pane-rotatable">  <g class="pane-scalable">    <rect class="node-body"/>  </g>  <text class="node-label"/>  <g class="pane-ports in" />  <g class="pane-ports out" /></g>',portMarkup:'<g class="pane-port" data-id="${id}">  <circle class="port-body"/>  <text class="port-label"/></g>',attrs:{".node-label":{text:"port","ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"},".in .port-label":{x:-15,dy:4},".out .port-label":{x:15,dy:4}}}),t["default"]=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(3),f=i(h),d=n(26),p=i(d),v=function(e){function t(e){o(this,t);var n=a(this,Object.getPrototypeOf(t).call(this,e));return n.portById={},n.inPorts=c.map(n.metadata.inPorts,function(e){var t=this.standardizePort(e);return this.portById[t.id]=t,t},n),n.outPorts=c.map(n.metadata.outPorts,function(e){var t=this.standardizePort(e);return this.portById[t.id]=t,t},n),n}return s(t,e),u(t,[{key:"eachInPort",value:function(e,t){c.forEach(this.inPorts,e,t)}},{key:"eachOutPort",value:function(e,t){c.forEach(this.outPorts,e,t)}},{key:"getInPorts",value:function(){return this.inPorts}},{key:"getOutPorts",value:function(){return this.outPorts}},{key:"getPortById",value:function(e){return this.portById[e]||null}},{key:"isInPort",value:function(e){return c.some(this.inPorts,function(t){return t.id===e.id})}},{key:"isOutPort",value:function(e){return c.some(this.outPorts,function(t){return t.id===e.id})}},{key:"standardizePort",value:function(e){return c.isObject(e)||(e={id:e}),e.id||(e.id=c.uuid()),e}},{key:"getPortMarkup",value:function(){return this.metadata.portMarkup}},{key:"getPortSelector",value:function(){}},{key:"getPortsWrapSelector",value:function(){}}]),t}(f["default"]);v.setDefaults({tagName:"g",markup:"",portMarkup:"",classNames:"pane-node",pane:null,view:p["default"],data:null,attrs:null,inPorts:[],outPorts:[],size:{width:1,height:1,relative:!1},position:{x:0,y:0,relative:!1},rotation:{angle:0,inherited:!0}}),t["default"]=v},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){
if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function k(e,t,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:k(r,t,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},h=n(5),f=r(h),d=n(27),p=i(d),v=n(28),y=i(v),g=n(29),m=i(g),b=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),l(t,[{key:"renderMarkup",value:function(){return c(Object.getPrototypeOf(t.prototype),"renderMarkup",this).call(this),this.renderPorts(),this}},{key:"renderPorts",value:function(){var e=this.vel,t=this.getCell(),n=t.getInPorts(),i=t.getOutPorts(),r=t.getPortMarkup(),o=e.findOne(t.getPortsWrapSelector(!0)),a=e.findOne(t.getPortsWrapSelector(!1));return o&&(o.empty(),f.forEach(n,function(e){var t=this.compileMarkup(r,e);o.append((0,p["default"])(t))},this)),a&&(a.empty(),f.forEach(i,function(e){var t=this.compileMarkup(r,e);a.append((0,p["default"])(t))},this)),this}},{key:"getConnectionPointOnPort",value:function(){return null}},{key:"getPortBodyBBox",value:function(e){var t=this.getCell(),n=f.isObject(e)?e.id:e;e=t.getPortById(n);var i=t.getPortSelector(e,t.isInPort(e));if(i){var r=this.findOne(i),o=r&&r.findOne(".port-body");if(o)return o.getBBox()}}},{key:"getPortBodyGeom",value:function(e){var t=this.getCell(),n=f.isObject(e)?e.id:e;e=t.getPortById(n);var i=t.getPortSelector(e,t.isInPort(e));if(i){var r=this.findOne(i),o=r&&r.findOne(".port-body"),a=o&&o.node;if(a){var s=o.getBBox(!1,this.getPane()),u=s.getCenter(),l=void 0;if(f.isNode(a,"circle")){var c=f.getComputedStyle(a,"r");c=f.toFloat(c),c&&(l=new y["default"](u.x,u.y,c,c))}else if(f.isNode(a,"ellipse")){var h=f.getComputedStyle(a,"rx"),d=f.getComputedStyle(a,"ry");h=f.toFloat(h),d=f.toFloat(d),h&&d&&(l=new y["default"](u.x,u.y,h,d))}else l=s;return l}}}},{key:"findPortByElem",value:function(e){var t=this,n=t.vel,i=t.cell,r=(0,p["default"])(e),o="pane-port";if(r.hasClass(o)||(r=r.findParent(o,n.node)),r){var a=r.parent();if(a){var s=function(){var e=r.index(),t=a.hasClass("in")?"in":a.hasClass("out")?"out":"",n="in"===t?i.inPorts:"out"===t?i.outPorts:[],o=i.getPortSelector(t,e),s=null;return f.some(n,function(e){return e.selector===o?(s=e,!0):void 0}),{v:s}}();if("object"===("undefined"==typeof s?"undefined":u(s)))return s.v}}return null}}]),t}(m["default"]);t["default"]=b},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(){var e=void 0;do w+=1,e="pane-path-"+w;while(document.getElementById(e));return e}function s(e,t){return{x:t.x*e.a+t.y*e.c,y:t.x*e.b+t.y*e.d}}function u(e){var t=s(e,{x:0,y:1}),n=s(e,{x:1,y:0}),i=180/Math.PI*Math.atan2(t.y,t.x)-90,r=180/Math.PI*Math.atan2(n.y,n.x);return{skewX:i,skewY:r,translateX:e.e,translateY:e.f,scaleX:Math.sqrt(e.a*e.a+e.b*e.b),scaleY:Math.sqrt(e.c*e.c+e.d*e.d),rotation:i}}function l(e){var t=x.isVElement(e)?e:d(e);return y.isArray(t)?t[t.length-1]:t}function c(e,t,n){if(e){var i=y.map(y.isArray(e)?e:[e],function(t){return x.isVElement(t)?t:d(e)});y.forEach(i,t,n)}}function h(e){return new P(e)}function f(e){return e instanceof P?e.node:e}function d(e,t,n){if(!e)return null;if(e instanceof P&&(e=e.node),y.isString(e))if("svg"===e.toLowerCase())e=y.createSvgDocument();else if("<"===e[0]){var i=y.createSvgDocument(e);if(i.childNodes.length>1)return y.map(i.childNodes,function(e){return h(document.importNode(e,!0))});e=document.importNode(i.firstChild,!0)}else e=y.createSvgElement(e);var r=h(e);return t&&r.setAttrs(t),n&&r.append(n),r}Object.defineProperty(t,"__esModule",{value:!0}),t.VElement=void 0;var p=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),v=n(5),y=r(v),g=n(4),m=i(g),b=n(18),k=i(b),w=0,P=t.VElement=function(){function e(t){if(o(this,e),!(this instanceof e))return new e(t);if(t instanceof e&&(t=t.node),!t)throw new Error("Unknown elem for VElement");this.node=t}return p(e,[{key:"attr",value:function(e,t){return y.isUndefined(e)?y.reduce(this.node.attributes,function(e,t){return e[t.nodeName]=t.nodeValue,e},{}):y.isString(e)&&y.isUndefined(t)?this.node.getAttribute(e):(y.isObject(e)?this.setAttrs(e):this.setAttr(e,t),this)}},{key:"setAttr",value:function(e,t){return y.isNil(t)?this.removeAttr(e):y.setAttribute(this.node,e,t),this}},{key:"setAttrs",value:function(e){return y.forIn(e,function(e,t){this.setAttr(t,e)},this),this}},{key:"removeAttr",value:function(e){return y.removeAttribute(this.node,e),this}},{key:"show",value:function(){return y.showHide(this.node,!0),this}},{key:"hide",value:function(){return y.showHide(this.node,!1),this}},{key:"toggle",value:function(e){return y.isBoolean(e)?e?this.show():this.hide():(y.isHidden(this.node)?this.show():this.hide(),this)}},{key:"getClassName",value:function(){return y.getClassName(this.node)}},{key:"hasClass",value:function(e){return y.hasClass(this.node,e)}},{key:"addClass",value:function(e){return y.addClass(this.node,e),this}},{key:"removeClass",value:function(e){return y.removeClass(this.node,e),this}},{key:"toggleClass",value:function(e,t){return y.toggleClass(this.node,e,t),this}},{key:"css",value:function(e,t){return e?(y.setStyle(this.node,e,t),this):this.node.style}},{key:"text",value:function(e,t){e=y.sanitizeText(e),t=t||{};var n=this.attr("y");n||this.attr("y","0.8em"),this.attr("display",e?null:"none"),this.attr("xml:space","preserve"),this.node.textContent="";var i=this.node,r=t.textPath;if(r){var o=this.find("defs");o.length||(o=d("defs"),this.append(o));var s=Object(r)===r,u=s?r.d:r,l=void 0;u&&(l=d("path",{d:u,id:a()}),o.append(l));var c=d("textPath");!r["xlink:href"]&&l&&c.attr("xlink:href","#"+l.node.id),s&&c.attr(r),this.append(c),i=c.node}var h=0,f=e.split("\n"),p=t.lineHeight,v=t.annotations,g=t.includeAnnotationIndices;return v&&(v=y.isArray(v)?v:[v]),p="auto"===p?"1.5em":p||"1em",y.forEach(f,function(e,n){var r=d("tspan",{dy:n?p:"0",x:this.attr("x")||0});r.addClass("pane-text-line"),e?v?!function(){var i=0,o=x.annotateString(e,v,{offset:-h,includeAnnotationIndices:g});y.forEach(o,function(e){var t=void 0;if(y.isObject(e)){var n=y.toInt(e.attrs["font-size"]);n&&n>i&&(i=n),t=d("tspan",e.attrs),g&&t.attr("annotations",e.annotations),e.attrs["class"]&&t.addClass(e.attrs["class"]),t.node.textContent=e.t}else t=document.createTextNode(e||" ");r.append(t)}),"auto"===t.lineHeight&&i&&0!==n&&r.attr("dy",1.2*i+"px")}():r.node.textContent=e:(r.addClass("pane-text-empty"),r.node.style.opacity=0,r.node.textContent="-"),i.appendChild(r.node),h+=e.length+1},this),this}},{key:"remove",value:function(){return y.removeElement(this.node),this}},{key:"empty",value:function(){return y.emptyElement(this.node),this}},{key:"append",value:function(e){return c(e,function(e){this.node.appendChild(f(e))},this),this}},{key:"prepend",value:function(e){return c(e,function(e){this.node.insertBefore(f(e),this.node.firstChild)},this),this}},{key:"before",value:function(e){return c(e,function(e){this.node.parentNode&&this.node.parentNode.insertBefore(f(e),this.node)},this),this}},{key:"after",value:function(e){return c(e,function(e){this.node.parentNode&&this.node.parentNode.insertBefore(f(e),this.node.nextSibling)},this),this}},{key:"appendTo",value:function(e){return l(e).append(this),this}},{key:"prependTo",value:function(e){return l(e).prepend(this),this}},{key:"insertBefore",value:function(e){return l(e).before(this),this}},{key:"insertAfter",value:function(e){return l(e).after(this),this}},{key:"getSVG",value:function(){return this.node instanceof window.SVGSVGElement?this:h(this.node.ownerSVGElement)}},{key:"getDefs",value:function(){var e=this.getSVG(),t=e.node.getElementsByTagName("defs");return t&&t.length?t=h(t[0]):(t=d("defs"),e.append(t)),t}},{key:"clone",value:function(){var e=h(this.node.cloneNode(!0));return this.node.id&&e.node.removeAttribute("id"),e}},{key:"find",value:function(e){return y.map(this.node.querySelectorAll(e),h)}},{key:"findOne",value:function(e){var t=this.node.querySelector(e);return t?h(t):null}},{key:"findParent",value:function(e,t){for(var n=t||this.node.ownerSVGElement,i=this.node.parentNode;i&&i!==n;){var r=h(i);if(r.hasClass(e))return r;i=i.parentNode}return null}},{key:"parent",value:function(){var e=this.node&&this.node.parentNode;return e?h(e):null}},{key:"index",value:function(){for(var e=0,t=this.node.previousSibling;t;)1===t.nodeType&&e++,t=t.previousSibling;return e}},{key:"translate",value:function(e,t,n){var i=this.attr("transform")||"",r=y.parseTranslate(i);if(y.isUndefined(e))return r;e=n?r.tx+e:e,t=n?r.ty+t:t;var o=y.clearTranslate(i),a="translate("+e+","+t+")";return o&&(a=a+" "+o),this.attr("transform",a),this}},{key:"rotate",value:function(e,t,n,i){var r=this.attr("transform")||"",o=y.parseRotate(r);if(y.isUndefined(e))return o;e%=360;var a=i?o.angle+e:e,s=y.isUndefined(t)||y.isUndefined(n)?"":","+t+","+n,u=y.clearRotate(r),l="rotate("+a+s+")";return u&&(l=u+" "+l),this.attr("transform",l)}},{key:"scale",value:function(e,t,n){var i=this.attr("transform")||"",r=y.parseScale(i);if(y.isUndefined(e))return r;y.isUndefined(t)&&(t=e),e=n?r.sx*e:e,t=n?r.sy*t:t;var o=y.clearScale(i),a="scale("+e+","+t+")";return o&&(a=o+" "+a),this.attr("transform",a)}},{key:"getBBox",value:function(e,t){if(!this.node.ownerSVGElement)return new m["default"](0,0,0,0);var n=void 0;try{n=this.node.getBBox(),n={x:n.x,y:n.y,width:n.width,height:n.height}}catch(i){n={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}if(!e){var r=this.getTransformToElement(t||this.node.ownerSVGElement);n=x.transformRect(n,r)}return m["default"].fromRect(n)}},{key:"toLocalPoint",value:function(e,t){var n=this.getSVG().node,i=n.createSVGPoint();i.x=e,i.y=t;try{var r=i.matrixTransform(n.getScreenCTM().inverse()),o=this.getTransformToElement(n).inverse();return r.matrixTransform(o)}catch(a){return i}}},{key:"getTransformToElement",value:function(e){return y.getTransformToElement(this.node,e)}},{key:"translateCenterToPoint",value:function(e){var t=this.getBBox(),n=t.getCenter();return this.translate(e.x-n.x,e.y-n.y),this}},{key:"translateAndAutoOrient",value:function(e,t,n){var i=this.scale();this.attr("transform",""),this.scale(i.sx,i.sy);var r=this.getSVG().node,o=this.getBBox(!1,n),a=r.createSVGTransform();a.setTranslate(-o.x-o.width/2,-o.y-o.height/2);var s=r.createSVGTransform(),l=k["default"].fromPoint(e).changeInAngle(e.x-t.x,e.y-t.y,t);s.setRotate(l,0,0);var c=r.createSVGTransform(),h=k["default"].fromPoint(e).move(t,o.width/2);c.setTranslate(e.x+(e.x-h.x),e.y+(e.y-h.y));var f=this.getTransformToElement(n),d=r.createSVGTransform();d.setMatrix(c.matrix.multiply(s.matrix.multiply(a.matrix.multiply(f))));var p=u(d.matrix);return this.translate(y.toFixed(p.translateX,2),y.toFixed(p.translateY,2)),this.rotate(y.toFixed(p.rotation,2)),this}},{key:"animateAlongPath",value:function(){}},{key:"sample",value:function t(e){e=e||1;for(var n=this.node.getTotalLength(),i=0,r=[];n>i;){var t=this.node.getPointAtLength(i);r.push({distance:i,x:t.x,y:t.y}),i+=e}return r}},{key:"toPath",value:function(){var e=h(y.createSvgElement("path")),t=this.toPathData();return e.attr(this.attr()),t&&e.attr("d",t),e}},{key:"toPathData",value:function(){var e=this.node.tagName.toLowerCase();if("path"===e)return this.attr("d");var t=y[e+"ToPathData"];if(y.isFunction(t))return t(this.node);throw new Error(e+" cannot be converted to PATH.")}},{key:"findIntersection",value:function(e,t){var n=this,i=n.getSVG().node;t=t||i;var r=m["default"].fromRect(n.getBBox(!1,t)),o=r.getCenter(),a=r.intersectionWithLineFromCenterToPoint(e);if(a){var s=n.node.localName.toUpperCase();if("RECT"===s){var u=new m["default"](parseFloat(this.attr("x")||0),parseFloat(this.attr("y")||0),parseFloat(this.attr("width")),parseFloat(this.attr("height"))),l=n.getTransformToElement(t),c=x.decomposeMatrix(l),h=i.createSVGTransform();h.setRotate(-c.rotation,o.x,o.y);var f=x.transformRect(u,h.matrix.multiply(l));a=m["default"].fromRect(f).intersectionWithLineFromCenterToPoint(e,c.rotation)}else if("PATH"===s||"POLYGON"===s||"POLYLINE"===s||"CIRCLE"===s||"ELLIPSE"===s){for(var d="PATH"===s?n:n.toPath(),p=d.sample(),v=1/0,y=[],g=0,b=p.length;b>g;g++){var w=p[g],P=x.createSVGPoint(w.x,w.y);P=P.matrixTransform(n.getTransformToElement(t)),w=k["default"].fromPoint(P);var O=w.distance(o),C=1.1*w.distance(e),M=O+C;v>M?(v=M,y=[{sample:w,refDistance:C}]):v+1>M&&y.push({sample:w,refDistance:C})}y.sort(function(e,t){return e.refDistance-t.refDistance}),a=y[0].sample}return a}}}]),e}(),x=P.create=d,O=d("svg").node;y.extend(x,{isVElement:function(e){return e instanceof P},createSVGPoint:function(e,t){var n=O.createSVGPoint();return n.x=e,n.y=t,n},createSVGMatrix:function(e){var t=O.createSVGMatrix();for(var n in e)t[n]=e[n];return t},createSVGTransform:function(e){return y.isUndefined(e)?O.createSVGTransform():(e instanceof SVGMatrix||(e=x.createSVGMatrix(e)),O.createSVGTransformFromMatrix(e))},transformRect:function(e,t){var n=O.createSVGPoint();n.x=e.x,n.y=e.y;var i=n.matrixTransform(t);n.x=e.x+e.width,n.y=e.y;var r=n.matrixTransform(t);n.x=e.x+e.width,n.y=e.y+e.height;var o=n.matrixTransform(t);n.x=e.x,n.y=e.y+e.height;var a=n.matrixTransform(t),s=Math.min(i.x,r.x,o.x,a.x),u=Math.max(i.x,r.x,o.x,a.x),l=Math.min(i.y,r.y,o.y,a.y),c=Math.max(i.y,r.y,o.y,a.y);return{x:s,y:l,width:u-s,height:c-l}},annotations:function(e,t,n){t=t||[],t=y.isArray(t)?t:[t],n=n||{};for(var i=[],r=[],o=n.offset||0,a=void 0,s=void 0,u=void 0,l=0,c=e.length;c>l;l++){s=r[l]=e[l];for(var h=0,f=t.length;f>h;h++){var d=t[h],p=d.start+o,v=d.end+o;l>=p&&v>l&&(y.isObject(s)?s.attrs=y.merge({},s.attrs,d.attrs):s=r[l]={t:e[l],attrs:d.attrs},n.includeAnnotationIndices&&(s.annotations||(s.annotations=[]),s.annotations.push(h)))}u=r[l-1],u?y.isObject(s)&&y.isObject(u)?JSON.stringify(s.attrs)===JSON.stringify(u.attrs)?a.t+=s.t:(i.push(a),a=s):y.isObject(s)?(i.push(a),a=s):y.isObject(u)?(i.push(a),a=s):a=(a||"")+s:a=s}return a&&i.push(a),i}}),t["default"]=x},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(4),s=i(a),u=n(18),l=i(u),c=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],i=arguments.length<=2||void 0===arguments[2]?0:arguments[2],o=arguments.length<=3||void 0===arguments[3]?0:arguments[3];r(this,e),this.x=t,this.y=n,this.a=i,this.b=o}return o(e,[{key:"getCenter",value:function(){return new l["default"](this.x,this.y)}},{key:"getBBox",value:function(){return new s["default"](this.x-this.a,this.y-this.b,2*this.a,2*this.b)}},{key:"grow",value:function(e){return this.a+=e,this.b+=e,this}},{key:"intersectionWithLineFromCenterToPoint",value:function(e,t){var n=void 0,i=this.getCenter();t&&e.rotate(i,t);var r=e.x-this.x,o=e.y-this.y;if(0===r)return n=this.getBBox().getNearestPointToPoint(e),t?n.rotate(i,-t):n;var a=o/r,s=a*a,u=this.a*this.a,c=this.b*this.b,h=Math.sqrt(1/(1/u+s/c));h=0>r?-h:h;var f=a*h;return n=new l["default"](this.x+h,this.y+f),t?n.rotate(i,-t):n}},{key:"equals",value:function(t){return e.equals(this,t)}},{key:"valueOf",value:function(){return[this.x,this.y,this.a,this.b]}},{key:"toString",value:function(){return this.valueOf().join(", ")}},{key:"clone",value:function(){return e.fromEllipse(this)}}],[{key:"equals",value:function(e,t){return this.isEllipse(e)&&this.isEllipse(t)&&e.x===t.x&&e.y===t.y&&e.a===t.a&&e.b===t.b}},{key:"fromEllipse",value:function(t){return new e(t.x,t.y,t.a,t.b)}},{key:"isEllipse",value:function(t){return t&&t instanceof e}}]),e}();t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(30),f=i(h),d=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"render",value:function(){return this.vel.empty(),this.renderMarkup(),this.scalableNode=this.findOne(".pane-scalable"),this.rotatableNode=this.findOne(".pane-rotatable"),this.update().resize().rotate().translate()}},{key:"update",value:function(e){var n=this.cell.attrs,i=this.rotatableNode,r=void 0;i&&(r=i.attr("transform"),i.attr("transform",""));var o={},a=[];c.forIn(e||n,function(e,n){var i=this.find(n);if(i.length){o[n]=i;var r=t.specialAttributes.slice();c.isObject(e.filter)&&(r.push("filter"),this.applyFilter(i,e.filter)),c.isObject(e.fill)&&(r.push("fill"),this.applyGradient(i,"fill",e.fill)),c.isObject(e.stroke)&&(r.push("stroke"),this.applyGradient(i,"stroke",e.stroke)),c.isNil(e.text)||(r.push("lineHeight","textPath","annotations"),c.forEach(i,function(t){t.text(e.text,{textPath:e.textPath,lineHeight:e.lineHeight,annotations:e.annotations})}));var s={};c.forIn(e,function(e,t){c.contains(r,t)||(s[t]=e)}),c.isEmptyObject(s)||c.forEach(i,function(e){e.attr(s)}),c.isNil(e.html)||c.forEach(i,function(t){t.node.innerHTML=e.html});var u=c.some(["ref-x","ref-y","ref-dx","ref-dy","x-alignment","y-alignment","ref-width","ref-height"],function(t){return!c.isNil(e[t])});u&&a.push(n)}},this);var s=this.cell.size,u={x:0,y:0,width:s.width,height:s.height};return c.forEach(a,function(t){var i=n[t],r=e&&e[t];r&&(i=c.merge({},i,r)),c.forEach(o[t],function(e){this.positionRelative(e,u,i,o)},this)},this),i&&i.attr("transform",r||""),this}},{key:"positionRelative",value:function(e,t,n,i){var r=n.ref;if(r){var o=i&&i[r];if(o=o?o[0]:"."===r?this.vel:this.vel.findOne(r),!o)throw new Error("NodeView: reference does not exists.");t=o.getBBox(!1,this.elem)}var a=c.toFloat(n["ref-dx"]),s=c.toFloat(n["ref-dy"]),u=n["y-alignment"],l=n["x-alignment"],h=n["ref-x"],f=c.isPercentage(h);h=c.toFloat(h,f);var d=n["ref-y"],p=c.isPercentage(d);d=c.toFloat(d,p);var v=n["ref-width"],y=c.isPercentage(v);v=c.toFloat(v,y);var g=n["ref-height"],m=c.isPercentage(g);g=c.toFloat(g,m),c.isFinite(v)&&(y||v>=0&&1>=v?e.attr("width",c.toFixed(v*t.width,2)):e.attr("width",Math.max(c.toFixed(v+t.width,2),0))),c.isFinite(g)&&(m||g>=0&&1>=g?e.attr("height",c.toFixed(g*t.height,2)):e.attr("height",Math.max(c.toFixed(g+t.height,2),0)));var b=e.findParent("pane-scalable",this.elem),k=e.attr("transform");k&&e.attr("transform",c.clearTranslate(k));var w=0,P=0,x=void 0;if(c.isFinite(a)&&(b?(x=b.scale(),w=t.x+t.width+a/x.sx):w=t.x+t.width+a),c.isFinite(s)&&(b?(x=x||b.scale(),P=t.y+t.height+s/x.sy):P=t.y+t.height+s),c.isFinite(h)&&(f||h>0&&1>h?w=t.x+t.width*h:b?(x=x||b.scale(),w=t.x+h/x.sx):w=t.x+h),c.isFinite(d)&&(f||d>0&&1>d?P=t.y+t.height*d:b?(x=x||b.scale(),P=t.y+d/x.sy):P=t.y+d),!c.isNil(u)||!c.isNil(l)){var O=e.getBBox(!1,this.getPane());"middle"===u?P-=O.height/2:c.isFinite(u)&&(P+=u>-1&&1>u?O.height*u:u),"middle"===l?w-=O.width/2:c.isFinite(l)&&(w+=l>-1&&1>l?O.width*l:l)}return e.translate(c.toFixed(w,2),c.toFixed(P,2)),this}},{key:"scale",value:function(e,t){return this.vel.scale(e,t),this}},{key:"resize",value:function(){if(!this.scalableNode)return this;var e=this.scalableNode.getBBox(!0),t=this.cell.getSize(),n=t.width/(e.width||1),i=t.height/(e.height||1);return n=c.toFixed(n,2),i=c.toFixed(i,2),this.scalableNode.attr("transform","scale("+n+","+i+")"),this.update(),this}},{key:"rotate",value:function(){if(this.rotatableNode){var e=this.cell.getSize(),t=e.width/2,n=e.height/2;this.rotatableNode.attr("transform","rotate("+this.cell.getRotation()+","+t+","+n+")")}return this}},{key:"translate",value:function(){var e=this.cell.getPosition();return this.vel.attr("transform","translate("+e.x+","+e.y+")"),this}},{key:"getBBox",value:function(){return this.vel.getBBox()}},{key:"getStrokeWidth",value:function(){var e=this.findOne("rect")||this.findOne("path")||this.findOne("circle")||this.findOne("ellipse")||this.findOne("polyline")||this.findOne("polygon");if(e&&e.node){var t=c.getComputedStyle(e.node,"stroke-width");return t&&c.toFloat(t)||0}return 0}},{key:"getStrokedBBox",value:function(){var e=this.getStrokeWidth()-1,t=this.getCell().getBBox();return e?t.grow(e/2):t}},{key:"getConnectionPointOnBorder",value:function(){return null}}],[{key:"specialAttributes",get:function(){return["text","html","style","ref","ref-x","ref-y","ref-dx","ref-dy","ref-width","ref-height","x-alignment","y-alignment"]}}]),t}(f["default"]);t["default"]=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(27),f=i(h),d=n(31),p=i(d),v=n(32),y=i(v),g=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"ensureElement",value:function(){this.vel=(0,f["default"])(this.cell.getTagName(),{"class":this.cell.getClassName()}),this.elem=this.vel.node,this.elem.cellId=this.cell.id;var e=this.getPane();return e&&e.appendChild(this.elem),this}},{key:"renderMarkup",value:function(){var e=this.compileMarkup(this.cell.getMarkup(),this.cell.data);if(!e)throw new Error("`markup` is missing while the default `render()` implementation is used.");return this.vel.append((0,f["default"])(e)),this}},{key:"find",value:function(e){return"."===e?[this.vel]:this.vel.find(e)}},{key:"findOne",value:function(e){return"."===e?this.vel:this.vel.findOne(e)}},{key:"applyAttr",value:function(e,t){return t&&c.forEach(this.find(e),function(e){e.attr(t)}),this}},{key:"applyFilter",value:function(e,t){if(!t)return this;var n=t.name||"",i=t.args||{},r=t.attrs,o=p["default"][n];if(!n||!o)throw new Error('Invalided filter: "'+n+'"');var a=c.isString(e)?this.find(e):e;if(!a.length)return this;var s=this.paper.svg,u=c.hashCode(JSON.stringify(t)),l=n+"-"+this.paper.id+"-"+u;if(!s.getElementById(l)){var h=(0,f["default"])(o(i));h.attr({filterUnits:"objectBoundingBox",x:-1,y:-1,width:3,height:3}),r&&h.attr(r),h.node.id=l,(0,f["default"])(s).getDefs().append(h)}return c.forEach(a,function(e){e.attr("filter","url(#"+l+")")}),this}},{key:"applyGradient",value:function(e,t,n){if(!t||!n)return this;var i=n.type,r=n.stops,o=n.attrs;if(!i||!r||!r.length)return this;var a=c.isString(e)?this.find(e):e;if(!a.length)return this;var s=this.paper.svg,u=i+"-"+this.paper.id+"-"+c.hashCode(JSON.stringify(n));if(!s.getElementById(u)){var l=["<"+i+">",c.map(r,function(e){return'<stop offset="'+e.offset+'" stop-color="'+e.color+'" stop-opacity="'+(c.isFinite(e.opacity)?e.opacity:1)+'" />'}).join(""),"</"+i+">"].join(""),h=(0,f["default"])(l);o&&h.attr(o),h.node.id=u,(0,f["default"])(s).getDefs().append(h)}return c.forEach(a,function(e){e.attr(t,"url(#"+u+")")}),this}}]),t}(y["default"]);t["default"]=g},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),o=i(r),a=o.format,s=o.isFinite;t["default"]={outline:function(e){var t='<filter>  <feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/>  <feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${outerRadius}" />  <feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${innerRadius}" />  <feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/>  <feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/>  <feMerge>    <feMergeNode in="outline"/>    <feMergeNode in="SourceGraphic"/>  </feMerge></filter>',n=s(e.margin)?e.margin:2,i=s(e.width)?e.width:1;return a(t,{color:e.color||"blue",opacity:s(e.opacity)?e.opacity:1,outerRadius:n+i,innerRadius:n})},highlight:function(e){var t='<filter>  <feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/>  <feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${width}"/>  <feComposite result="composed" in="colored" in2="morphed" operator="in"/>  <feGaussianBlur result="blured" in="composed" stdDeviation="${blur}"/>   <feBlend in="SourceGraphic" in2="blured" mode="normal"/></filter>';return a(t,{color:e.color||"red",width:s(e.width)?e.width:1,blur:s(e.blur)?e.blur:0,opacity:s(e.opacity)?e.opacity:1})},blur:function(e){var t='<filter>  <feGaussianBlur stdDeviation="${stdDeviation}"/></filter>',n=s(e.x)?e.x:2;return a(t,{stdDeviation:s(e.y)?[n,e.y]:n})},dropShadow:function(e){var t="SVGFEDropShadowElement"in window?'<filter><feDropShadow stdDeviation="${blur}" dx="${dx}" dy="${dy}" flood-color="${color}" flood-opacity="${opacity}"/></filter>':'<filter><feGaussianBlur in="SourceAlpha" stdDeviation="${blur}"/><feOffset dx="${dx}" dy="${dy}" result="offsetblur"/><feFlood flood-color="${color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="${opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';return a(t,{dx:e.dx||0,dy:e.dy||0,opacity:s(e.opacity)?e.opacity:1,color:e.color||"black",blur:s(e.blur)?e.blur:4})},grayScale:function(e){var t='<filter>  <feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${b} ${h} 0 0 0 0 0 1 0"/></filter>',n=s(e.amount)?e.amount:1;return a(t,{a:.2126+.7874*(1-n),b:.7152-.7152*(1-n),c:.0722-.0722*(1-n),d:.2126-.2126*(1-n),e:.7152+.2848*(1-n),f:.0722-.0722*(1-n),g:.2126-.2126*(1-n),h:.0722+.9278*(1-n)})},sepia:function(e){var t='<filter>  <feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${h} ${i} 0 0 0 0 0 1 0"/></filter>',n=s(e.amount)?e.amount:1;return a(t,{a:.393+.607*(1-n),b:.769-.769*(1-n),c:.189-.189*(1-n),d:.349-.349*(1-n),e:.686+.314*(1-n),f:.168-.168*(1-n),g:.272-.272*(1-n),h:.534-.534*(1-n),i:.131+.869*(1-n)})},saturate:function(e){var t='<filter>  <feColorMatrix type="saturate" values="${amount}"/></filter>',n=s(e.amount)?e.amount:1;return a(t,{amount:1-n})},hueRotate:function(e){var t='<filter>  <feColorMatrix type="hueRotate" values="${angle}"/></filter>';return a(t,{angle:e.angle||0})},invert:function(e){var t='<filter>  <feComponentTransfer>    <feFuncR type="table" tableValues="${amount} ${amount2}"/>    <feFuncG type="table" tableValues="${amount} ${amount2}"/>    <feFuncB type="table" tableValues="${amount} ${amount2}"/>  </feComponentTransfer></filter>',n=s(e.amount)?e.amount:1;return a(t,{amount:n,amount2:1-n})},brightness:function(e){var t='<filter>  <feComponentTransfer>    <feFuncR type="linear" slope="${amount}"/>    <feFuncG type="linear" slope="${amount}"/>    <feFuncB type="linear" slope="${amount}"/>  </feComponentTransfer></filter>';return a(t,{amount:s(e.amount)?e.amount:1})},contrast:function(e){var t='<filter>  <feComponentTransfer>    <feFuncR type="linear" slope="${amount}" intercept="${amount2}"/>    <feFuncG type="linear" slope="${amount}" intercept="${amount2}"/>    <feFuncB type="linear" slope="${amount}" intercept="${amount2}"/>  </feComponentTransfer></filter>',n=s(e.amount)?e.amount:1;return a(t,{amount:n,amount2:.5-n/2})}}},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(5),s=i(a),u=function(){function e(t,n){r(this,e),this.cell=n,this.paper=t,this.invalid=!0,this.ensureElement()}return o(e,[{key:"ensureElement",value:function(){return this}},{key:"render",value:function(){return this}},{key:"update",value:function(){return this}},{key:"compileMarkup",value:function(e,t){return s.isFunction(e)?e(t):s.format(e,t)}},{key:"getCell",value:function(){return this.cell}},{key:"getPaper",value:function(){return this.paper}},{key:"getModel",value:function(){return this.paper&&this.paper.getModel()}},{key:"getPane",value:function(){var e=void 0,t=this.cell.metadata.pane;return t&&(s.isString(t)?e=this.paper[t]:s.isNode(t)&&(e=t)),e||this.paper.drawPane}},{key:"destroy",value:function(){s.removeElement(this.elem),s.destroy(this)}}]),e}();t["default"]=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){
if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),u=i(s),l=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(u["default"]);l.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><image/></g><text/></g>',attrs:{".":{fill:"#ffffff",stroke:"none"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),u=i(s),l=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(u["default"]);l.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><circle/></g><text/></g>',size:{width:60,height:60},attrs:{".":{fill:"#ffffff",stroke:"none"},circle:{fill:"#ffffff",stroke:"#000000",r:30,cx:30,cy:30},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(22),u=i(s),l=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(u["default"]);l.setDefaults({attrs:{path:{d:"M 30 0 L 60 30 30 60 0 30 z"},text:{"ref-y":.5,"y-alignment":"middle"}}}),t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),u=i(s),l=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(u["default"]);l.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><ellipse/></g><text/></g>',size:{width:60,height:40},attrs:{".":{fill:"#ffffff",stroke:"none"},ellipse:{fill:"#ffffff",stroke:"#000000",rx:30,ry:20,cx:30,cy:20},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),u=i(s),l=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(u["default"]);l.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><polygon/></g><text/></g>',size:{width:60,height:40},attrs:{".":{fill:"#ffffff",stroke:"none"},polygon:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),u=i(s),l=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(u["default"]);l.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><polyline/></g><text/></g>',size:{width:60,height:40},attrs:{".":{fill:"#ffffff",stroke:"none"},polyline:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),u=i(s),l=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(u["default"]);l.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><rect/></g><a><text/></a></g>',attrs:{".":{fill:"#fff",stroke:"none"},rect:{fill:"#fff",stroke:"#000","stroke-width":"1",width:80,height:30},text:{fill:"#000","font-size":12,"ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),u=i(s),l=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(u["default"]);l.setDefaults({markup:'<a><g class="pane-rotatable"><g class="pane-scalable"><rect/></g><text/></g></a>',attrs:{".":{fill:"#fff",stroke:"none"},rect:{fill:"#fff",stroke:"#000","stroke-width":"1",width:80,height:30},text:{fill:"#000","font-size":12,"ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.changes=void 0;var r=n(42),o=i(r),a=n(43),s=i(a),u=n(44),l=i(u),c=n(45),h=i(c),f=n(46),d=i(f),p=n(47),v=i(p),y=n(48),g=i(y),m={Change:o["default"],RootChange:s["default"],ChildChange:l["default"],VisibleChange:h["default"],TerminalChange:d["default"],GeometryChange:v["default"],ChangeCollection:g["default"]};t.changes=m},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){n(this,e)}return i(e,[{key:"digest",value:function(){return this}}]),e}();t["default"]=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(42),l=i(u),c=function(e){function t(e,n){r(this,t);var i=o(this,Object.getPrototypeOf(t).call(this));return i.model=e,i.root=n,i.previous=n,i}return a(t,e),s(t,[{key:"digest",value:function(){return this.root=this.previous,this.previous=this.model.rootChanged(this.previous),this}}]),t}(l["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(42),l=i(u),c=function(e){function t(e,n,i,a){r(this,t);var s=o(this,Object.getPrototypeOf(t).call(this));return s.model=e,s.child=n,s.parent=i,s.index=a,s.previous=i,s.previousIndex=a,s}return a(t,e),s(t,[{key:"digest",value:function(){var e=this.model,t=this.child,n=this.previous,i=this.previousIndex,r=t.parent,o=r?r.indexOfChild(t):0;return n||this.disConnect(t,!1),r=e.childChanged(t,n,i),this.parent=n,this.index=i,this.previous=r,this.previousIndex=o,this}},{key:"disConnect",value:function(e){if(e.isLink()){var t=e.getTerminal(!0),n=e.getTerminal(!1);t&&this.model.terminalChanged(e,null,!0),n&&this.model.terminalChanged(e,null,!1)}return e.eachChild(function(e){this.disConnect(e)},this),this}}]),t}(l["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(42),l=i(u),c=function(e){function t(e,n,i){r(this,t);var a=o(this,Object.getPrototypeOf(t).call(this));return a.model=e,a.cell=n,a.visible=i,a.previous=i,a}return a(t,e),s(t,[{key:"digest",value:function(){return this.visible=this.previous,this.previous=this.model.visibleChanged(this.cell,this.previous),this}}]),t}(l["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(42),l=i(u),c=function(e){function t(e,n,i,a){r(this,t);var s=o(this,Object.getPrototypeOf(t).call(this));return s.model=e,s.link=n,s.terminal=i,s.previous=i,s.isSource=a,s}return a(t,e),s(t,[{key:"digest",value:function(){return this.terminal=this.previous,this.previous=this.model.terminalChanged(this.link,this.terminal,this.isSource),this}}]),t}(l["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(42),l=i(u),c=function(e){function t(e,n,i){r(this,t);var a=o(this,Object.getPrototypeOf(t).call(this));return a.model=e,a.cell=n,a.geometry=i,a.previous=i,a}return a(t,e),s(t,[{key:"digest",value:function(){return this.geometry=this.previous,this.previous=this.model.geometryChanged(this.cell,this.previous),this}}]),t}(l["default"]);t["default"]=c},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t){n(this,e),this.model=t,this.changes=[]}return i(e,[{key:"hasChange",value:function(){return!!this.changes.length}},{key:"getChanges",value:function(){return this.changes}},{key:"add",value:function(e){return e&&this.changes.push(e),this}},{key:"clear",value:function(){return this.changes=[],this}},{key:"notify",value:function(){return this.model.trigger("change",this.changes),this}}]),e}();t["default"]=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.geometry=void 0;var r=n(18),o=i(r),a=n(19),s=i(a),u=n(4),l=i(u),c=n(28),h=i(c),f=n(50),d=i(f),p={Point:o["default"],Line:s["default"],Rect:l["default"],Ellipse:h["default"],bezier:d["default"]};t.geometry=p},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){var t=a(e),n=["M",e[0].x,e[0].y];l.forEach(t[0],function(){});for(var i=0;i<t[0].length;i++)n.push("C",t[0][i].x,t[0][i].y,t[1][i].x,t[1][i].y,e[i+1].x,e[i+1].y);return n}function a(e){var t=[],n=[],i=e.length-1;if(1===i)return t[0]=new h["default"]((2*e[0].x+e[1].x)/3,(2*e[0].y+e[1].y)/3),n[0]=new h["default"](2*t[0].x-e[0].x,2*t[0].y-e[0].y),[t,n];for(var r=[],o=1;i-1>o;o++)r[o]=4*e[o].x+2*e[o+1].x;r[0]=e[0].x+2*e[1].x,r[i-1]=(8*e[i-1].x+e[i].x)/2;for(var a=s(r),u=1;i-1>u;++u)r[u]=4*e[u].y+2*e[u+1].y;r[0]=e[0].y+2*e[1].y,r[i-1]=(8*e[i-1].y+e[i].y)/2;for(var l=s(r),c=0;i>c;c++)t.push(new h["default"](a[c],l[c])),i-1>c?n.push(new h["default"](2*e[c+1].x-a[c+1],2*e[c+1].y-l[c+1])):n.push(new h["default"]((e[i].x+a[i-1])/2,(e[i].y+l[i-1])/2));return[t,n]}function s(e){var t=e.length,n=[],i=[],r=2;n[0]=e[0]/r;for(var o=1;t>o;o++)i[o]=1/r,r=(t-1>o?4:3.5)-i[o],n[o]=(e[o]-n[o-1])/r;for(var a=1;t>a;a++)n[t-a-1]-=i[t-a]*n[t-a];return n}Object.defineProperty(t,"__esModule",{value:!0}),t.curveThroughPoints=t.getCurveControlPoints=void 0;var u=n(5),l=r(u),c=n(18),h=i(c);t.getCurveControlPoints=a,t.curveThroughPoints=o},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n){for(var i=!0,r=0,o=e.length;o>r;r+=2)i=u.invoke(e[r],t,e[r+1]||n)!==!1&&i;return i}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(5),u=i(s),l=function(){function e(){r(this,e)}return a(e,[{key:"on",value:function(e,t,n){if(!t)return this;var i=this.__events||(this.__events={});return u.forEach(u.split(e),function(e){var r=i[e]||(i[e]=[]);r.push(t,n)}),this}},{key:"once",value:function(e,t,n){var i=this,r=function o(){i.off(e,o),t.apply(n||i,arguments)};return this.on(e,r,n)}},{key:"off",value:function(e,t,n){var i=this.__events;return i?e||t||n?(e=e?u.split(e):u.keys(i),u.forEach(e,function(e){var r=i[e];if(r){if(!t&&!n)return void delete i[e];for(var o=r.length-2;o>=0;o-=2)t&&r[o]!==t||n&&r[o+1]!==n||r.splice(o,2)}}),this):(delete this.__events,this):this}},{key:"trigger",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];var r=this.__events;if(!r||!e)return null;var a=!0,s=r["*"];return u.forEach(u.split(e),function(e){var t=void 0;"*"!==e&&(t=r[e],t&&(a=o(t,n,this)&&a)),s&&(a=o(s,[e].concat(n),this)&&a)},this),a}}]),e}();t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(51),f=i(h),d=n(20),p=i(d),v=n(21),y=i(v),g=n(43),m=i(g),b=n(53),k=i(b),w=n(44),P=i(w),x=n(45),O=i(x),C=n(54),M=i(C),_=n(55),T=i(_),E=n(46),j=i(E),S=n(47),B=i(S),N=n(56),V=i(N),R=n(48),L=i(R),A=function(e){function t(e){o(this,t);var n=a(this,Object.getPrototypeOf(t).call(this));return n.nextId=0,n.updateLevel=0,n.endingUpdate=!1,n.changes=new L["default"](n),e?n.setRoot(e):n.clear(),n}return s(t,e),u(t,[{key:"clear",value:function(){return this.setRoot(this.createRoot())}},{key:"getDefaultParent",value:function(){return this.getRoot().getChildAt(0)}},{key:"isOrphan",value:function(e){return e&&e.isOrphan()}},{key:"isAncestor",value:function(e,t){return e&&e.isAncestor(t)}},{key:"contains",value:function(e,t){return t||(t=e,e=this.root),this.isAncestor(e,t)}},{key:"getAncestors",value:function(e){return e?e.getAncestors():[]}},{key:"getDescendants",value:function(e){return e?e.getDescendants():[]}},{key:"getParents",value:function(){}},{key:"getCellById",value:function(e){return this.cells?this.cells[e]:null}},{key:"findCellAtPoint",value:function(e){var t=this,n=[];return e&&this.eachCell(function(i){if(t.isNode(i)){var r=i.getBBox();r&&r.containsPoint(e)&&n.push(i)}},this),n}},{key:"findCellInArea",value:function(e){var t=this,n=[];return e&&this.eachCell(function(i){if(t.isNode(i)){var r=i.getBBox();r&&e.containsRect(r)&&n.push(i)}},this),n}},{key:"createCellId",value:function(){var e=this.nextId;return this.nextId+=1,"cell-"+e}},{key:"isRoot",value:function(e){return e&&this.root===e}},{key:"createRoot",value:function(){var e=new p["default"];return e.insertChild(this.createLayer(),{silent:!0}),e}},{key:"getRoot",value:function(e){for(var t=this.root;e;)t=e,e=e.parent;return t}},{key:"setRoot",value:function(e){return this.digest(new m["default"](this,e))}},{key:"rootChanged",value:function(e){var t=this.root;return this.root=e,this.cells=null,this.nextId=0,this.cellAdded(e),t}},{key:"isLayer",value:function(e){return e&&this.isRoot(e.parent)}},{key:"getLayers",value:function(){return this.getRoot().children||[]}},{key:"createLayer",value:function(){return new p["default"]}},{key:"eachLayer",value:function(e,t){return c.forEach(this.getLayers(),e,t)}},{key:"addNode",value:function(e,t,n){return this.addCells([e],t,n)}},{key:"addLink",value:function(e,t,n,i,r){return this.addCells([e],i,r,t,n)}},{key:"addCell",value:function(e,t,n,i,r){return this.addCells([e],t,n,i,r)}},{key:"addCells",value:function(e,t,n,i,r){var o=this;t=t||this.getDefaultParent(),n=c.fixIndex(n,t.getChildCount()),this.beginUpdate();try{c.forEach(e,function(e){e&&(e!==t&&(o.setParent(e,t,n),n++),i&&o.setTerminal(e,i,!0),r&&o.setTerminal(e,r,!1))},this)}finally{this.endUpdate()}return this}},{key:"removeCell",value:function(e){return e&&(this.isRoot(e)?this.setRoot(null):this.getParent(e)&&this.digest(new P["default"](this,e,null))),e}},{key:"getParent",value:function(e){return e?e.parent:null}},{key:"setParent",value:function(e,t,n){if(e)if(t)try{this.beginUpdate(),this.digest(new P["default"](this,e,t,n))}finally{this.endUpdate()}else this.removeCell(e);return this}},{key:"childChanged",value:function(e,t,n){var i=this.getParent(e);return t?t===i&&i.indexOfChild(e)===n||t.insertChild(e,n,{silent:!0}):i&&i.removeChild(e,{silent:!0}),t?this.contains(i)||this.cellAdded(e):this.cellRemoved(e),i}},{key:"cellAdded",value:function(e){if(e){var t=e.getId()||this.createCellId(e);if(t){var n=this.getCellById(t);if(n!==e){for(;n;)t=this.createCellId(e),n=this.getCellById(t);this.cells||(this.cells={}),e.setId(t),this.cells[t]=e}}c.isNumeric(t)&&(this.nextId=Math.max(this.nextId,t)),e.setModel(this),e.eachChild(this.cellAdded,this)}}},{key:"cellRemoved",value:function(e){var t=this;if(e){e.eachChild(function(e){t.cellRemoved(e)},this);var n=e.getId();this.cells&&n&&delete this.cells[n],e.setModel(null)}}},{key:"updateLinkParents",value:function(e,t){var n=this;t=t||this.getRoot(e),e.eachChild(function(e){n.updateLinkParents(e,t)},this),e.eachLink(function(e){n.isAncestor(t,e)&&n.updateLinkParent(e,t)},this)}},{key:"updateLinkParent",value:function(e,t){for(var n=this,i=null,r=e.getTerminal(!0),o=e.getTerminal(!1);r&&!r.isLink()&&r.geometry&&r.geometry.relative;)r=r.parent;for(;o&&!o.isLink()&&o.geometry&&o.geometry.relative;)o=o.parent;if(n.isAncestor(t,r)&&n.isAncestor(t,o)&&(i=r===o?r.parent:n.getNearestCommonAncestor(r,o),i&&(i.parent!==n.viewport||n.isAncestor(i,e))&&e.parent!==i)){var a=e.geometry;if(a){var s=n.getOrigin(e.parent),u=n.getOrigin(i),l=u.x-s.x,c=u.y-s.y;a=a.clone(),a.translate(-l,-c),n.setGeometry(e,a)}n.add(i,e)}}},{key:"getNearestCommonAncestor",value:function(){return null}},{key:"eachCell",value:function(e,t){this.cells&&e&&c.isFunction(e)&&c.forIn(this.cells,function(n,i){e.call(t,n,i)})}},{key:"filterCell",value:function(e,t){var n=[];return this.cells&&e&&c.isFunction(e)&&c.forIn(this.cells,function(i,r){e.call(t,i,r)&&n.push(i)}),n}},{key:"eachNode",value:function(e,t){var n=this,i=this.filterCell(function(e){return n.isNode(e)},this);return c.forEach(i,e,t)}},{key:"eachLink",value:function(e,t){var n=this,i=this.filterCell(function(e){return n.isLink(e)},this);return c.forEach(i,e,t)}},{key:"getChildNodes",value:function(e){return this.getChildCells(e,!0,!1)}},{key:"getChildLinks",value:function(e){return this.getChildCells(e,!1,!0)}},{key:"eachChildNode",value:function(e,t,n){c.forEach(this.getChildNodes(e),t,n)}},{key:"eachChildLink",value:function(e,t,n){c.forEach(this.getChildLinks(e),t,n)}},{key:"getChildCells",value:function(e,t,n){return e?e.filterChild(function(e){return t&&e.isNode()||n&&e.isLink()}):[]}},{key:"indexOfChild",value:function(e,t){return e?e.indexOfChild(t):-1}},{key:"getChildAt",value:function(e,t){return e?e.getChildAt(t):null}},{key:"getChildren",value:function(e){return e?e.children:null}},{key:"getChildCount",value:function(e){return e?e.getChildCount():0}},{key:"isNode",value:function(e){return e?e.isNode():!1}},{key:"getLinkCount",value:function(e){return e?e.getLinkCount():0}},{key:"indexOfLink",value:function(e,t){return e?e.indexOfLink(t):-1}},{key:"getLinkAt",value:function(e,t){return e?e.getLinkAt(t):null}},{key:"isLink",value:function(e){return e?e.isLink():!1}},{key:"getTerminal",value:function(e,t){return e?e.getTerminal(t):null}},{key:"getTerminalNode",value:function(e,t){return e?e.getTerminalNode(t):null}},{key:"getTerminalPort",value:function(e,t){return e?e.getTerminalPort(t):null}},{key:"getTerminalPoint",value:function(e,t){return e?e.getTerminalPoint(t):null}},{key:"setTerminal",value:function(e,t,n){if(e)try{this.beginUpdate(),this.digest(new j["default"](this,e,new y["default"](t),n))}finally{this.endUpdate()}return this}},{key:"setTerminalNode",value:function(e,t,n){return e&&this.setTerminal(e,t,n),this}},{key:"setTerminalPort",value:function(e,t,n){if(e){var i=this.getTerminal(e,n);i=i?i.duplicate({port:t}):new y["default"]({port:t}),this.setTerminal(e,i,n)}return this}},{key:"setTerminalPoint",value:function(e,t,n){return e&&this.setTerminal(e,t,n),this}},{key:"setTerminals",value:function(e,t,n){this.beginUpdate();try{this.setTerminal(e,t,!0),this.setTerminal(e,n,!1)}finally{this.endUpdate()}return this}},{key:"removeFromTerminal",value:function(e,t){return e&&this.setTerminal(e,null,t),this}},{key:"terminalChanged",value:function(e,t,n){var i=this.getTerminal(e,n);return t?t.addLink(e,n,{silent:!0}):i&&i.removeLink(e,n,{silent:!0}),i}},{key:"isVisible",value:function(e){return e?e.isVisible():!1}},{key:"setVisible",value:function(e,t){if(e&&t!==this.isVisible(e))try{this.beginUpdate(),this.digest(new O["default"](this,e,t))}finally{this.endUpdate()}return this}},{key:"visibleChanged",value:function(e,t){var n=this.isVisible(e);return e.setVisible(t,{silent:!0}),n}},{key:"getAttribute",value:function(e){return e?e.getAttribute():null}},{key:"setAttribute",value:function(e,t){if(e)try{this.beginUpdate(),this.digest(new V["default"](this,e,t))}finally{this.endUpdate()}return this}},{key:"attributeChanged",value:function(e,t){var n=this.getAttribute(e);return e.setAttribute(t,{silent:!0}),n}},{key:"getPosition",value:function(e,t){return e?e.getPosition(t):null}},{key:"setPosition",value:function(e,t){if(e&&t){var n=e.getPosition(!0)||{};if(t.relative=t.relative===!0,n.relative=n.relative===!0,n.x!==t.x||n.y!==t.y||n.relative!==t.relative)try{this.beginUpdate(),this.digest(new M["default"](this,e,{x:t.x,y:t.y,relative:t.relative}))}finally{this.endUpdate()}}return this}},{key:"positionChanged",value:function(e,t){var n=e.getPosition(!0);return e.setPosition(t,{silent:!0}),n}},{key:"getSize",value:function(e,t){return e?e.getSize(t):null}},{key:"setSize",value:function(e,t){if(e&&t){var n=e.getSize(!0)||{};if(t.relative=t.relative===!0,n.relative=n.relative===!0,n.width!==t.width||n.height!==t.height||n.relative!==t.relative)try{this.beginUpdate(),this.digest(new k["default"](this,e,{width:t.width,height:t.height,relative:t.relative}))}finally{this.endUpdate()}}return this}},{key:"sizeChanged",value:function(e,t){var n=e.getSize(!0);return e.setSize(t,{silent:!0}),n}},{key:"getRotation",value:function(e,t){return e?e.getRotation(t):null}},{key:"setRotation",value:function(e,t){if(e&&t){var n=e.getRotation(!0)||{};if(t.relative=t.relative===!0,n.relative=n.relative===!0,n.angle!==t.angle||n.relative!==t.relative)try{
this.beginUpdate(),this.digest(new T["default"](this,e,{angle:t.angle,relative:t.relative}))}finally{this.endUpdate()}}return this}},{key:"rotationChanged",value:function(e,t){var n=e.getRotation(!0);return e.setRotation(t,{silent:!0}),n}},{key:"getGeometry",value:function(e,t){return e?e.getGeometry(t):null}},{key:"setGeometry",value:function(e,t){if(e&&t)try{this.beginUpdate(),this.digest(new B["default"](this,e,t))}finally{this.endUpdate()}return this}},{key:"geometryChanged",value:function(e,t){var n=this,i=e.getGeometry(!0)||{};return c.forEach(["size","position","rotation"],function(i){t[i]&&n[i+"Changed"](e,t[i])},this),i}},{key:"digest",value:function(e){return e.digest(),this.beginUpdate(),this.changes.add(e),this.endUpdate(),this}},{key:"beginUpdate",value:function(){this.updateLevel+=1,this.trigger("beginUpdate"),1===this.updateLevel&&this.trigger("startEdit")}},{key:"endUpdate",value:function(){if(this.updateLevel-=1,0===this.updateLevel&&this.trigger("endEdit"),!this.endingUpdate){this.endingUpdate=0===this.updateLevel;var e=this.changes;this.trigger("endUpdate",e.getChanges()),this.endingUpdate&&e.hasChange()&&e.notify().clear(),this.endingUpdate=!1}}},{key:"destroy",value:function(){c.destroy(this)}}]),t}(f["default"]);t["default"]=A},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(42),l=i(u),c=function(e){function t(e,n,i){r(this,t);var a=o(this,Object.getPrototypeOf(t).call(this));return a.model=e,a.cell=n,a.size=i,a.previous=i,a}return a(t,e),s(t,[{key:"digest",value:function(){return this.size=this.previous,this.previous=this.model.sizeChanged(this.cell,this.previous),this}}]),t}(l["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(42),l=i(u),c=function(e){function t(e,n,i){r(this,t);var a=o(this,Object.getPrototypeOf(t).call(this));return a.model=e,a.cell=n,a.position=i,a.previous=i,a}return a(t,e),s(t,[{key:"digest",value:function(){return this.position=this.previous,this.previous=this.model.positionChanged(this.cell,this.previous),this}}]),t}(l["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(42),l=i(u),c=function(e){function t(e,n,i){r(this,t);var a=o(this,Object.getPrototypeOf(t).call(this));return a.model=e,a.cell=n,a.rotation=i,a.previous=i,a}return a(t,e),s(t,[{key:"digest",value:function(){return this.position=this.previous,this.previous=this.model.rotationChanged(this.cell,this.previous),this}}]),t}(l["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(42),l=i(u),c=function(e){function t(e,n,i){r(this,t);var a=o(this,Object.getPrototypeOf(t).call(this));return a.model=e,a.cell=n,a.attrs=i,a.previous=i,a}return a(t,e),s(t,[{key:"digest",value:function(){return this.attrs=this.previous,this.previous=this.model.attributeChanged(this.cell,this.previous),this}}]),t}(l["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(27),f=i(h),d=n(15),p=i(d),v=n(51),y=i(v),g=n(4),m=i(g),b=n(18),k=i(b),w=n(52),P=i(w),x=n(20),O=i(x),C=n(58),M=i(C),_=n(29),T=i(_),E=n(43),j=i(E),S=n(44),B=i(S),N=n(53),V=i(N),R=n(45),L=i(R),A=n(54),F=i(A),z=n(55),I=i(z),D=n(46),U=i(D),G=n(47),W=i(G),H=n(56),$=i(H),q=window,X=q.document,Y={wrapper:"pane-wrapper",stage:"pane-stage",svg:"pane-svg",viewport:"pane-viewport"},Z={width:"100%",height:"100%",tx:0,ty:0,sx:1,sy:1,gridSize:1,container:null,model:null,clickThreshold:0,isValidEvent:null,eventDelegate:null},K=0,J=function(e){function t(e){o(this,t);var n=a(this,Object.getPrototypeOf(t).call(this));return n.id="paper-"+K++,e&&n.init(e),n}return s(t,e),u(t,[{key:"configure",value:function(e){return this.options=c.merge({},Z,e),this.trigger("paper:configure",this.options),this}},{key:"init",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(this.configure(e),this.container=e.container,!this.container)throw new Error("Initialize error: invalid container");return e=this.options,this.ensureElement().createPanes().setup().resize(e.width,e.height).translate(e.tx,e.ty).scale(e.sx,e.sy).setModel(e.model),this.trigger("paper:init",this.options),this}},{key:"ensureElement",value:function(){return this.wrapper=c.createElement("div"),this.stage=c.createElement("div"),this.svg=c.createSvgDocument(),this.viewport=c.createSvgElement("g"),c.addClass(this.wrapper,Y.wrapper),c.addClass(this.stage,Y.stage),c.addClass(this.svg,Y.svg),c.addClass(this.viewport,Y.viewport),this.svg.appendChild(this.viewport),this.stage.appendChild(this.svg),this.wrapper.appendChild(this.stage),this.container.appendChild(this.wrapper),this.trigger("paper:ensureElements"),this}},{key:"getContainer",value:function(){return this.container}},{key:"getWrapper",value:function(){return this.wrapper}},{key:"getStage",value:function(){return this.stage}},{key:"getSvg",value:function(){return this.svg}},{key:"getViewport",value:function(){return this.viewport}},{key:"createPanes",value:function(){var e=this.viewport;return this.backgroundPane=e.appendChild(c.createSvgElement("g")),this.linkPane=e.appendChild(c.createSvgElement("g")),this.drawPane=e.appendChild(c.createSvgElement("g")),this.controlPane=e.appendChild(c.createSvgElement("g")),this.decoratePane=e.appendChild(c.createSvgElement("g")),this.trigger("paper:createPanes"),this}},{key:"setup",value:function(){var e=this.options.eventDelegate;return c.isFunction(e)&&(e=e.call(this)),e=e||this.wrapper,c.addEventListener(e,"contextmenu",this.onContextMenu.bind(this)),c.addEventListener(e,"dblclick",this.onDblClick.bind(this)),c.addEventListener(e,"click",this.onClick.bind(this)),c.addEventListener(e,"mouseover",".pane-node",this.onCellMouseOver.bind(this)),c.addEventListener(e,"mouseout",".pane-node",this.onCellMouseOut.bind(this)),c.addEventListener(e,"mouseover",".pane-link",this.onCellMouseOver.bind(this)),c.addEventListener(e,"mouseout",".pane-link",this.onCellMouseOut.bind(this)),c.addEventListener(e,p["default"].IS_TOUCH?"touchstart":"mousedown",this.onPointerDown.bind(this)),this.eventDelegate=e,this.mouseMoved=0,p["default"].IS_POINTER&&(this.container.style.msTouchAction="none"),this.trigger("paper:setup"),this}},{key:"getModel",value:function(){return this.model}},{key:"setModel",value:function(){var e=arguments.length<=0||void 0===arguments[0]?new P["default"]:arguments[0];return this.model=e,this.model.on("change",this.handleChanges,this),this.reValidate(),this}},{key:"destroy",value:function(){this.trigger("paper:destroy"),c.removeElement(this.wrapper),p["default"].IS_POINTER&&(this.container.style.msTouchAction="");var e=this.getModel();e&&!e.destroyed&&e.destroy(),c.destroy(this)}},{key:"registerHandlers",value:function(e){return e=c.isArray(e)?e:[e],this.handlers=this.handlers||[],this.handlerByName=this.handlerByName||{},c.forEach(e,function(e){if(this.handlerByName[e.name])throw new Error('handler with name "'+e.name+'" is already registered');this.handlers.push(e),this.handlerByName[e.name]=e},this),this}},{key:"resize",value:function(e,t,n){if(!c.isNil(e)&&!c.isNil(t)){var i=c.isPercentage(e);i&&(e=c.toFloat(e,!0)*this.container.clientWidth),i=c.isPercentage(t),i&&(t=c.toFloat(t,!0)*this.container.clientHeight),n&&(e+=c.isNil(this.width)?0:this.width,t+=c.isNil(this.height)?0:this.height),e=Math.round(e),t=Math.round(t),(0,f["default"])(this.svg).attr({width:e,height:t}),c.setStyle(this.stage,{width:e+"px",height:t+"px"}),this.width=e,this.height=t,this.trigger("paper:resize",e,t)}return this}},{key:"resizeTo",value:function(e,t){return this.resize(e,t,!1)}},{key:"resizeBy",value:function(e,t){return this.resize(e,t,!0)}},{key:"translate",value:function(e,t,n){return c.isNil(e)||c.isNil(t)||(n&&(e+=c.isNil(this.tx)||0,t+=c.isNil(this.ty)||0),(0,f["default"])(this.viewport).translate(e,t),this.tx=e,this.ty=t,this.trigger("paper:translate",e,t)),this}},{key:"translateTo",value:function(e,t){return this.translate(e,t,!1)}},{key:"translateBy",value:function(e,t){return this.translate(e,t,!0)}},{key:"scale",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?0:arguments[2],i=arguments.length<=3||void 0===arguments[3]?0:arguments[3];if(t=t||e,e&&t){var r=(0,f["default"])(this.viewport);r.attr("transform","");var o=this.tx,a=this.ty;if(n||i||o||a){var s=o-n*(e-1),u=a-i*(t-1);this.translateTo(s,u)}r.scale(e,t),this.sx=e,this.sy=t,this.trigger("paper:scale",e,t,n,i)}return this}},{key:"getContentBBox",value:function(e){if(e)return(0,f["default"])(this.viewport).getBBox(!0,this.svg);var t=this.viewport.getBoundingClientRect(),n=this.viewport.getScreenCTM(),i=this.viewport.getCTM();return m["default"].fromRect({x:t.left-n.e+i.e,y:t.top-n.f+i.f,width:t.width,height:t.height})}},{key:"fitToContent",value:function(e,t,n,i){function r(e){return!i.allowNewOrigin||"any"===i.allowNewOrigin||"negative"===i.allowNewOrigin&&0>e||"positive"===i.allowNewOrigin&&e>=0}c.isObject(e)?(i=e,n=i.padding||0,e=i.frameWidth||1,t=i.frameHeight||1):(i=i||{},n=n||0,e=e||1,t=t||1),n=c.normalizeSides(n);var o=this.getContentBBox(!0);o.x*=this.sx,o.y*=this.sy,o.width*=this.sx,o.height*=this.sy;var a=c.snapToGrid(o.width+o.x||1,e,"ceil"),s=c.snapToGrid(o.height+o.y||1,t,"ceil"),u=this.tx,l=this.ty;r(o.x)&&(u=Math.ceil(-o.x/e)*e,u+=n.left,a+=u),r(o.y)&&(l=Math.ceil(-o.y/t)*t,l+=n.top,s+=l),a+=n.right,s+=n.bottom,a=c.clamp(a,i.minWidth||0,i.maxWidth||Number.MAX_VALUE),s=c.clamp(s,i.minHeight||0,i.maxHeight||Number.MAX_VALUE);var h=a!==this.width||s!==this.height,f=u!==this.tx||l!==this.ty;return f&&this.translate(u,l),h&&this.resize(a,s),h||f}},{key:"scaleContentToFit",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this.getContentBBox(!0);if(!t.width||!t.height)return this;e=c.merge({padding:0,minScale:null,maxScale:null,scaleGrid:null,preserveAspectRatio:!0},e);var n=c.normalizeSides(e.padding),i=e.fittingBBox;i||(i={x:this.tx,y:this.ty,width:this.width,height:this.height}),i=m["default"].fromRect(i).moveAndExpand({x:n.left,y:n.top,width:-(n.left+n.right),height:-(n.top+n.bottom)});var r=i.width/t.width,o=i.height/t.height,a=e.scaleGrid;a&&(r=c.snapToGrid(r,a,"floor"),o=c.snapToGrid(o,a,"floor"));var s=e.minScaleX||e.minScale,u=e.maxScaleX||e.maxScale,l=e.minScaleY||e.minScale,h=e.maxScaleY||e.maxScale;r=c.clamp(r,s,u),o=c.clamp(o,l,h),e.preserveAspectRatio&&(r=o=Math.min(r,o)),this.scale(r,o),t=this.getContentBBox(!0);var f=i.x-t.x,d=i.y-t.y;return this.translateTo(f,d),this}},{key:"reValidate",value:function(){return this.invalidate().validate()}},{key:"clear",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.model.getRoot():arguments[0],t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],n=arguments.length<=2||void 0===arguments[2]?!0:arguments[2];return this.removeView(e),n&&(t||e!==this.currentRoot)?e.eachChild(function(e){this.clear(e,t,n)},this):this.invalidate(e,!0,!0),this}},{key:"invalidate",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.model.getRoot():arguments[0],t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?!0:arguments[2],i=this.getView(e);return i&&(i.invalid=!0),e.invalidating||(e.invalidating=!0,t&&e.eachChild(function(e){this.invalidate(e,t,n)},this),n&&e.eachLink(function(e){this.invalidate(e,t,n)},this),e.invalidating=!1),this}},{key:"validate",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.model.getRoot():arguments[0];return this.validateCell(e).validateView(e)}},{key:"validateCell",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];if(e){t=t&&e.isVisible();var n=this.getView(e,t);n&&!t&&this.removeView(e,!1,!1),e.eachChild(function(e){this.validateCell(e,t)},this)}return this}},{key:"validateView",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];if(e){var n=this.getView(e);n&&n.invalid&&(this.validateView(e.getParent(),!1).updateNodeGeometry(e).renderView(e),n.invalid=!1),t&&e.eachChild(function(e){this.validateView(e,t)},this)}return this}},{key:"updateNodeGeometry",value:function(e){return e&&e.isNode()&&this.updateNodeSize(e).updateNodePosition(e).updateNodeRotation(e),this}},{key:"updateNodeSize",value:function(e){if(e&&e.isNode()){var t=e.metadata.size||{},n=c.isUndefined(t.width)?1:t.width,i=c.isUndefined(t.height)?1:t.height,r=e.parent;if(t.relative&&r&&r.isNode()){var o=r.size,a=c.isPercentage(n);n=c.fixNumber(n,a,0),a||n>0&&1>n?n*=o.width:n+=o.width,a=c.isPercentage(i),i=c.fixNumber(i,a,0),a||i>0&&1>i?i*=o.height:i+=o.height}else n=c.fixNumber(n,!1,1),i=c.fixNumber(i,!1,1);e.size={width:Math.max(n,1),height:Math.max(i,1)}}return this}},{key:"updateNodePosition",value:function(e){if(e&&e.isNode()){var t=e.metadata.position||{},n=c.isUndefined(t.x)?0:t.x,i=c.isUndefined(t.y)?0:t.y,r=e.parent;if(t.relative&&r&&r.isNode()){var o=r.position,a=r.size,s=c.isPercentage(n);n=c.fixNumber(n,s,0),s||n>-1&&1>n?n=o.x+a.width*n:n+=o.x,s=c.isPercentage(i),i=c.fixNumber(i,s,0),s||i>-1&&1>i?i=o.y+a.height*i:i+=o.y}else n=c.fixNumber(n,!1,0),i=c.fixNumber(i,!1,0);e.position={x:n,y:i}}return this}},{key:"updateNodeRotation",value:function(e){if(e&&e.isNode()){var t=e.metadata.rotation||{},n=c.fixNumber(t.angle,!1,0),i=e.parent;if(t.inherited&&i&&i.isNode()&&0!==i.rotation){var r=e.position,o=e.size,a=new k["default"](r.x+o.width/2,r.y+o.height/2),s=i.position,u=i.size,l=new k["default"](s.x+u.width/2,s.y+u.height/2);a.rotate(l,-i.rotation),r.x=a.x-o.width/2,r.y=a.y-o.height/2,n+=i.rotation}e.rotation=n}return this}},{key:"getView",value:function(e,t){if(e){var n=this.getViewById(e.id);return!n&&t&&e.isVisible()&&(n=this.createView(e)),n}}},{key:"getViewById",value:function(e){return this.views?this.views[e]:null}},{key:"eachView",value:function(e,t){return c.forIn(this.views,e,t)}},{key:"getTerminalView",value:function(e,t){var n=this.model.getTerminal(e,t);return n&&n.node?this.getView(n.node):null}},{key:"createView",value:function(e){if(e){var t=e.metadata.view;if(t||(t=e.isLink()?M["default"]:e.isNode()?T["default"]:null),t){var n=new t(this,e);return this.views||(this.views={}),this.views[e.id]=n,n}}return null}},{key:"removeView",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?!0:arguments[2];if(e){t&&e.eachChild(function(e){this.removeView(e,t,n)},this),n&&e.eachLink(function(e){this.removeView(e,t,n)},this);var i=this.getView(e);i&&(delete this.views[e.id],i.destroy())}return this}},{key:"renderView",value:function(e){var t=this.getView(e);return t&&(e.isLink()&&!this.canRenderLink(e)?this.removeView(e):t.render()),this}},{key:"canRenderLink",value:function(e){var t=e.getTerminalNode(!0),n=e.getTerminalNode(!1);return(!t||t.isVisible()&&this.getView(t))&&(!n||n.isVisible()&&this.getView(n))?(t||e.getTerminalPoint(!0))&&(n||e.getTerminalPoint(!1)):!1}},{key:"findViewByElem",value:function(e){if(this.views)for(e=c.isString(e)?this.svg.querySelector(e):e;e&&e!==this.svg&&e!==document;){var t=e.cellId;if(t)return this.views[t];e=e.parentNode}return null}},{key:"findViewByCell",value:function(e){return c.isString(e)?this.getViewById(e):this.getView(e)}},{key:"findViewByPoint",value:function(){}},{key:"findViewsInArea",value:function(){}},{key:"handleChanges",value:function(e){return c.forEach(e,function(e){this.distributeChange(e)},this),this.validate(),this}},{key:"distributeChange",value:function(e){return e instanceof j["default"]?this.onRootChanged(e):e instanceof B["default"]?this.onChildChanged(e):e instanceof L["default"]?this.onVisibleChange(e):e instanceof U["default"]?this.onTerminalChange(e):e instanceof V["default"]?this.onSizeChange(e):e instanceof F["default"]?this.onPositionChange(e):e instanceof I["default"]?this.onRotationChange(e):e instanceof $["default"]?this.onAttributeChange(e):e instanceof W["default"]&&this.onGeometryChange(e),this}},{key:"onRootChanged",value:function(e){e.viewport&&this.invalidate(e.viewport,!0,!0),e.previous&&this.removeView(e.previous,!0,!0)}},{key:"onChildChanged",value:function(e){var t=e.parent,n=e.previous;this.invalidate(e.child,!0,!0),t||this.removeView(e.child,!0,!0),t!==n&&(t&&this.invalidate(t,!1,!1),n&&this.invalidate(n,!1,!1))}},{key:"onVisibleChange",value:function(e){this.invalidate(e.cell,!0,!0)}},{key:"onTerminalChange",value:function(e){this.invalidate(e.link,!0,!0)}},{key:"onSizeChange",value:function(e){this.invalidate(e.cell,!0,!0)}},{key:"onPositionChange",value:function(e){this.invalidate(e.cell,!0,!0)}},{key:"onRotationChange",value:function(e){this.invalidate(e.cell,!0,!0)}},{key:"onAttributeChange",value:function(e){this.invalidate(e.cell,!0,!0)}},{key:"onGeometryChange",value:function(e){this.invalidate(e.cell,!0,!0)}},{key:"getRouter",value:function(e){return this.constructor.getRouter(e)}},{key:"getConnector",value:function(e){return this.constructor.getConnector(e)}},{key:"getMarker",value:function(e){return this.constructor.getMarker(e)}},{key:"isValidEvent",value:function(e,t){if(this.options.isValidEvent&&!this.options.isValidEvent(e,t))return!1;if(t&&t.cell&&t.cell instanceof O["default"])return!0;var n=this.eventDelegate,i=e.target;return n===i||c.containsElement(n,i)?!0:void 0}},{key:"onContextMenu",value:function(e){e=c.normalizeEvent(e);var t=this.findViewByElem(e.target);if(this.isValidEvent(e,t)){var n=this.snapToGrid({x:e.clientX,y:e.clientY});t?this.trigger("cell:contextmenu",t.cell,t,e,n.x,n.y):this.trigger("blank:contextmenu",e,n.x,n.y)}}},{key:"onDblClick",value:function(e){e.preventDefault(),e=c.normalizeEvent(e);var t=this.findViewByElem(e.target);if(this.isValidEvent(e,t)){var n=this.snapToGrid({x:e.clientX,y:e.clientY});t?this.trigger("cell:dblClick",t.cell,t,e,n.x,n.y):this.trigger("blank:dblClick",e,n.x,n.y)}}},{key:"onClick",value:function(e){if(this.mouseMoved<=this.options.clickThreshold){e=c.normalizeEvent(e);var t=this.findViewByElem(e.target);if(!this.isValidEvent(e,t))return;var n=this.snapToGrid({x:e.clientX,y:e.clientY});t?this.trigger("cell:click",t.cell,t,e,n.x,n.y):this.trigger("blank:click",e,n.x,n.y)}}},{key:"onCellMouseOver",value:function(e){e=c.normalizeEvent(e);var t=this.findViewByElem(e.target);t&&this.isValidEvent(e,t)&&this.trigger("cell:mouseOver",t.cell,t,e)}},{key:"onCellMouseOut",value:function(e){e=c.normalizeEvent(e);var t=this.findViewByElem(e.target);t&&this.isValidEvent(e,t)&&this.trigger("cell:mouseOut",t.cell,t,e)}},{key:"onPointerDown",value:function(e){if(e=c.normalizeEvent(e),c.isLeftMouseButton(e)){var t=this.findViewByElem(e.target);if(this.isValidEvent(e,t)){e.preventDefault(),this.mouseMoved=0;var n=this.snapToGrid({x:e.clientX,y:e.clientY});t?(this.sourceView=t,this.trigger("cell:pointerDown",t.cell,t,e,n.x,n.y)):this.trigger("blank:pointerDown",e,n.x,n.y),this.onMouseMoveHandler=this.onMouseMoveHandler||this.onPointerMove.bind(this),this.onMouseUpHandler=this.onMouseUpHandler||this.onPointerUp.bind(this),c.addEventListener(X,p["default"].IS_TOUCH?"touchmove":"mousemove",this.onMouseMoveHandler),c.addEventListener(X,p["default"].IS_TOUCH?"touchend":"mouseup",this.onMouseUpHandler)}}}},{key:"onPointerMove",value:function(e){e.preventDefault(),e=c.normalizeEvent(e);var t=this.snapToGrid({x:e.clientX,y:e.clientY}),n=this.sourceView;n?(this.mouseMoved++,this.trigger("cell:pointerMove",n.cell,n,e,t.x,t.y)):this.trigger("blank:pointerMove",e,t.x,t.y)}},{key:"onPointerUp",value:function(e){e=c.normalizeEvent(e);var t=this.snapToGrid({x:e.clientX,y:e.clientY}),n=this.sourceView;n?(this.trigger("cell:pointerUp",n.cell,n,e,t.x,t.y),this.sourceView=null):this.trigger("blank:pointerUp",e,t.x,t.y),c.removeEventListener(X,p["default"].IS_TOUCH?"touchmove":"mousemove",this.onMouseMoveHandler),c.removeEventListener(X,p["default"].IS_TOUCH?"touchend":"mouseup",this.onMouseUpHandler)}},{key:"snapToGrid",value:function(e){var t=this.options.gridSize||1,n=(0,f["default"])(this.drawPane).toLocalPoint(e.x,e.y);return{x:c.snapToGrid(n.x,t),y:c.snapToGrid(n.y,t)}}},{key:"toLocalPoint",value:function(e){var t=this.svg,n=t.createSVGPoint();n.x=e.x,n.y=e.y;var i=void 0;p["default"].IS_FF&&(i=(0,f["default"])("rect",{width:this.options.width,height:this.options.height,x:0,y:0,opacity:0}),t.appendChild(i.node));var r=c.getOffset(t);p["default"].IS_FF&&i.removeCell();var o=X.body,a=X.documentElement,s=o.scrollTop||a.scrollTop,u=o.scrollLeft||a.scrollLeft;n.x+=u-r.left,n.y+=s-r.top;var l=n.matrixTransform(this.drawPane.getCTM().inverse());return k["default"].fromPoint(l)}},{key:"toLocalRect",value:function(e){var t=this.toLocalPoint({x:e.x,y:e.y}),n=this.toLocalPoint({x:e.x+e.width,y:e.y+e.height});return new m["default"](t.x,t.y,n.x-t.x,n.y-t.y)}}],[{key:"registerRouter",value:function(e,t){return this.router||(this.router={}),this.router[e]=t,this}},{key:"getRouter",value:function(e){return this.router?this.router[e]:null}},{key:"registerConnector",value:function(e,t){return this.connectors||(this.connectors={}),this.connectors[e]=t,this}},{key:"getConnector",value:function(e){return this.connectors?this.connectors[e]:null}},{key:"registerMarker",value:function(e,t){return this.markers||(this.markers={}),this.markers[e]=t,this}},{key:"getMarker",value:function(e){return this.markers?this.markers[e]:null}}]),t}(y["default"]);t["default"]=J},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(27),f=i(h),d=n(18),p=i(d),v=n(30),y=i(v),g=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"render",value:function(){return this.vel.empty(),this.renderMarkup().update(),this}},{key:"update",value:function(){return this.cache={},this.parseRouter().parseConnector().parseTerminal(!0).parseTerminal(!1).updateMarker().updateConnector().updateAttributes()}},{key:"updateAttributes",value:function(e){return c.forIn(e||this.cell.attrs,function(e,t){var n=[];c.isObject(e.fill)&&(this.applyGradient(t,"fill",e.fill),n.push("fill")),c.isObject(e.stroke)&&(this.applyGradient(t,"stroke",e.stroke),n.push("stroke")),c.isObject(e.filter)&&(this.applyFilter(t,e.filter),n.push("filter"));var i={};c.forIn(e,function(e,t){c.contains(n,t)||(i[t]=e)}),this.applyAttr(t,i)},this),this}},{key:"parseRouter",value:function(){var e=this.cell,t=e.getRouter(),n=c.filter(e.vertices||[],function(e){return p["default"].isPointLike(e)});n=c.map(n,function(e){return p["default"].fromPoint(e)});var i=t.parse&&c.isFunction(t.parse)?t.parse:t.name&&this.paper.getRouter(t.name),r=i&&c.isFunction(i)?i.call(this,n,t.options||{}):n;return this.cacheRouterPoints(r),this}},{key:"parseConnector",value:function(){var e=this.cell,t=e.getConnector(),n=e.getMarker(!0),i=e.getMarker(!1),r=this.getStrokeWidth(t.selector),o=this.getStrokeWidth(n.selector),a=this.getStrokeWidth(i.selector),s=n.options;s||(s=n.options={}),s.connectorStrokeWidth=r,s.markerStrokeWidth=o;var u=i.options;return u||(u=i.options={}),u.connectorStrokeWidth=r,u.markerStrokeWidth=a,this.cacheConnector(t),this.cacheMarker(n,!0),this.cacheMarker(i,!1),this}},{key:"parseTerminal",value:function(e){var t=this.cell,n=t.getTerminalPoint(e),i=t.getTerminalNode(e),r=i&&this.paper.getView(i),o=t.getTerminalPort(e);return this.cacheStaticConnPoint(n,e),this.cacheTerminalView(r,e),this.cacheTerminalPort(o,e),this}},{key:"updateMarker",value:function(){return this.renderMarker(!0).renderMarker(!1).updateConnectionPoint(!0).updateConnectionPoint(!1).transformMarker(!0).transformMarker(!1).updateConnectionPointOnMarker(!0).updateConnectionPointOnMarker(!1)}},{key:"updateConnector",value:function(){var e=this.fetchConnector(),t=e.parse&&c.isFunction(e.parse)?e.parse:e.name&&this.paper.getConnector(e.name);if(!t||!c.isFunction(t))throw new Error('Unknown connector: "'+e.name+'"');var n=this.getConnectionPoint(!0),i=this.getConnectionPoint(!1);if(n&&i){var r=t.call(this,n,i,this.fetchRouterPoints(),e.options||{});this.applyAttr(e.selector,{d:r})}else this.vel.empty();return this}},{key:"renderMarker",value:function(e){var t=this.fetchMarker(e),n=this.findOne(t.selector);if(t&&n){var i=t.parse&&c.isFunction(t.parse)?t.parse:t.name&&this.paper.getMarker(t.name);if(i&&c.isFunction(i)){var r=i(n,t.options),o=r.vel;if(o){var a=n.node,s=a.parentNode,u=n.getClassName();s.insertBefore(o.node,a),s.removeChild(a),o.addClass(u),n=o}this.cacheMarkerVel(n,e),this.cacheRenderedMarker(r,e)}}return this}},{key:"updateConnectionPoint",value:function(e){var t=this.fetchStaticConnPoint(e);return t||this.updateConnPointOnPort(e)||this.updateConnPointOnNode(e),this}},{key:"updateConnPointOnPort",value:function(e){var t=this.fetchConnPointOnPort(e);if(!t){var n=this.fetchTerminalView(e),i=this.fetchTerminalPort(e);if(i&&n){if(n.getConnectionPointOnPort&&(t=n.getConnectionPointOnPort(i,e)),!t){var r=this.getPortBodyBBox(e);if(r){var o=this.getReferencePoint(r,e),a=this.getPortBodyGeom(e)||r;o&&(t=a.intersectionWithLineFromCenterToPoint(o)),t=t||a.getCenter()}}this.cacheConnPointOnPort(t,e)}}return t}},{key:"updateConnPointOnNode",value:function(e){var t=this.fetchConnPointOnNode(e);if(!t){var n=this.fetchTerminalView(e);if(n){if(n.getConnectionPointOnBorder&&(t=n.getConnectionPointOnBorder()),!t){var i=this.getTerminalBBox(e);if(i){var r=this.getReferencePoint(i,e);r&&(t=i.intersectionWithLineFromCenterToPoint(r)),t=t||i.getCenter()}}this.cacheConnPointOnNode(t,e)}}return t}},{key:"getStrokeWidth",value:function(e){var t=this.findOne(e);if(t&&t.node){var n=c.getComputedStyle(t.node,"stroke-width");return n&&c.toFloat(n)||0}return 0}},{key:"getTerminalBBox",value:function(e){var t=this.fetchTerminalBBox(e);if(!t){var n=this.fetchTerminalView(e);n&&(t=n.getStrokedBBox(),t=this.fixStrokedBBox(t,e)),this.cacheTerminalBBox(t,e)}return t}},{key:"fixStrokedBBox",value:function(e,t){if(e){var n=this.fetchMarker(t),i=this.fetchRenderedMarker(t);if(n&&i){var r=n.options.markerStrokeWidth;if(r){var o=i.rad||0;o>=Math.PI/4||0===o?e.grow(r/2):e.grow(r/Math.sin(o)/2)}}}return e}},{key:"getReferencePoint",value:function(e,t){var n=this.fetchStaticConnPoint(t);if(!n){var i=this.fetchRouterPoints();n=t?i[0]:i[i.length-1]}if(!n){var r=this.getPortBodyBBox(!t);r&&(n=r.intersectionWithLineFromCenterToPoint(e.getCenter()),n=n||r.getCenter())}if(!n){var o=this.getTerminalBBox(!t);o&&(n=o.intersectionWithLineFromCenterToPoint(e.getCenter()),
n=n||o.getCenter())}return n}},{key:"getPortBodyBBox",value:function(e){var t=this.fetchPortBodyBBox(e);if(!t){var n=this.fetchTerminalView(e),i=this.fetchTerminalPort(e);n&&i&&(n.getPortBodyBBox&&(t=n.getPortBodyBBox(i,e)),t&&(t=this.fixStrokedBBox(t,e),this.cachePortBodyBBox(t,e)))}return t}},{key:"getPortBodyGeom",value:function(e){var t=this.fetchPortBodyGeom(e);if(!t){var n=this.fetchTerminalView(e),i=this.fetchTerminalPort(e);n&&i&&(n.getPortBodyGeom&&(t=n.getPortBodyGeom(i,e)),t&&(t=this.fixStrokedBBox(t,e),this.cachePortBodyGeom(t,e)))}return t}},{key:"getConnectionPoint",value:function(e){return this.fetchStaticConnPoint(e)||this.fetchConnPointOnMarker(e)||this.fetchConnPointOnPort(e)||this.fetchConnPointOnNode(e)}},{key:"transformMarker",value:function(e,t){var n=this.fetchRenderedMarker(e);if(n){var i=this.getPane(),r=this.fetchRouterPoints(),o=this.getConnectionPoint(!0),a=this.getConnectionPoint(!1),s=e?o:a,u=t||e?r[0]||a:r[r.length-1]||o,l=this.fetchMarkerVel(e);s&&u&&l&&l.translateAndAutoOrient(s,u,i)}return this}},{key:"updateConnectionPointOnMarker",value:function(e){var t=this.fetchMarkerVel(e),n=this.fetchRenderedMarker(e);if(t&&n){var i=this.getPane(),r=n.point,o=f["default"].createSVGPoint(r.x,r.y);o=o.matrixTransform(t.getTransformToElement(i));var a=p["default"].fromPoint(o);this.cacheConnPointOnMarker(a,e)}return this}},{key:"cacheRouterPoints",value:function(e){this.cache.routerPoints=e}},{key:"fetchRouterPoints",value:function(){return this.cache.routerPoints}},{key:"cacheConnector",value:function(e){this.cache.connector=e}},{key:"fetchConnector",value:function(){return this.cache.connector}},{key:"cacheMarker",value:function(e,t){t?this.cache.sourceMarker=e:this.cache.targetMarker=e}},{key:"fetchMarker",value:function(e){return e?this.cache.sourceMarker:this.cache.targetMarker}},{key:"cacheRenderedMarker",value:function(e,t){e&&(t?this.cache.renderedSourceMarker=e:this.cache.renderedTargetMarker=e)}},{key:"fetchRenderedMarker",value:function(e){return e?this.cache.renderedSourceMarker:this.cache.renderedTargetMarker}},{key:"cacheMarkerVel",value:function(e,t){e&&(t?this.cache.sourceMarkerVel=e:this.cache.targetMarkerVel=e)}},{key:"fetchMarkerVel",value:function(e){return e?this.cache.sourceMarkerVel:this.cache.targetMarkerVel}},{key:"cacheTerminalView",value:function(e,t){e&&(t?this.cache.sourceView=e:this.cache.targetView=e)}},{key:"fetchTerminalView",value:function(e){return e?this.cache.sourceView:this.cache.targetView}},{key:"cacheTerminalPort",value:function(e,t){c.isNil(e)||(t?this.cache.sourcePort=e:this.cache.targetPort=e)}},{key:"fetchTerminalPort",value:function(e){return e?this.cache.sourcePort:this.cache.targetPort}},{key:"cacheStaticConnPoint",value:function(e,t){e&&(t?this.cache.staticSourcePoint=e:this.cache.staticTargetPoint=e)}},{key:"fetchStaticConnPoint",value:function(e){return e?this.cache.staticSourcePoint:this.cache.staticTargetPoint}},{key:"cacheConnPointOnMarker",value:function(e,t){e&&(t?this.cache.sourcePointOnMarker=e:this.cache.targetPointOnMarker=e)}},{key:"fetchConnPointOnMarker",value:function(e){return e?this.cache.sourcePointOnMarker:this.cache.targetPointOnMarker}},{key:"cacheConnPointOnPort",value:function(e,t){e&&(t?this.cache.sourcePointOnPort=e:this.cache.targetPointOnPort=e)}},{key:"fetchConnPointOnPort",value:function(e){return e?this.cache.sourcePointOnPort:this.cache.targetPointOnPort}},{key:"cacheConnPointOnNode",value:function(e,t){e&&(t?this.cache.sourcePointOnTerminal=e:this.cache.targetPointOnTerminal=e)}},{key:"fetchConnPointOnNode",value:function(e){return e?this.cache.sourcePointOnTerminal:this.cache.targetPointOnTerminal}},{key:"cacheTerminalBBox",value:function(e,t){e&&(t?this.cache.sourceTerminalBBox=e:this.cache.targetTerminalBBox=e)}},{key:"fetchTerminalBBox",value:function(e){return e?this.cache.sourceTerminalBBox:this.cache.targetTerminalBBox}},{key:"cachePortBodyBBox",value:function(e,t){e&&(t?this.cache.sourcePortBBox=e:this.cache.targetPortBBox=e)}},{key:"fetchPortBodyBBox",value:function(e){return e?this.cache.sourcePortBBox:this.cache.targetPortBBox}},{key:"cachePortBodyGeom",value:function(e,t){e&&(t?this.cache.sourcePortGeom=e:this.cache.targetPortGeom=e)}},{key:"fetchPortBodyGeom",value:function(e){return e?this.cache.sourcePortGeom:this.cache.targetPortGeom}}]),t}(y["default"]);t["default"]=g},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function m(e,t,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:m(r,t,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},h=n(5),f=r(h),d=n(18),p=i(d),v=n(20),y=i(v),g=function(e){function t(e){a(this,t);var n=s(this,Object.getPrototypeOf(t).call(this,e));return n.vertices=n.metadata.vertices||[],n}return u(t,e),l(t,[{key:"isLink",value:function(){return!0}},{key:"getVertices",value:function(){return this.vertices}},{key:"getVerticesCount",value:function(){return this.vertices.length}},{key:"getVerticeAt",value:function(e){return this.vertices[e]||null}},{key:"indexOfVertice",value:function(e){if(e&&p["default"].isPointLike(e))for(var t=0,n=this.getVerticesCount();n>t;t++){var i=this.getVerticeAt(t);if(e.x===i.x&&e.y===i.y)return t}return-1}},{key:"eachVertice",value:function(e,t){return f.forEach(this.vertices,e,t)}},{key:"filterVertice",value:function(e,t){return f.filter(this.vertices,e,t)}},{key:"insertVertice",value:function(e,t){var n=this.getVerticesCount();if(t=f.fixIndex(t,n),f.isArray(e)||(e=[e]),t===n){var i;(i=this.vertices).push.apply(i,o(e))}else this.vertices.splice(t,0,e);return this}},{key:"removeVertice",value:function(e){var t=this.indexOfVertice(e);return t>=0&&this.removeVerticeAt(t),this}},{key:"removeVerticeAt",value:function(e){var t=this.getVerticeAt(e);return t&&this.vertices.splice(e,1),t}},{key:"clearVertices",value:function(){return this.vertices=[],this}},{key:"getRouter",value:function(){var e=this.metadata.router||{};return f.isFunction(e)?e={parse:e}:f.isObject(e)||(e={name:e}),e}},{key:"getMarker",value:function(e){var t=e?this.metadata.sourceMarker:this.metadata.targetMarker;return f.isFunction(t)?t={parse:t}:f.isObject(t)||(t={name:t}),t.selector=e?".source-marker":".target-marker",t}},{key:"getConnector",value:function(){var e=this.metadata.connector||{};return f.isFunction(e)?e={parse:e}:f.isObject(e)||(e={name:e}),e.selector=".connector",e}},{key:"clone",value:function(e,n){var i=c(Object.getPrototypeOf(t.prototype),"clone",this).call(this,e,n);return i.vertices=[],f.forEach(this.vertices,function(e){p["default"].isPointLike(e)&&i.vertices.push({x:e.x,y:e.y})}),i}}],[{key:"isLink",value:function(e){return e&&e instanceof t}}]),t}(y["default"]);g.setDefaults({tagName:"g",markup:'<path class="connector"/><path class="source-marker"/><path class="target-marker"/>',classNames:"pane-link",pane:"linkPane",view:null,data:null,router:null,connector:"sharp",sourceMarker:null,targetMarker:null,attrs:{".connector":{fill:"none",stroke:"#000","stroke-width":1},".source-marker":{fill:"#000",stroke:"#000","stroke-width":1},".target-marker":{fill:"#000",stroke:"#000","stroke-width":1}}}),t["default"]=g},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(51),f=i(h),d=function(e){function t(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];o(this,t);var i=a(this,Object.getPrototypeOf(t).call(this));return i.paper=e,i.disabled=!1,i.configure(n).init(),i}return s(t,e),u(t,[{key:"configure",value:function(){return this}},{key:"init",value:function(){return this}},{key:"destroy",value:function(){c.destroy(this)}},{key:"getPaper",value:function(){return this.paper}},{key:"getModel",value:function(){return this.paper&&this.paper.model}},{key:"isDisabled",value:function(){return this.disabled===!0}},{key:"isEnabled",value:function(){return this.disabled===!1}},{key:"disable",value:function(){return this.disabled=!0,this.trigger("handler:disabled"),this}},{key:"enable",value:function(){return this.disabled=!1,this.trigger("handler:enabled"),this}},{key:"invoke",value:function(e,t){return this.isDisabled()||e.call(t),this}}]),t}(f["default"]);t["default"]=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(27),f=i(h),d=n(60),p=i(d),v=n(62),y=i(v),g=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"init",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this;this.name=e.name||"select";var n=this.getPaper(),i=this.getModel();return this.previewVel=(0,f["default"])("rect",{fill:"none","stroke-dasharray":"3px, 3px",stroke:"black"}),this.previewRect=this.previewVel.node,n.controlPane.appendChild(this.previewRect),this.hidePreview(),n.selection=[],this.origin={x:0,y:0},n.on("cell:pointerDown",function(e,n,i){t.invoke(function(){t.origin={x:i.x,y:i.y},t.selectCell(e,c.hasModifierKey(i))})}),n.on("cell:pointerMove",function(e,n,i){t.invoke(function(){t.showPreview().redrawPreview(i)})}),n.on("cell:pointerUp",function(e,r,o){t.invoke(function(){var e=t.origin;o.x===e.x&&o.y===e.y||(i.beginUpdate(),c.forEach(n.selection,function(t){var n=t.metadata.position;i.setGeometry(t,{position:{x:n.x+(o.x-e.x),y:n.y+(o.y-e.y),relative:n.relative}})}),i.endUpdate(),c.forEach(n.selection,function(e){e.vertexController.redraw()})),t.hidePreview()})}),n.on("blank:pointerDown",function(e){t.invoke(function(){c.hasModifierKey(e)||t.clearSelection()})}),this}},{key:"hidePreview",value:function(){return this.previewVel.hide(),this}},{key:"showPreview",value:function(){return this.previewVel.show(),this}},{key:"redrawPreview",value:function(e){var t=this,n=this.getPaper(),i=this.previewVel,r=n.selection;return r.length&&!function(){var o={x:Number.MAX_VALUE,y:Number.MAX_VALUE},a={x:0,y:0};c.forEach(r,function(e){var t=n.getView(e),i=t.vel.getBBox();i.x<o.x&&(o.x=i.x),i.y<o.y&&(o.y=i.y),i.x+i.width>a.x&&(a.x=i.x+i.width),i.y+i.height>a.y&&(a.y=i.y+i.height)});var s=t.origin;i.attr({x:o.x+(e.x-s.x),y:o.y+(e.y-s.y),width:a.x-o.x,height:a.y-o.y})}(),this}},{key:"_selectCell",value:function(e){var t=this.getPaper();return e.vertexController=new y["default"](t,{cell:e}),e.selected=!0,t.selection.push(e),this}},{key:"_unselectCell",value:function(e){var t=this.getPaper(),n=t.selection;return c.contains(n,e)&&t.selection.splice(c.indexOf(n,e),1),e.vertexController.destroy(),e.selected=!1,this}},{key:"selectCell",value:function(e,t){return t?e.selected?this._unselectCell(e):this._selectCell(e):(this.clearSelection(),e.selected?this:(this.clearSelection(),this._selectCell(e),this))}},{key:"clearSelection",value:function(){return c.forEach(this.paper.selection,function(e){e.vertexController.destroy(),e.selected=!1}),this.paper.selection=[],this}}]),t}(p["default"]);t["default"]=g},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(15),f=i(h),d=n(27),p=i(d),v=n(4),y=i(v),g=n(63),m=i(g),b=window,k=b.document,w={boundsAttr:{fill:"none","stroke-dasharray":"3px, 3px",stroke:"#0f0"},rotaterOffset:-12,rotaterAttr:{rx:5,ry:5,fill:"#0f0",stroke:"black",style:"cursor:crosshair;"},resizerAttr:{height:6,width:6,fill:"#0f0",stroke:"black"}},P=["nw-resize","n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize"],x=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"init",value:function(e){this.options=c.merge({},w,e);var t=(0,p["default"])("g",{"class":"vertex-bounds"});return this.cell=e.cell,this.vel=t,this.elem=t.node,this.paper.controlPane.appendChild(this.elem),this.redraw(),this}},{key:"redraw",value:function(){var e=this,t=e.cell;return e.moveTo(t.position).rotate().setSize(t.size).drawBounds().drawRotater().drawResizers(),this.bindEvents(),this}},{key:"moveTo",value:function(e){return this.vel.translate(e.x,e.y),this.position=e,this}},{key:"setSize",value:function(e){return this.size=e,this}},{key:"rotate",value:function(e,t,n){var i=this.cell;return t=c.isNumeric(t)?t:i.size.width/2,n=c.isNumeric(n)?n:i.size.height/2,e=c.isNumeric(e)?e:i.rotation,this.vel.rotate(e,t,n),this.rotation=e,this}},{key:"drawBounds",value:function(){var e=c.extend({},this.options.boundsAttr,this.size);return this.boundsVel?this.boundsVel.attr(e):(this.boundsVel=(0,p["default"])("rect",e),this.vel.append(this.boundsVel)),this}},{key:"drawRotater",value:function(){return this.rotaterVel||(this.rotaterVel=(0,p["default"])("ellipse",this.options.rotaterAttr),this.vel.append(this.rotaterVel)),this.rotaterVel.translate(this.size.width/2,this.options.rotaterOffset),this}},{key:"drawResizers",value:function(){var e=this.options;this.resizers||(this.resizers=[],c.forEach(P,function(){this.createResizer()},this));var t=this.resizers,n=e.resizerAttr.width/2,i=e.resizerAttr.height/2,r=this.size.height,o=this.size.width;return t[0].translate(-n,-i),t[1].translate(-n+o/2,-i),t[2].translate(-n+o,-i),t[3].translate(-n+o,-i+r/2),t[4].translate(-n+o,-i+r),t[5].translate(-n+o/2,-i+r),t[6].translate(-n,-i+r),t[7].translate(-n,-i+r/2),this.cacheResizerBBox(),this.adjustResizers(),this}},{key:"cacheResizerBBox",value:function(){return c.forEach(this.resizers,function(e){e.hidden||(e.cachedBBox=e.getBBox())}),this}},{key:"adjustResizers",value:function(){var e=this.cell,t=45,n=c.normalizeAngle(e.rotation),i=Math.floor(n/t),r=P.length;return c.forEach(this.resizers,function(e,t){var n=P[(t+i)%r];e.attr({"class":"resizer "+n}),e.css({cursor:n})}),this}},{key:"createResizer",value:function(){var e=this,t=(0,p["default"])("rect",e.options.resizerAttr);return e.resizers.push(t),e.vel.append(t),e}},{key:"hideRotater",value:function(){return this.rotaterVel.hide(),this}},{key:"showRotater",value:function(){return this.rotaterVel.show(),this}},{key:"showResizers",value:function(){return c.forEach(this.resizers,function(e){e.show()}),this}},{key:"hideResizers",value:function(e){return this.cacheResizerBBox(),c.forEach(this.resizers,function(t){t.node!==e&&t.hide()}),this}},{key:"resetEvents",value:function(e){return this.isRotating=!1,this.isResizing=!1,this.eventTarget=null,e&&e.target&&(this.eventTarget=e.target,this.isRotating=e.target===this.rotaterVel.node,this.isResizing=c.hasClass(e.target,"resizer"),this.oldEventPosition={x:e.x,y:e.y}),this.isRotating?this.hideResizers():this.showResizers(),this.isResizing?(this.hideRotater(),this.hideResizers(e.target)):this.showRotater(),this}},{key:"bindEvents",value:function(){var e=this.elem;this.resetEvents();var t=this.onPointerDown.bind(this),n=this.onPointerMove.bind(this),i=this.onPointerUp.bind(this);return f["default"].IS_TOUCH?(c.addEventListener(e,"touchstart",t),c.addEventListener(k,"touchmove",n),c.addEventListener(k,"touchend",i)):(c.addEventListener(e,"mousedown",t),c.addEventListener(k,"mousemove",n),c.addEventListener(k,"mouseup",i)),this}},{key:"onPointerDown",value:function(e){return e.stopPropagation(),this.resetEvents(e),this}},{key:"onPointerMove",value:function(e){var t=this;if(t.isRotating){e.stopPropagation();var n=t.position.x+t.size.width/2-e.x,i=t.position.y+t.size.height/2-e.y,r=0!==n?180*Math.atan(i/n)/Math.PI+90:0>i?180:0;n>0&&(r-=180),t.rotate(r)}return t.isResizing&&!function(){e.stopPropagation();var n=t.oldEventPosition,i={x:e.x,y:e.y},r=t.eventTarget,o=0,a=!1,s=!1;c.some(t.resizers,function(e,t){return e.node===r?(o=t,!0):!1});var u=(o-4+8)%8;o%2!==0&&(1!==o&&5!==o||(a=!0),3!==o&&7!==o||(s=!0),o-=1,u-=1);var l=t.resizers[u].cachedBBox.getCenter(),h=t.resizers[o].getBBox().getCenter(),f=0,d=0;a?(f=0,d=0):s?(f=0,d=0):(f=i.x-n.x,d=i.y-n.y);var p=y["default"].fromVerticesAndRotation(l,{x:h.x+f,y:h.y+d},t.rotation);t.moveTo({x:p.x,y:p.y}).setSize({height:p.height,width:p.width}).drawBounds().drawResizers().rotate(t.rotation),t.oldEventPosition=i}(),t}},{key:"onPointerUp",value:function(e){var t=this;if(t.isResizing||t.isRotating){e.stopPropagation();var n=t.model;n.beginUpdate(),t.isRotating&&n.setGeometry(t.cell,{rotation:{angle:t.rotation}}),t.isResizing&&n.setGeometry(t.cell,{position:{x:t.position.x,y:t.position.y},rotation:{angle:t.rotation},size:{width:t.size.width,height:t.size.height}}),n.endUpdate(),t.redraw(),t.resetEvents()}return t}},{key:"destroy",value:function(){this.boundsVel.remove(),this.rotaterVel.remove(),c.forEach(this.resizers,function(e){e.remove()}),this.vel.remove(),c.destroy(this)}}]),t}(m["default"]);t["default"]=x},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(51),l=i(u),c=function(e){function t(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r(this,t);var i=o(this,Object.getPrototypeOf(t).call(this));return i.paper=e,i.model=e.model,i.init(n),i.on("controller:initalized"),i}return a(t,e),s(t,[{key:"init",value:function(){return this}},{key:"destroy",value:function(){}}]),t}(l["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(27),f=i(h),d=n(4),p=i(d),v=n(59),y=i(v),g=n(60),m=i(g),b=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"init",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this,n=this.getPaper(),i=this.getModel();return this.name=e.name||"connection",this.sourceCellView=null,this.targetCellView=null,this.sourcePort=null,this.targetPort=null,this.connecting=!1,this.previewingLink=null,n.on("cell:mouseOver",function(e,n){t.sourceCellView!==n&&(t.connecting?t.setTargetCellView(n):t.setSourceCellView(n))}),n.on("cell:mouseOut",function(e,n,i){t.connecting?t.targetCellView===n&&t._isOut(n,i.toElement)&&t.setTargetCellView(null):t.sourceCellView===n&&t._isOut(n,i.toElement)&&t.setSourceCellView(null)}),c.addEventListener(n.decoratePane,"mouseout",".port-decorator.out",function(e){t.connecting||c.hasClass(e.toElement,"port-decorator-layer")||t.setSourceCellView(null)}),c.addEventListener(n.decoratePane,"mousedown",".port-decorator.out",function(e){t.connecting=!0;var n=e.delegateTarget;t.sourcePort=n.cellView.findPortByElem(n.portBody),t._drawInPortDecorators()}),c.addEventListener(n.container,"mousemove",function(e){t.connecting&&(t.previewingLink?i.setTerminal(t.previewingLink,n.toLocalPoint({x:e.x,y:e.y}),!1):(t.previewingLink=new y["default"]({sourceMarker:"block",targetMarker:"block"}),i.addLink(t.previewingLink,{node:t.sourceCellView.cell,port:t.sourcePort},n.toLocalPoint({x:e.x,y:e.y}))))}),n.on("cell:pointerUp",function(){t.connecting=!1,t.setSourceCellView(null),t._clearInPortDecorators()}),n.on("blank:pointerUp",function(){t.connecting=!1,t.setSourceCellView(null),t._clearInPortDecorators()}),this}},{key:"_isOut",value:function(e,t){return!c.containsElement(e.elem,t)&&!c.hasClass(t,"port-decorator-layer")}},{key:"setSourceCellView",value:function(e){var t=this,n=this.getPaper();return this.sourceCellView&&c.forEach(n.decoratePane.querySelectorAll(".port-decorator.out"),function(e){(0,f["default"])(e).remove()}),t.sourceCellView=e,e&&t._drawPortDecorators(e,"out"),this}},{key:"_drawInPortDecorators",value:function(){var e=this;return e}},{key:"_clearInPortDecorators",value:function(){var e=this,t=e.paper;return c.forEach(t.decoratePane.querySelectorAll(".port-decorator.in"),function(e){(0,f["default"])(e).remove()}),e}},{key:"_drawPortDecorators",value:function(e,t){var n=['<g class="port-decorator ${className}">','<circle class="back port-decorator-layer" r="8" cx="${x}" cy="${y}"></circle>','<circle class="front port-decorator-layer" r="3" cx="${x}" cy="${y}"></circle>',"</g>"].join(""),i=e.elem.querySelectorAll(".pane-ports."+t+" .pane-port .port-body"),r=this.getPaper(),o=r.decoratePane;c.forEach(i,function(i){var r=p["default"].fromRect((0,f["default"])(i).getBBox(!1)),a=r.getCenter(),s=(0,f["default"])(c.format(n,c.extend({className:t},a)));o.appendChild(s.node),s.node.cellView=e,s.node.portBody=i})}},{key:"setTargetCellView",value:function(){var e=this;return e}}]),t}(m["default"]);t["default"]=b},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t,n){var i=["M",e.x,e.y];return a.forEach(n,function(e){i.push(e.x,e.y)}),i.push(t.x,t.y),i.join(" ")}Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),a=i(o);t["default"]=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t,n){var i=e.cache,r=t?i.renderedSourceMarker:i.renderedTargetMarker,o=t?i.sourceMarkerVel:i.targetMarkerVel;if(r&&o){var a=t?i.sourcePointOnTerminal||i.staticSourcePoint:i.targetPointOnTerminal||i.staticTargetPoint;a&&(o.translateAndAutoOrient(a,n,e.getPane()),e.updateConnectionPointOnMarker(t))}}function a(e,t){var n=e.cache;return t?n.sourcePointOnMarker||n.sourcePointOnTerminal||n.staticSourcePoint:n.targetPointOnMarker||n.targetPointOnTerminal||n.staticTargetPoint}function s(e,t,n){var i=this,r=void 0,s=void 0,u=void 0;if(n&&n.length){var c=[e].concat(n).concat([t]),f=l.getCurveControlPoints(c),d=f[0].length;s=h["default"].fromPoint(f[0][0]),u=h["default"].fromPoint(f[1][d-1]),o(i,!0,s),o(i,!1,u),c[0]=a(i,!0),c[c.length-1]=a(i,!1),r=["M",c[0].x,c[0].y];for(var p=0;d>p;p++)r.push("C",f[0][p].x,f[0][p].y,f[1][p].x,f[1][p].y,c[p+1].x,c[p+1].y)}else{var v=(e.y+t.y)/2;r=["M",e.x,e.y,"C",e.x,v,t.x,v,t.x,t.y]}return r.join(" ")}Object.defineProperty(t,"__esModule",{value:!0});var u=n(50),l=r(u),c=n(18),h=i(c);t["default"]=s},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t,n){var i=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],r=i.radius||10,o=void 0,a=void 0,u=["M",e.x,e.y];return s.forEach(n,function(i,s){var c=n[s-1]||e,h=n[s+1]||t,f=l["default"].fromPoint(i);o=a||f.distance(c)/2,a=f.distance(h)/2;var d=l["default"].fromPoint(i).move(c,-Math.min(r,o)).smooth(),p=l["default"].fromPoint(i).move(h,-Math.min(r,a)).smooth();u.push(d.x,d.y,"S",i.x,i.y,p.x,p.y,"L")}),u.push(t.x,t.y),u.join(" ")}Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=r(a),u=n(18),l=i(u);t["default"]=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(e){var n=t.size||7,i=[],r=.75*n,o=n/2;i.push("M",0,n/2),i.push("L",n,0),i.push("L",r,o),i.push("L",n,n),i.push("Z"),e.attr("d",i.join(" "));var s=t.connectorStrokeWidth;return s>1&&(r+=s/2*(n-r)/o),{rad:Math.atan2(n/2,n),point:new a["default"](r,o)}}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(18),a=i(o);t["default"]=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(e){var n=t.rx||5,i=t.ry||n/2,r=[];return r.push("M",n,0),r.push("L",0,i),r.push("L",n,2*i),r.push("L",2*n,i),r.push("Z"),e.attr("d",r.join(" ")),{rad:Math.atan2(i,n),point:new a["default"](2*n-1,i)}}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(18),a=i(o);t["default"]=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(e){var n=t.width||7,i=t.height||n*Math.tan(1/6*Math.PI),r=[];return r.push("M",n,0),r.push("L",0,i),r.push("L",n,2*i),r.push("Z"),e.attr({d:r.join(" ")}),{rad:Math.atan2(i,n),point:new a["default"](n,i)}}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(18),a=i(o);t["default"]=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(e){var n=t.rx||7,i=t.ry||n/2,r=[];return r.push("M",n,0),r.push("L",0,i),r.push("L",n,2*i),e.attr("d",r.join(" ")),{rad:Math.atan2(i,n),point:new a["default"](0,i)}}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(18),a=i(o);t["default"]=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(e){var n=t.rx||3.5,i=t.ry||n,r=(0,a["default"])("ellipse");return r.attr({cx:n,cy:i,rx:n,ry:i}),{vel:r,rad:0,point:new u["default"](2*n,i)}}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(27),a=i(o),s=n(18),u=i(s);t["default"]=r},function(e,t){},,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.pai=void 0;var r=n(76),o=i(r),a=n(78),s=i(a),u=n(79),l=i(u),c=n(80),h=i(c),f=n(77),d=i(f),p=n(81),v=i(p),y=n(82),g=i(y),m=n(83),b=i(m),k={HTMLNode:o["default"],HTMLPaper:s["default"],PaperScroll:l["default"],LinkView:h["default"],HTMLNodeView:d["default"],SelectionHandler:v["default"],ConnectionHandler:g["default"],quadratic:b["default"]};t.pai=k},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);
}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(25),f=i(h),d=n(77),p=i(d),v=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"isPortVisible",value:function(e){return"hide"!==e.displayType}},{key:"getVisiblePorts",value:function(e){var t=e?this.getInPorts():this.getOutPorts();return c.filter(t,function(e){return this.isPortVisible(e)},this)}},{key:"getPortSelector",value:function(e,t){return this.getPortsWrapSelector(t)+'>.pane-port[data-id="'+e.id+'"]'}},{key:"getPortsWrapSelector",value:function(e){return".pane-ports."+(e?"in":"out")}}]),t}(f["default"]);v.setDefaults({tagName:"div",pane:"htmlPane",view:p["default"]}),t["default"]=v},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(4),f=i(h),d=n(32),p=i(d),v=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"render",value:function(){return this.renderMarkup().renderPorts(),this.scalableNode=this.findOne(".pane-scalable"),this.rotatableNode=this.findOne(".pane-rotatable"),this.update().resize().rotate().translate(),this}},{key:"ensureElement",value:function(){this.elem=c.createElement(this.cell.getTagName()),this.elem.cellId=this.cell.id;var e=this.cell.getClassName();e&&c.addClass(this.elem,e);var t=this.getPane();return t&&t.appendChild(this.elem),this}},{key:"renderMarkup",value:function(){var e=this.compileMarkup(this.cell.getMarkup(),this.cell.data);return this.elem.innerHTML=e,this}},{key:"renderPorts",value:function(){var e=this,t=this.getCell(),n=t.getVisiblePorts(!0),i=t.getVisiblePorts(!1),r=t.getPortMarkup();return n.length&&!function(){var t=e.findOne(".pane-ports.in"),i=100/(n.length+1);c.forEach(n,function(e,n){var o=this.compileMarkup(r,e);$(o).css({left:c.toFixed(i*(n+1),4)+"%"}).appendTo(t)},e)}(),i.length&&!function(){var t=e.findOne(".pane-ports.out"),n=100/(i.length+1);c.forEach(i,function(e,i){var o=this.compileMarkup(r,e);$(o).css({left:c.toFixed(n*(i+1),4)+"%"}).appendTo(t)},e)}(),this}},{key:"find",value:function(e){return"."===e?[this.elem]:this.elem.querySelectorAll(e)}},{key:"findOne",value:function(e){return"."===e?this.elem:this.elem.querySelector(e)}},{key:"update",value:function(e){return c.forIn(e||this.cell.attrs,function(e,n){var i=this.find(n);if(i.length){var r=t.specialAttributes.slice(),o={};c.forIn(e,function(e,t){c.contains(r,t)||(o[t]=e)}),c.isEmptyObject(o)||c.forEach(i,function(e){c.forIn(o,function(t,n){c.setAttribute(e,n,t)})}),c.isUndefined(e.style)||(c.isString(e.style)?c.forEach(i,function(t){c.setAttribute(t,"style",e.style)}):c.isObject(e.style)&&c.forEach(i,function(t){c.forIn(e.style,function(e,n){t.style[n]=e})})),c.isUndefined(e.html)||c.forEach(i,function(t){t.innerHTML=e.html||""}),c.isUndefined(e.text)||c.forEach(i,function(t){c.emptyElement(t),t.appendChild(document.createTextNode(e.text||""))})}},this),this}},{key:"resize",value:function(){var e=this.scalableNode;if(!e)return this;var t=e.clientWidth||e.offsetWidth||1,n=e.clientHeight||e.offsetHeight||1,i=this.cell.getSize(),r=i.width/t,o=i.height/n;return r=c.toFixed(r,2),o=c.toFixed(o,2),c.setScale(e,r,o),this}},{key:"rotate",value:function(){if(this.rotatableNode){var e=this.cell.getSize(),t=e.width/2,n=e.height/2;c.setRotation(this.rotatableNode,this.cell.getRotation(),t,n)}return this}},{key:"translate",value:function(){var e=this.cell.getPosition();return c.setTranslate(this.elem,e.x,e.y),this}},{key:"setNodeName",value:function(e){var t=this.getCell();t.data&&(t.data.name=e);var n=this.findOne(".name");return n&&(c.emptyElement(n),n.appendChild(document.createTextNode(e))),this}},{key:"setPortConnected",value:function(e,t,n){var i=this.getPortElem(e,t);i&&c.toggleClass(i,"is-connected",n)}},{key:"setPortConnecting",value:function(e,t,n){var i=this.getPortElem(e,t);i&&c.toggleClass(i,"is-connecting",n)}},{key:"setPortHighlight",value:function(e,t,n){var i=this.getPortElem(e,t);i&&c.toggleClass(i,"is-connectable",n);var r=this.findOne(".pane-node-content");r&&c.toggleClass(r,"is-connectable",n)}},{key:"setPortAdsorbed",value:function(e,t,n){var i=this.getPortElem(e,t);i=i&&i.querySelector(".port-magnet"),i&&c.toggleClass(i,"is-adsorbed",n)}},{key:"getBBox",value:function(){var e=c.getBounds(this.elem);return e?new f["default"](e.left,e.top,e.width,e.height):void 0}},{key:"getStrokedBBox",value:function(){var e=this.cell.getBBox(),t=0,n=this.findOne(".pane-node-content");return n&&(t=c.getComputedStyle(n,"border-width")-1),t?e.grow(t/2):e}},{key:"getPortBodyBBox",value:function(e,t){var n=this.getPortElem(e,t);if(n){var i=c.getBounds(n);return this.getPaper().toLocalRect({x:i.left,y:i.top,width:i.width,height:i.height})}}},{key:"getPortElem",value:function(e,t){var n=this.getCell();c.isObject(e)||(e=n.getPortById(e));var i=n.getPortSelector(e,!t);return i?this.findOne(i):void 0}},{key:"findPortElem",value:function(e){for(;e&&e!==this.elem;){if(c.hasClass(e,"pane-port"))return e;e=e.parentNode}return null}},{key:"isPortElem",value:function(e){return!!this.findPortElem(e)}},{key:"isOutPortElem",value:function(e){for(e=this.findPortElem(e);e&&e!==this.elem;){if(c.hasClass(e,"pane-ports out"))return!0;e=e.parentNode}return!1}},{key:"isInPortElem",value:function(e){for(e=this.findPortElem(e);e&&e!==this.elem;){if(c.hasClass(e,"pane-ports in"))return!0;e=e.parentNode}return!1}},{key:"findPortByElem",value:function(e){var t=this,n=null,i=e&&this.findPortElem(e);return i&&!function(){var e=t.isOutPortElem(i)?t.cell.getOutPorts():t.cell.getInPorts(),r=c.toInt(i.getAttribute("data-id"));c.some(e,function(e){return e.id===r?(n=e,!0):void 0})}(),n}}],[{key:"specialAttributes",get:function(){return["text","html","style"]}}]),t}(p["default"]);t["default"]=v},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function g(e,t,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:g(r,t,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},c=n(5),h=r(c),f=n(15),d=i(f),p=n(57),v=i(p),y=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"createPanes",value:function(){l(Object.getPrototypeOf(t.prototype),"createPanes",this).call(this);var e=h.createElement("div");return h.addClass(e,"pane-html"),this.htmlPane=e,this.stage.appendChild(e),this}},{key:"setup",value:function(){var e=this.htmlPane;return h.addEventListener(e,"contextmenu",this.onContextMenu.bind(this)),h.addEventListener(e,"dblclick",this.onDblClick.bind(this)),h.addEventListener(e,"click",this.onClick.bind(this)),h.addEventListener(e,"mouseover",".pane-node",this.onCellMouseOver.bind(this)),h.addEventListener(e,"mouseout",".pane-node",this.onCellMouseOut.bind(this)),h.addEventListener(e,d["default"].IS_TOUCH?"touchstart":"mousedown",this.onPointerDown.bind(this)),l(Object.getPrototypeOf(t.prototype),"setup",this).call(this),this}},{key:"getContentBBox",value:function(e){var n=l(Object.getPrototypeOf(t.prototype),"getContentBBox",this).call(this,e),i=null;if(h.forIn(this.getModel().cells,function(e){if(e.isNode()){var t=e.getBBox();t&&(i=i?i.union(t):t)}}),!e&&i){var r=this.viewport.getScreenCTM(),o=this.viewport.getCTM(),a=o.e-r.e,s=o.f-r.f,u=o.a,c=o.d;i.x=i.x*u+a,i.y=i.y*c+s,i.width*=u,i.height*=c}return i&&(n=i.union(n)),n}},{key:"translate",value:function(e,n,i){return h.isNil(e)||h.isNil(n)||(i&&(e+=h.isNil(this.tx)||0,n+=h.isNil(this.ty)||0),h.setStyle(this.htmlPane,{top:n+"px",left:e+"px"}),l(Object.getPrototypeOf(t.prototype),"translate",this).call(this,e,n)),this}},{key:"scale",value:function(e,n){var i=arguments.length<=2||void 0===arguments[2]?0:arguments[2],r=arguments.length<=3||void 0===arguments[3]?0:arguments[3];return n=n||e,e&&n&&(h.setStyle(this.htmlPane,{transform:"scale("+e+","+n+")"}),l(Object.getPrototypeOf(t.prototype),"scale",this).call(this,e,n,i,r)),this}},{key:"destroy",value:function(){h.removeElement(this.htmlPane),l(Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(v["default"]);t["default"]=y},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(5),u=r(s),l=n(15),c=i(l),h={paper:null,space:30,minWidth:0,minHeight:0},f=function(){function e(t){o(this,e),t&&this.install(t)}return a(e,[{key:"destroy",value:function(){this.destroyed||(u.removeElement(this.scrollElem),u.destroy(this))}},{key:"install",value:function(e){this.options=u.merge({},h,e),this.space=u.normalizeSides(this.options.space),this.paper=this.options.paper;var t=this.paper;this.sx=t.sx,this.sy=t.sy,this.baseWidth=t.width,this.baseHeight=t.height,this.scrollLeft=0,this.scrollTop=0,t.on("paper:scale",this.doScale,this),t.on("paper:resize",this.doResize,this),this.ensureElement(),this.addScrollEvent();var n=u.getScrollBarWidth();this.clientWidth=this.scrollParent.clientWidth-n,this.clientHeight=this.scrollParent.clientHeight-n,this.doResize(),this.adjustPadding(),this.center()}},{key:"ensureElement",value:function(){var e=this.paper,t=u.createElement("div");return this.scrollElem=t,this.scrollParent=e.wrapper,u.addClass(t,"pane-scroll"),t.appendChild(e.stage),e.wrapper.appendChild(t),this}},{key:"addScrollEvent",value:function(){var e=this;return this.onScroll||!function(){var t=e;e.onScroll=function(){t.setScroll(t.scrollParent.scrollLeft,t.scrollParent.scrollTop)}}(),u.addEventListener(this.scrollParent,"scroll",this.onScroll),this}},{key:"removeScrollEvent",value:function(){return u.removeEventListener(this.scrollParent,"scroll",this.onScroll),this}},{key:"adjustPadding",value:function(e){if(e)e=u.normalizeSides(e);else{var t=this.space,n=this.clientWidth,i=this.clientHeight;e={top:i-t.top,right:n-t.right,bottom:i-t.bottom,left:n-t.left}}return this.padding=e,u.setStyle(this.scrollElem,{paddingTop:e.top+"px",paddingRight:e.right+"px",paddingBottom:e.bottom+"px",paddingLeft:e.left+"px"}),this}},{key:"adjustPaper",value:function(){var e=this.paper,t=e.sx,n=e.sy,i={frameWidth:this.baseWidth*t,frameHeight:this.baseHeight*n};this.options.minWidth&&(i.minWidth=this.options.minWidth*t),this.options.minHeight&&(i.minHeight=this.options.minHeight*n);var r=e.tx,o=e.ty;if(e.fitToContent(i)){var a=e.tx-r,s=e.ty-o;0===a&&0===s||this.doScroll(a,s,{relative:!0})}return this}},{key:"doScale",value:function(e,t,n,i){return this.sx=e,this.sy=t,this.adjustPaper(),(n||i)&&this.center(n,i),this}},{key:"doResize",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.baseWidth:arguments[0],t=arguments.length<=1||void 0===arguments[1]?this.baseHeight:arguments[1];return u.setStyle(this.scrollElem,{width:e+"px",height:t+"px"}),this}},{key:"doScroll",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return this.removeScrollEvent(),n.relative&&(e+=this.scrollLeft,t+=this.scrollTop),this.setScroll(e,t),this.scrollParent.scrollLeft=e,this.scrollParent.scrollTop=t,this.addScrollEvent(),this}},{key:"setScroll",value:function(e,t){return this.scrollLeft=e,this.scrollTop=t,this}},{key:"center",value:function(e,t){var n=this.paper,i=n.tx,r=n.ty;if(u.isUndefined(e)||u.isUndefined(t)){var o=-i,a=-r,s=o+n.width,l=a+n.height;e=(o+s)/2,t=(a+l)/2}else e*=n.sx,t*=n.sy;var c=this.clientWidth/2-(e+i+this.padding.left-this.scrollLeft),h=this.clientHeight/2-(t+r+this.padding.top-this.scrollTop);return this.doScroll(-c,-h,{relative:!0}),this}},{key:"centerContent",value:function(){var e=this.paper.getContentBBox(!0);return this.center(e.x+e.width/2,e.y+e.height/2),this}},{key:"toLocalPoint",value:function(e,t){var n=this.paper,i=this.padding;return e+=this.scrollLeft-i.left-n.tx,e/=n.sx,t+=this.scrollTop-i.top-n.ty,t/=n.sy,{x:Math.round(e),y:Math.round(t)}}},{key:"getCenter",value:function(){return this.toLocalPoint(this.clientWidth/2,this.clientHeight/2)}},{key:"beforeZoom",value:function(){return c["default"].IS_IE&&u.setStyle(this.elem,"visibility","hidden"),this}},{key:"afterZoom",value:function(){return c["default"].IS_IE&&u.setStyle(this.elem,"visibility",""),this}},{key:"zoom",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=e,i=e;t.absolute||(n+=this.sx,i+=this.sy);var r=t.scaleGrid;r&&(n=u.snapToGrid(n,r),i=u.snapToGrid(i,r));var o=t.minScale,a=t.maxScale;n=u.clamp(n,o||0,a||Number.MAX_VALUE),i=u.clamp(i,o||0,a||Number.MAX_VALUE);var s=t.cx,l=t.cy;if(u.isUndefined(s)||u.isUndefined(l)){var c=this.getCenter();s=c.x,l=c.y}else s=800,l=600;var h=s*(n-this.sx),f=l*(i-this.sy);return this.beforeZoom(),this.paper.scale(n,i),this.doScroll(h,f,{relative:!0}),this.afterZoom(),this}},{key:"zoomToFit",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this.paper,n=t.tx,i=t.ty,r=this.scrollParent.clientWidth,o=this.scrollParent.clientHeight;return e.fittingBBox=e.fittingBBox||{x:n,y:i,width:r,height:o},this.beforeZoom(),t.scaleContentToFit(e),t.translate(n,i),this.adjustPaper(),this.centerContent(),this.afterZoom(),this}}]),e}();t["default"]=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(27),f=i(h),d=n(18),p=i(d),v=n(30),y=i(v),g=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"render",value:function(){return this.vel.empty(),this.renderMarkup().update(),this}},{key:"update",value:function(){return this.cache={},this.parseConnector().parseTerminal(!0).parseTerminal(!1).updateMarker().updateConnector()}},{key:"parseConnector",value:function(){var e=this.cell,t=e.getConnector(),n=e.getMarker(!0),i=e.getMarker(!1),r=this.getStrokeWidth(t.selector),o=this.getStrokeWidth(n.selector),a=this.getStrokeWidth(i.selector),s=n.options;s||(s=n.options={}),s.connectorStrokeWidth=r,s.markerStrokeWidth=o;var u=i.options;return u||(u=i.options={}),u.connectorStrokeWidth=r,u.markerStrokeWidth=a,this.cacheConnector(t),this.cacheMarker(n,!0),this.cacheMarker(i,!1),this}},{key:"parseTerminal",value:function(e){var t=this.cell,n=t.getTerminalPoint(e),i=t.getTerminalPort(e),r=t.getTerminalNode(e),o=r&&this.paper.getView(r);return this.cacheStaticConnPoint(n,e),this.cacheTerminalView(o,e),this.cacheTerminalPort(i,e),this}},{key:"updateMarker",value:function(){return this.renderMarker(!0).renderMarker(!1).updateConnectionPoint(!0).updateConnectionPoint(!1).transformMarker(!0).transformMarker(!1).updateConnectionPointOnMarker(!0).updateConnectionPointOnMarker(!1)}},{key:"updateConnector",value:function(){var e=this.fetchConnector(),t=e.parse&&c.isFunction(e.parse)?e.parse:e.name&&this.paper.getConnector(e.name);if(!t||!c.isFunction(t))throw new Error('Unknown connector: "'+e.name+'"');var n=this.getConnectionPoint(!0),i=this.getConnectionPoint(!1);if(n&&i){var r=t.call(this,n,i);this.applyAttr(".connector-wrap",{d:r}),this.applyAttr(e.selector,{d:r})}else this.vel.empty();return this}},{key:"updateComment",value:function(){}},{key:"renderMarker",value:function(e){var t=this.fetchMarker(e),n=this.findOne(t.selector);if(t&&n){var i=t.parse&&c.isFunction(t.parse)?t.parse:t.name&&this.paper.getMarker(t.name);if(i&&c.isFunction(i)){var r=i(n,t.options),o=r.vel;if(o){var a=n.node,s=a.parentNode,u=n.getClassName();s.insertBefore(o.node,a),s.removeChild(a),o.addClass(u),n=o}this.cacheMarkerVel(n,e),this.cacheRenderedMarker(r,e)}}return this}},{key:"updateConnectionPoint",value:function(e){if(!this.fetchStaticConnPoint(e)){var t=this.getPortBodyBBox(e);if(t){var n=new p["default"](t.getCenter().x,e?t.y+t.height:t.y);this.cacheConnPointOnPort(n,e)}}return this}},{key:"getStrokeWidth",value:function(e){var t=this.findOne(e);if(t&&t.node){var n=c.getComputedStyle(t.node,"stroke-width");return n&&c.toFloat(n)||0}return 0}},{key:"fixStrokedBBox",value:function(e,t){if(e){var n=this.fetchMarker(t),i=this.fetchRenderedMarker(t);if(n&&i){var r=n.options.markerStrokeWidth;if(r){var o=i.rad||0;o>=Math.PI/4||0===o?e.grow(r/2):e.grow(r/Math.sin(o)/2)}}}return e}},{key:"getPortBodyBBox",value:function(e){var t=this.fetchPortBodyBBox(e);if(!t){var n=this.fetchTerminalView(e),i=this.fetchTerminalPort(e);n&&i&&(n.getPortBodyBBox&&(t=n.getPortBodyBBox(i,e)),t&&(t=this.fixStrokedBBox(t,e),this.cachePortBodyBBox(t,e)))}return t}},{key:"getConnectionPoint",value:function(e){var t=this.fetchConnPointOnMarker(e)||this.fetchStaticConnPoint(e)||this.fetchConnPointOnPort(e);return t}},{key:"transformMarker",value:function(e){var t=this.fetchRenderedMarker(e);if(t){var n=this.getPane(),i=this.fetchStaticConnPoint(e)||this.fetchConnPointOnPort(e),r=new p["default"](i.x,i.y+(e?50:-50)),o=this.fetchMarkerVel(e);i&&r&&o&&o.translateAndAutoOrient(i,r,n)}return this}},{key:"updateConnectionPointOnMarker",value:function(e){var t=this.fetchMarkerVel(e),n=this.fetchRenderedMarker(e);if(t&&n){var i=this.getPane(),r=n.point,o=f["default"].createSVGPoint(r.x,r.y);o=o.matrixTransform(t.getTransformToElement(i));var a=p["default"].fromPoint(o);this.cacheConnPointOnMarker(a,e)}return this}},{key:"cacheConnector",value:function(e){this.cache.connector=e}},{key:"fetchConnector",value:function(){return this.cache.connector}},{key:"cacheMarker",value:function(e,t){t?this.cache.sourceMarker=e:this.cache.targetMarker=e}},{key:"fetchMarker",value:function(e){return e?this.cache.sourceMarker:this.cache.targetMarker}},{key:"cacheRenderedMarker",value:function(e,t){e&&(t?this.cache.renderedSourceMarker=e:this.cache.renderedTargetMarker=e)}},{key:"fetchRenderedMarker",value:function(e){return e?this.cache.renderedSourceMarker:this.cache.renderedTargetMarker}},{key:"cacheMarkerVel",value:function(e,t){e&&(t?this.cache.sourceMarkerVel=e:this.cache.targetMarkerVel=e)}},{key:"fetchMarkerVel",value:function(e){return e?this.cache.sourceMarkerVel:this.cache.targetMarkerVel}},{key:"cacheTerminalView",value:function(e,t){e&&(t?this.cache.sourceView=e:this.cache.targetView=e)}},{key:"fetchTerminalView",value:function(e){return e?this.cache.sourceView:this.cache.targetView}},{key:"cacheTerminalPort",value:function(e,t){c.isNil(e)||(t?this.cache.sourcePort=e:this.cache.targetPort=e)}},{key:"fetchTerminalPort",value:function(e){return e?this.cache.sourcePort:this.cache.targetPort}},{key:"cacheStaticConnPoint",value:function(e,t){e&&(t?this.cache.staticSourcePoint=e:this.cache.staticTargetPoint=e)}},{key:"fetchStaticConnPoint",value:function(e){return e?this.cache.staticSourcePoint:this.cache.staticTargetPoint}},{key:"cacheConnPointOnMarker",value:function(e,t){e&&(t?this.cache.sourcePointOnMarker=e:this.cache.targetPointOnMarker=e)}},{key:"fetchConnPointOnMarker",value:function(e){return e?this.cache.sourcePointOnMarker:this.cache.targetPointOnMarker}},{key:"cacheConnPointOnPort",value:function(e,t){e&&(t?this.cache.sourcePointOnPort=e:this.cache.targetPointOnPort=e)}},{key:"fetchConnPointOnPort",value:function(e){return e?this.cache.sourcePointOnPort:this.cache.targetPointOnPort}},{key:"cachePortBodyBBox",value:function(e,t){e&&(t?this.cache.sourcePortBBox=e:this.cache.targetPortBBox=e)}},{key:"fetchPortBodyBBox",value:function(e){return e?this.cache.sourcePortBBox:this.cache.targetPortBBox}}]),t}(y["default"]);t["default"]=g},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(5),c=r(l),h=n(4),f=i(h),d=n(60),p=i(d),v=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"configure",value:function(e){return this.options=c.merge({multi:!0,area:!0,delay:30,sense:10},e),this.scrollParent=c.getScrollParent(this.getPaper().svg),this}},{key:"init",value:function(){return this.previewRect=c.createElement("div"),this.selectionRect=c.createElement("div"),c.addClass(this.previewRect,"pane-selection-preview"),c.addClass(this.selectionRect,"pane-selection-rect"),this.focusedCell=null,this.movingCells=[],this.selectedCells=[],this.origin=null,this.bounds=null,this.getPaper().on("cell:pointerDown",this.onCellMouseDown.bind(this)).on("cell:pointerMove",this.onCellMouseMove.bind(this)).on("cell:pointerUp",this.onCellMouseUp.bind(this)).on("blank:pointerDown",this.onBlankMouseDown.bind(this)).on("blank:pointerMove",this.onBlankMouseMove.bind(this)).on("blank:pointerUp",this.onBlankMouseUp.bind(this)),this}},{key:"onCellMouseDown",value:function(e,t,n,i,r){this.isDisabled()||e.isNode()&&t.isPortElem(n.target)||(this.moving=!1,this.bounds=null,e.isNode()&&(this.origin={x:i,y:r},this.movingCells=e.selected?this.selectedCells:[e]))}},{key:"onCellMouseMove",value:function(e,t,n,i,r){if(!this.isDisabled()&&!e.isLink()&&this.origin){if(!this.moving){var o=this.getPreviewBounds();o&&(this.bounds=o,this.previewOriginX=o.x,this.previewOriginY=o.y,this.updatePreview(!0),this.showPreview()),this.moving=!0}if(this.bounds){this.stopScrollTimer();var a=this.previewOriginX+i-this.origin.x,s=this.previewOriginY+r-this.origin.y,u=this.scrollParent;a=c.clamp(a,-u.scrollLeft,u.clientWidth+u.scrollLeft-this.bounds.width),s=c.clamp(s,-u.scrollTop,u.clientHeight+u.scrollTop-this.bounds.height),this.bounds.x=a,this.bounds.y=s,this.updatePreview()}}}},{key:"onCellMouseUp",value:function(e,t,n,i,r){if(!this.isDisabled()){var o=0,a=0;if(this.origin&&(this.hidePreview(),o=i-this.origin.x,a=r-this.origin.y),!this.moving||0===o&&0===a)if(e.isLink())this.clearSelection(),this.setCellFocused(e,t);else{var s=c.hasModifierKey(n);this.selectCell(e,t,s),this.notifySelectionChange(),s||this.setCellFocused(e,t)}else if(o=this.bounds.x-this.previewOriginX,a=this.bounds.y-this.previewOriginY,this.stopScrollTimer(),0!==o||0!==a){var u=this.getModel();u.beginUpdate(),c.forEach(this.movingCells,function(e){if(e.isNode()){var t=e.getPosition();e.setPosition({x:t.x+o,y:t.y+a,relative:t.relative===!0})}},this),u.endUpdate(),this.getPaper().trigger("cells:updatePosition",this.movingCells)}this.origin=null,this.bounds=null,this.moving=!1,this.movingCells=null}}},{key:"onBlankMouseDown",value:function(e,t,n){this.isDisabled()||(this.options.area?this.origin={x:t,y:n}:c.hasModifierKey(e)||this.clearSelection())}},{key:"onBlankMouseMove",value:function(e,t,n){if(!this.isDisabled()&&this.origin&&(this.moving||(this.showSelectionRect(),this.moving=!0),this.moving)){var i=this.origin,r=this.scrollParent,o=t,a=n,s=Math.abs(o-i.x),u=Math.abs(a-i.y),l=void 0,c=void 0;o>i.x?(o=i.x,l=r.scrollLeft+r.clientWidth-o,s>l&&(s=l)):(l=this.origin.x-r.scrollLeft,s>l&&(s=l,o=r.scrollLeft)),a>this.origin.y?(a=this.origin.y,c=r.scrollTop+r.clientHeight-a,u>c&&(u=c)):(c=this.origin.y-r.scrollTop,u>c&&(u=c,a=r.scrollTop)),this.bounds={x:o,y:a,width:s,height:u},this.stopScrollTimer(),this.updateSelectionRect()}}},{key:"onBlankMouseUp",value:function(e){this.isDisabled()||(c.hasModifierKey(e)||this.clearSelection(),this.moving&&this.bounds?(this.stopScrollTimer(),this.hideSelectionRect(),this.selectCellsInRect(this.bounds)):this.setCellFocused(null),this.notifySelectionChange(),this.bounds=null,this.origin=null,this.moving=!1)}},{key:"stopScrollTimer",value:function(){return this.scrollTimer&&(clearTimeout(this.scrollTimer),this.scrollTimer=0),this}},{key:"getPreviewBounds",value:function(){var e=null;return c.forEach(this.movingCells,function(t){if(t.isNode()){var n=t.getBBox();n&&(e=e?e.union(n):n)}}),e}},{key:"autoScrollPreview",value:function(){if(this.isParentScrollable()){var e=this.options.sense,t=this.bounds,n=t.x,i=t.y,r=t.width,o=t.height,a=this.scrollParent,s=a.scrollWidth,u=a.scrollHeight,l=a.clientWidth,c=a.clientHeight,h=a.scrollTop,f=a.scrollLeft,d=!1;f>0&&0>=n-f?(d=!0,t.x=Math.max(0,n-e),f=Math.max(0,f-e)):n+r-(f+l)===0&&s-l>f?(d=!0,t.x=Math.min(s-r,n+e),f=Math.min(s-l,f+e)):h-i===0&&h>0?(d=!0,t.y=Math.max(0,i-e),h=Math.max(0,h-e)):i+o-(h+c)===0&&u-c>h&&(d=!0,t.y=Math.min(u-o,i+e),h=Math.min(u-c,h+e)),d&&(a.scrollTop=h,a.scrollLeft=f,this.updatePreview(),this.scrollTimer=setTimeout(this.autoScrollPreview.bind(this),this.options.delay))}return this}},{key:"updatePreview",value:function(e){var t=this.previewRect,n=this.bounds;return n&&t&&(c.setTranslate(t,n.x,n.y),e&&(c.setStyle(t,{width:n.width+"px",height:n.height+"px"}),c.toggleClass(t,"single",1===this.movingCells.length))),this}},{key:"hidePreview",value:function(){return c.removeElement(this.previewRect),this}},{key:"showPreview",value:function(){var e=this.getPaper();return e&&e.htmlPane&&e.htmlPane.appendChild(this.previewRect),this}},{key:"hideSelectionRect",value:function(){return c.removeElement(this.selectionRect),this}},{key:"showSelectionRect",value:function(){var e=this.getPaper();return e&&e.htmlPane&&e.htmlPane.appendChild(this.selectionRect),this}},{key:"updateSelectionRect",value:function(){var e=this.selectionRect,t=this.bounds;return t&&e&&(c.setTranslate(e,t.x,t.y),c.setStyle(e,{width:t.width+"px",height:t.height+"px"})),this}},{key:"autoScrollSelectionRect",value:function(e,t){if(this.isParentScrollable()){var n=this.options.sense,i=this.bounds,r=!1,o=this.scrollParent,a=o.scrollWidth,s=o.scrollHeight,u=o.clientWidth,l=o.clientHeight,c=o.scrollTop,h=o.scrollLeft;h>e&&h>0?(r=!0,e-=n,i.x=Math.max(0,i.x-n),h=Math.max(0,h-n)):e>h+u&&a-u>h?(r=!0,e+=n,i.width=Math.min(a-i.x,i.width+n),h=Math.min(a-u,h+n)):c>t&&c>0?(r=!0,t-=n,i.y=Math.max(0,i.y-n),c=Math.max(0,c-n)):t>c+l&&s-l>c&&(r=!0,t+=n,i.height=Math.min(s-i.y,i.height+n),c=Math.min(s-l,c+n)),r&&(o.scrollTop=c,o.scrollLeft=h,this.updateSelectionRect(),this.scrollTimer=setTimeout(this.autoScrollSelectionRect.bind(this,e,t),this.options.delay))}return this}},{key:"selectCellsInRect",value:function(e){var t=this.getPaper(),n=this.getModel(),i=n&&n.findCellInArea(f["default"].fromRect(e));return c.forEach(i,function(e){this.setSelected(e,t.getView(e),!0)},this),this}},{key:"selectCell",value:function(e,t,n){return n?this.setSelected(e,t,!e.selected):this.clearSelection().setSelected(e,t,!0),this}},{key:"setSelected",value:function(e,t,n){return n=!!n,n!==e.selected&&(e.selected=n,n?this.selectedCells.push(e):(c.contains(this.selectedCells,e)&&this.selectedCells.splice(c.indexOf(this.selectedCells,e),1),e.selected=!1),c.toggleClass(t.elem,"selected",e.selected)),this}},{key:"clearSelection",value:function(){var e=this.getPaper();return c.forEach(this.selectedCells,function(t){var n=e.getView(t);n&&c.removeClass(n.elem,"selected"),t.selected=!1}),this.selectedCells=[],this}},{key:"setCellFocused",value:function(e,t){if(this.focusedCell!==e){if(this.focusedCell){var n=this.getPaper().getView(this.focusedCell);n&&c.removeClass(n.elem,"focused"),this.focusedCell=null}e&&t&&(c.addClass(t.elem,"focused"),this.focusedCell=e)}return this.notifyFocus(),this}},{key:"isParentScrollable",value:function(){var e=this.scrollParent;return e.scrollWidth>e.clientWidth||e.scrollHeight>e.clientHeight}},{key:"notifyMoving",value:function(){this.getPaper().trigger("cells:moving",this.bounds,this.movingCells)}},{key:"notifyFocus",value:function(){this.focusedCell?this.getPaper().trigger("cell:focus",this.focusedCell):this.getPaper().trigger("paper:focus")}},{key:"notifySelectionChange",
value:function(){this.getPaper().trigger("cells:selectionChanged",this.selectedCells)}}]),t}(p["default"]);t["default"]=v},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(60),l=i(u),c=n(59),h=i(c),f=n(80),d=i(f),p=n(83),v=i(p),y=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),s(t,[{key:"init",value:function(){return this.clean(),this.mouseOverHandler=this.onCellMouseOver.bind(this),this.mouseOutHandler=this.onCellMouseOut.bind(this),this.getPaper().on("cell:pointerDown",this.onCellMouseDown.bind(this)).on("cell:pointerMove",this.onCellMouseMove.bind(this)).on("cell:pointerUp",this.onCellMouseUp.bind(this)),this}},{key:"clean",value:function(){return this.sourceNode=null,this.sourcePort=null,this.sourceView=null,this.connecting=!1,this.targetNode=null,this.targetView=null,this.targetPort=null,this.hasTarget=!1,this}},{key:"getEventData",value:function(){return{sourceNode:this.sourceNode,sourceView:this.sourceView,sourcePort:this.sourcePort,targetNode:this.targetNode,targetView:this.targetView,targetPort:this.targetPort}}},{key:"onCellMouseDown",value:function(e,t,n){!this.isDisabled()&&e.isNode()&&t.isOutPortElem(n.target)&&(this.sourceNode=e,this.sourceView=t,this.sourcePort=t.findPortByElem(n.target))}},{key:"onCellMouseMove",value:function(e,t,n,i,r){if(!this.isDisabled()&&this.sourcePort){var o=this.getPaper(),a=this.getModel();a.beginUpdate(),this.connecting||(this.getPaper().on("cell:mouseOver",this.mouseOverHandler).on("cell:mouseOut",this.mouseOutHandler),this.link=new h["default"]({view:d["default"],pane:"decoratePane",connector:v["default"],sourceMarker:null,targetMarker:"block",attrs:null}),a.addLink(this.link,{node:e,port:this.sourcePort.id}),this.connecting=!0),this.link&&this.link.setTerminal({x:i,y:r},!1),a.endUpdate(),o.trigger("cell:connecting",this.getEventData())}}},{key:"onCellMouseUp",value:function(){if(!this.isDisabled()&&this.connecting){var e=this.getPaper(),t=this.getModel();e.off("cell:mouseOver",this.mouseOverHandler).off("cell:mouseOut",this.mouseOutHandler),t.beginUpdate(),this.link.removeFromParent(),e.trigger("cell:connected",this.getEventData()),t.endUpdate(),this.clean()}}},{key:"onCellMouseOver",value:function(e,t,n){!this.isDisabled()&&e.isNode()&&e!==this.sourceCell&&this.connecting&&(this.hasTarget=!0,this.targetNode=e,this.targetView=t,this.targetPort=t.findPortByElem(n.target),this.getPaper().trigger("cell:connectingMouseOver",this.getEventData()))}},{key:"onCellMouseOut",value:function(e){!this.isDisabled()&&e.isNode()&&this.hasTarget&&this.connecting&&(this.getPaper().trigger("cell:connectingMouseOut",this.getEventData()),this.hasTarget=!1,this.targetNode=null,this.targetView=null,this.targetPort=null)}}]),t}(l["default"]);t["default"]=y},function(e,t){"use strict";function n(e,t){var n=(e.x+t.x)/2,i=(e.y+t.y)/2,r=50,o=t.y-e.y;return o>-100&&100>o&&(r=Math.max(Math.abs(t.y-e.y)/2,30)),["M",e.x,e.y,"Q",e.x,e.y+r,n,i,"T",t.x,t.y].join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n}])});